{
	"info": {
		"_postman_id": "844dc83b-6220-4da2-8557-1015cee35870",
		"name": "STIGMan API Tests",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Packages Tests - data file driven",
			"item": [
				{
					"name": "Optional params and edge cases",
					"item": [
						{
							"name": "packages - get - with name string",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "cac53323-9800-42ce-8442-21810a61571b",
										"exec": [
											"let user = pm.environment.get(\"user\");\r",
											"console.log(\"user: \" + user);\r",
											"if (user == \"wf10\") {\r",
											"    pm.test(\"Status should be is 403 for user wf10\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"else {\r",
											"    pm.test(\"Status code is 200\", function () {\r",
											"        pm.response.to.have.status(200);\r",
											"    });\r",
											"}\r",
											"\r",
											"let jsonData = pm.response.json();\r",
											"\r",
											"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
											"    user = \"elevated\";\r",
											"}\r",
											"\r",
											"\r",
											"let allowedPackages, disallowedPackages, validStigs, invalidStigs, validAssets, invalidAssets;\r",
											"\r",
											"console.log(\"building valid assignments lists\");\r",
											"\r",
											"allowedPackages = JSON.parse(pm.environment.get((\"packages.valid\")));\r",
											"console.log(\"user is \" + user);\r",
											"\r",
											"\r",
											"\r",
											"\r",
											"pm.test(\"Response JSON is an array\", function () {\r",
											"    pm.expect(jsonData).to.be.an('array');\r",
											"});\r",
											"\r",
											"let packageIds = [];\r",
											"let names = [];\r",
											"let stigIds = [];\r",
											"pm.test(\"Each item in response has proper properties\", function () {\r",
											"    jsonData.forEach(function (item) {\r",
											"        pm.expect(item).to.have.property('packageId');\r",
											"        packageIds.push(item.packageId);\r",
											"        // console.log (item.assets);\r",
											"        // let assets = [];\r",
											"        // assets = item.assets;\r",
											"        // console.log (assets);\r",
											"            pm.expect(item).to.have.property('name');\r",
											"            names.push(item.name);\r",
											"\r",
											"    });\r",
											"\r",
											"    //     pm.expect(packageIds).to.include.members(allowedPackages);\r",
											"});\r",
											"\r",
											"console.log(\"packageIds = \" + packageIds);\r",
											"\r",
											"pm.test(\"Response contains authorized packageIds for this user\", function () {\r",
											"    jsonData.forEach(function (item) {\r",
											"        console.log(\"checking packageId: \" + item.packageId);\r",
											"        pm.expect(parseInt(item.packageId)).to.be.oneOf(allowedPackages);\r",
											"    });\r",
											"});\r",
											"\r",
											"let packageMatchString = pm.environment.get(\"packageMatchString\");\r",
											"\r",
											"console.log(\"package string = \" + packageMatchString);\r",
											"var regex = new RegExp(packageMatchString);\r",
											"\r",
											"pm.test(\"Response contains authorized package names for this user\", function () {\r",
											"    names.forEach(function (name) {\r",
											"        console.log(\"checking name: \" + name);\r",
											"        pm.expect(name).to.match(regex);\r",
											"    });\r",
											"});\r",
											"\r",
											"\r",
											"\r",
											"\r",
											"\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/packages?name={{packageMatchString}}&elevate={{elevated}}",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages"
									],
									"query": [
										{
											"key": "name",
											"value": "{{packageMatchString}}",
											"description": "Matches a string anywhere in the object name"
										},
										{
											"key": "workflow",
											"value": "<string>",
											"description": "Match Packages having a specific workflow.",
											"disabled": true
										},
										{
											"key": "elevate",
											"value": "{{elevated}}",
											"description": "Elevate the user context for this request if user is permitted (canAdmin)"
										}
									]
								}
							},
							"response": [
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/packages?name=<string>&workflow=<string>&elevate=<boolean>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"packages"
											],
											"query": [
												{
													"key": "name",
													"value": "<string>"
												},
												{
													"key": "workflow",
													"value": "<string>"
												},
												{
													"key": "elevate",
													"value": "<boolean>"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								},
								{
									"name": "PackageProjected response",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/packages?name=<string>&workflow=<string>&elevate=<boolean>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"packages"
											],
											"query": [
												{
													"key": "name",
													"value": "<string>"
												},
												{
													"key": "workflow",
													"value": "<string>"
												},
												{
													"key": "elevate",
													"value": "<boolean>"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "[\n {\n  \"packageId\": \"<integer>\",\n  \"name\": \"<string>\",\n  \"workflow\": \"<string>\",\n  \"metadata\": \"<object>\"\n },\n {\n  \"packageId\": \"<integer>\",\n  \"name\": \"<string>\",\n  \"workflow\": \"<string>\",\n  \"metadata\": \"<object>\"\n }\n]"
								}
							]
						},
						{
							"name": "packages/{packageId} - patch scrap package with BAD ASSET",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "cf1e9dff-3dbc-431f-8cb0-1531421812d8",
										"exec": [
											"\r",
											"pm.test(\"Status should be is 204 (no content) for request with invalid parameter\", function () {\r",
											"    pm.response.to.have.status(204);\r",
											"});\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PATCH",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"name\": \"Package Z Patched\",\n  \"workflow\": \"continuous\",\n  \"metadata\": {\n  \"pocName\": \"poc2Patched\",\n  \"pocEmail\": \"pocEmail@email.com\",\n  \"pocPhone\": \"12342\",\n  \"reqRar\": true\n  },\n  \"grants\": [\n    \n  ]\n}",
									"options": {
										"raw": {}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/packages/:packageId?projection=assets&projection=stigs&elevate={{elevated}}",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages",
										":packageId"
									],
									"query": [
										{
											"key": "projection",
											"value": "assets",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "stigs",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "elevate",
											"value": "{{elevated}}"
										}
									],
									"variable": [
										{
											"description": "(Required) A path parameter that indentifies a Package",
											"key": "packageId",
											"type": "string",
											"value": "{{testPackageScrap}}"
										}
									]
								}
							},
							"response": [
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"emassId\": \"<string>\",\n    \"pocName\": \"<string>\",\n    \"pocEmail\": \"<string>\",\n    \"pocPhone\": \"<string>\",\n    \"reqRar\": \"<boolean>\",\n    \"macCl\": \"<string>\",\n    \"assetIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ]\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/packages/:packageId?projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"packages",
												":packageId"
											],
											"query": [
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "packageId"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								},
								{
									"name": "PackageProjected response",
									"originalRequest": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"emassId\": \"<string>\",\n    \"pocName\": \"<string>\",\n    \"pocEmail\": \"<string>\",\n    \"pocPhone\": \"<string>\",\n    \"reqRar\": \"<boolean>\",\n    \"macCl\": \"<string>\",\n    \"assetIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ]\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/packages/:packageId?projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"packages",
												":packageId"
											],
											"query": [
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "packageId"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"packageId\": \"<integer>\",\n \"name\": \"<string>\",\n \"emassId\": \"<string>\",\n \"pocName\": \"<string>\",\n \"pocEmail\": \"<string>\",\n \"pocPhone\": \"<string>\",\n \"reqRar\": \"<boolean>\",\n \"macCl\": \"<string>\",\n \"assets\": [\n  {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  },\n  {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"title\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"title\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\"\n  }\n ]\n}"
								}
							]
						},
						{
							"name": "packages/{packageId} - patch with BAD PACKAGE",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "10ff95c3-96ca-4011-aa83-630baa55215d",
										"exec": [
											"\r",
											"pm.test(\"Status should be is 204 (no content) for request with invalid parameter\", function () {\r",
											"    pm.response.to.have.status(204);\r",
											"});\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PATCH",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"name\": \"testPackagePatched\",\n  \"workflow\": \"continuous\",\n  \"metadata\": {\n  \"pocName\": \"poc2Patched\",\n  \"pocEmail\": \"pocEmail@email.com\",\n  \"pocPhone\": \"12342\",\n  \"reqRar\": true\n  },\n  \"grants\": [\n    \n  ]\n}",
									"options": {
										"raw": {}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/packages/:packageId?projection=assets&projection=stigs&elevate={{elevated}}",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages",
										":packageId"
									],
									"query": [
										{
											"key": "projection",
											"value": "assets",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "stigs",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "elevate",
											"value": "{{elevated}}"
										}
									],
									"variable": [
										{
											"description": "(Required) A path parameter that indentifies a Package",
											"id": "877a89c9-11f1-4d95-8288-c7982ab9c5ea",
											"key": "packageId",
											"type": "string",
											"value": "2"
										}
									]
								}
							},
							"response": [
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"emassId\": \"<string>\",\n    \"pocName\": \"<string>\",\n    \"pocEmail\": \"<string>\",\n    \"pocPhone\": \"<string>\",\n    \"reqRar\": \"<boolean>\",\n    \"macCl\": \"<string>\",\n    \"assetIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ]\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/packages/:packageId?projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"packages",
												":packageId"
											],
											"query": [
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "packageId"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								},
								{
									"name": "PackageProjected response",
									"originalRequest": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"emassId\": \"<string>\",\n    \"pocName\": \"<string>\",\n    \"pocEmail\": \"<string>\",\n    \"pocPhone\": \"<string>\",\n    \"reqRar\": \"<boolean>\",\n    \"macCl\": \"<string>\",\n    \"assetIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ]\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/packages/:packageId?projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"packages",
												":packageId"
											],
											"query": [
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "packageId"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"packageId\": \"<integer>\",\n \"name\": \"<string>\",\n \"emassId\": \"<string>\",\n \"pocName\": \"<string>\",\n \"pocEmail\": \"<string>\",\n \"pocPhone\": \"<string>\",\n \"reqRar\": \"<boolean>\",\n \"macCl\": \"<string>\",\n \"assets\": [\n  {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  },\n  {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"title\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"title\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\"\n  }\n ]\n}"
								}
							]
						},
						{
							"name": "packages/{packageId} - patch in lvl 4 grant",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "dc183735-058d-4c28-9b3d-85b302f40997",
										"exec": [
											"\r",
											"pm.test(\"Status should be is 204 (no content) for request with invalid parameter\", function () {\r",
											"    pm.response.to.have.status(204);\r",
											"});\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PATCH",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n  \"name\": \"testPackagePatched\",\n  \"workflow\": \"continuous\",\n  \"metadata\": {\n  \"pocName\": \"poc2Patched\",\n  \"pocEmail\": \"pocEmail@email.com\",\n  \"pocPhone\": \"12342\",\n  \"reqRar\": true\n  },\n  \"grants\": [\n  {\n    \"userId\": \"1\",\n    \"accessLevel\": 3\n  }\n  ]\n}",
									"options": {
										"raw": {}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/packages/:packageId?projection=assets&projection=stigs&elevate=false&projection=grants",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages",
										":packageId"
									],
									"query": [
										{
											"key": "projection",
											"value": "assets",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "stigs",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "elevate",
											"value": "false"
										},
										{
											"key": "projection",
											"value": "grants"
										}
									],
									"variable": [
										{
											"description": "(Required) A path parameter that indentifies a Package",
											"id": "36513d79-6560-460a-8b52-a0c2543cd63a",
											"key": "packageId",
											"type": "string",
											"value": "{{packageZId}}"
										}
									]
								}
							},
							"response": [
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"emassId\": \"<string>\",\n    \"pocName\": \"<string>\",\n    \"pocEmail\": \"<string>\",\n    \"pocPhone\": \"<string>\",\n    \"reqRar\": \"<boolean>\",\n    \"macCl\": \"<string>\",\n    \"assetIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ]\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/packages/:packageId?projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"packages",
												":packageId"
											],
											"query": [
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "packageId"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								},
								{
									"name": "PackageProjected response",
									"originalRequest": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"emassId\": \"<string>\",\n    \"pocName\": \"<string>\",\n    \"pocEmail\": \"<string>\",\n    \"pocPhone\": \"<string>\",\n    \"reqRar\": \"<boolean>\",\n    \"macCl\": \"<string>\",\n    \"assetIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ]\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/packages/:packageId?projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"packages",
												":packageId"
											],
											"query": [
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "packageId"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"packageId\": \"<integer>\",\n \"name\": \"<string>\",\n \"emassId\": \"<string>\",\n \"pocName\": \"<string>\",\n \"pocEmail\": \"<string>\",\n \"pocPhone\": \"<string>\",\n \"reqRar\": \"<boolean>\",\n \"macCl\": \"<string>\",\n \"assets\": [\n  {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  },\n  {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"title\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"title\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\"\n  }\n ]\n}"
								}
							]
						},
						{
							"name": "Package - delete ELEVATED (pkg cleanup request)",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "a5783305-6b4e-4f69-b439-eb2847501fbb",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "oauth2",
									"oauth2": [
										{
											"key": "accessToken",
											"value": "{{token.admin}}",
											"type": "string"
										},
										{
											"key": "tokenType",
											"value": "bearer",
											"type": "string"
										},
										{
											"key": "addTokenTo",
											"value": "header",
											"type": "string"
										}
									]
								},
								"method": "DELETE",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/packages/:packageId?projection=assets&projection=stigs&elevate=true&projection=grants",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages",
										":packageId"
									],
									"query": [
										{
											"key": "projection",
											"value": "assets",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "stigs",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "elevate",
											"value": "true"
										},
										{
											"key": "projection",
											"value": "grants"
										}
									],
									"variable": [
										{
											"id": "7b7a86a0-1f8c-4e22-b1fc-e7e2b554696b",
											"key": "packageId",
											"type": "string",
											"value": "{{createdPackage}}"
										}
									]
								}
							},
							"response": [
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "DELETE",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/packages/:packageId?projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"packages",
												":packageId"
											],
											"query": [
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "packageId"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								},
								{
									"name": "PackageProjected response",
									"originalRequest": {
										"method": "DELETE",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/packages/:packageId?projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"packages",
												":packageId"
											],
											"query": [
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "packageId"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"packageId\": \"<integer>\",\n \"name\": \"<string>\",\n \"emassId\": \"<string>\",\n \"pocName\": \"<string>\",\n \"pocEmail\": \"<string>\",\n \"pocPhone\": \"<string>\",\n \"reqRar\": \"<boolean>\",\n \"macCl\": \"<string>\",\n \"assets\": [\n  {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  },\n  {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"title\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"title\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\"\n  }\n ]\n}"
								}
							]
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "Packages - get -",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "e67a3b79-642c-4a1f-add1-0c7d35d73bab",
								"exec": [
									"let user = pm.environment.get(\"user\");\r",
									"console.log(\"user: \" + user);\r",
									"if (user == \"wf10\") {\r",
									"    pm.test(\"Status should be is 403 for user wf10\", function () {\r",
									"        pm.response.to.have.status(403);\r",
									"    });\r",
									"    return;\r",
									"}\r",
									"else {\r",
									"    pm.test(\"Status code is 200\", function () {\r",
									"        pm.response.to.have.status(200);\r",
									"    });\r",
									"}\r",
									"\r",
									"let jsonData = pm.response.json();\r",
									"\r",
									"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
									"    user = \"elevated\";\r",
									"}\r",
									"\r",
									"\r",
									"let allowedPackages, disallowedPackages, validStigs, invalidStigs, validAssets, invalidAssets;\r",
									"\r",
									"console.log(\"building valid assignments lists\");\r",
									"\r",
									"allowedPackages = JSON.parse(pm.environment.get((\"packages.valid\")));\r",
									"console.log(\"user is \" + user);\r",
									"\r",
									"\r",
									"\r",
									"\r",
									"pm.test(\"Response JSON is an array\", function () {\r",
									"    pm.expect(jsonData).to.be.an('array');\r",
									"});\r",
									"\r",
									"let packageIds = [];\r",
									"let names = [];\r",
									"let stigIds = [];\r",
									"pm.test(\"Each item in response has proper properties\", function () {\r",
									"    jsonData.forEach(function (item) {\r",
									"        pm.expect(item).to.have.property('packageId');\r",
									"        packageIds.push(item.packageId);\r",
									"        // console.log (item.assets);\r",
									"        // let assets = [];\r",
									"        // assets = item.assets;\r",
									"        // console.log (assets);\r",
									"            pm.expect(item).to.have.property('name');\r",
									"            names.push(item.name);\r",
									"\r",
									"    });\r",
									"\r",
									"    //     pm.expect(packageIds).to.include.members(allowedPackages);\r",
									"});\r",
									"\r",
									"console.log(\"packageIds = \" + packageIds);\r",
									"\r",
									"pm.test(\"Response contains authorized packageIds for this user\", function () {\r",
									"    jsonData.forEach(function (item) {\r",
									"        console.log(\"checking packageId: \" + item.packageId);\r",
									"        pm.expect(parseInt(item.packageId)).to.be.oneOf(allowedPackages);\r",
									"    });\r",
									"});\r",
									"\r",
									"let packageMatchString = pm.environment.get(\"packageMatchString\");\r",
									"\r",
									"console.log(\"package string = \" + packageMatchString);\r",
									"var regex = new RegExp(packageMatchString);\r",
									"\r",
									"pm.test(\"Response contains authorized package names for this user\", function () {\r",
									"    names.forEach(function (name) {\r",
									"        console.log(\"checking name: \" + name);\r",
									"        pm.expect(name).to.match(regex);\r",
									"    });\r",
									"});\r",
									"\r",
									"\r",
									"\r",
									"\r",
									"\r",
									"\r",
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"id": "bf260fb4-ce3e-4a2e-a3f2-3154f81aa70f",
								"exec": [
									"// pm.environment.set(\"user\", \"admin\");",
									"// var user = pm.environment.get(\"user\");",
									"// let token = pm.environment.get(\"token.\" + user)",
									"// pm.environment.set(\"token\", token);",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/packages?elevate={{elevated}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"packages"
							],
							"query": [
								{
									"key": "elevate",
									"value": "{{elevated}}"
								},
								{
									"key": "workflow",
									"value": "{{workflow}}",
									"disabled": true
								},
								{
									"key": "name",
									"value": "{{packageSearchString}}",
									"disabled": true
								}
							]
						}
					},
					"response": [
						{
							"name": "PackageProjected response",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/packages?elevate=<boolean>&projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages"
									],
									"query": [
										{
											"key": "elevate",
											"value": "<boolean>"
										},
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "[\n {\n  \"packageId\": \"<integer>\",\n  \"name\": \"<string>\",\n  \"emassId\": \"<string>\",\n  \"pocName\": \"<string>\",\n  \"pocEmail\": \"<string>\",\n  \"pocPhone\": \"<string>\",\n  \"reqRar\": \"<boolean>\",\n  \"assets\": [\n   {\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\"\n   },\n   {\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\"\n   }\n  ],\n  \"stigs\": [\n   {\n    \"benchmarkId\": \"<string>\",\n    \"title\": \"<string>\",\n    \"lastRevisionStr\": \"<string>\",\n    \"lastRevisionDate\": \"<string>\"\n   },\n   {\n    \"benchmarkId\": \"<string>\",\n    \"title\": \"<string>\",\n    \"lastRevisionStr\": \"<string>\",\n    \"lastRevisionDate\": \"<string>\"\n   }\n  ]\n },\n {\n  \"packageId\": \"<integer>\",\n  \"name\": \"<string>\",\n  \"emassId\": \"<string>\",\n  \"pocName\": \"<string>\",\n  \"pocEmail\": \"<string>\",\n  \"pocPhone\": \"<string>\",\n  \"reqRar\": \"<boolean>\",\n  \"assets\": [\n   {\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\"\n   },\n   {\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\"\n   }\n  ],\n  \"stigs\": [\n   {\n    \"benchmarkId\": \"<string>\",\n    \"title\": \"<string>\",\n    \"lastRevisionStr\": \"<string>\",\n    \"lastRevisionDate\": \"<string>\"\n   },\n   {\n    \"benchmarkId\": \"<string>\",\n    \"title\": \"<string>\",\n    \"lastRevisionStr\": \"<string>\",\n    \"lastRevisionDate\": \"<string>\"\n   }\n  ]\n }\n]"
						},
						{
							"name": "Packages - no params",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/packages",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "X-Powered-By",
									"value": "Express"
								},
								{
									"key": "Access-Control-Allow-Origin",
									"value": "*"
								},
								{
									"key": "Content-Type",
									"value": "application/json"
								},
								{
									"key": "Date",
									"value": "Wed, 15 Apr 2020 02:52:21 GMT"
								},
								{
									"key": "Connection",
									"value": "keep-alive"
								},
								{
									"key": "Transfer-Encoding",
									"value": "chunked"
								}
							],
							"cookie": [],
							"body": "[\n    {\n        \"packageId\": 21,\n        \"name\": \"Code 60 Package\",\n        \"emassId\": \"none\",\n        \"pocName\": \"W. E. Coyote\",\n        \"pocEmail\": \"coyote@navy.mil\",\n        \"pocPhone\": \"555-1212\",\n        \"reqRar\": false\n    },\n    {\n        \"packageId\": 1,\n        \"name\": \"STAR Package\",\n        \"emassId\": \"none\",\n        \"pocName\": \"Bob\",\n        \"pocEmail\": \"bob@navy.mil\",\n        \"pocPhone\": \"555-1212\",\n        \"reqRar\": false\n    },\n    {\n        \"packageId\": 62,\n        \"name\": \"Twine\",\n        \"emassId\": null,\n        \"pocName\": null,\n        \"pocEmail\": null,\n        \"pocPhone\": null,\n        \"reqRar\": false\n    }\n]"
						},
						{
							"name": "Return a list of Packages accessible to the requester",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/packages?elevate=<boolean>&projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages"
									],
									"query": [
										{
											"key": "elevate",
											"value": "<boolean>",
											"description": "Elevate the user context for this request if user is permitted (canAdmin)"
										},
										{
											"key": "projection",
											"value": "<string>",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "<string>",
											"description": "Additional properties to include in the response.\n"
										}
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "X-Powered-By",
									"value": "Express"
								},
								{
									"key": "Access-Control-Allow-Origin",
									"value": "*"
								},
								{
									"key": "Content-Type",
									"value": "application/json"
								},
								{
									"key": "Date",
									"value": "Tue, 14 Apr 2020 20:14:16 GMT"
								},
								{
									"key": "Connection",
									"value": "keep-alive"
								},
								{
									"key": "Transfer-Encoding",
									"value": "chunked"
								}
							],
							"cookie": [],
							"body": "[\n    {\n        \"packageId\": 21,\n        \"name\": \"Code 60 Package\",\n        \"emassId\": \"none\",\n        \"pocName\": \"W. E. Coyote\",\n        \"pocEmail\": \"coyote@navy.mil\",\n        \"pocPhone\": \"555-1212\",\n        \"reqRar\": false\n    },\n    {\n        \"packageId\": 1,\n        \"name\": \"STAR Package\",\n        \"emassId\": \"none\",\n        \"pocName\": \"Bob\",\n        \"pocEmail\": \"bob@navy.mil\",\n        \"pocPhone\": \"555-1212\",\n        \"reqRar\": false\n    },\n    {\n        \"packageId\": 62,\n        \"name\": \"Twine\",\n        \"emassId\": null,\n        \"pocName\": null,\n        \"pocEmail\": null,\n        \"pocPhone\": null,\n        \"reqRar\": false\n    }\n]"
						},
						{
							"name": "unexpected error",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/packages?elevate=<boolean>&projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages"
									],
									"query": [
										{
											"key": "elevate",
											"value": "<boolean>"
										},
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									]
								}
							},
							"status": "Internal Server Error",
							"code": 500,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
						},
						{
							"name": "Packages - Admin- no params",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/packages",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "X-Powered-By",
									"value": "Express"
								},
								{
									"key": "Access-Control-Allow-Origin",
									"value": "*"
								},
								{
									"key": "Content-Type",
									"value": "application/json"
								},
								{
									"key": "Cache-control",
									"value": "no-store"
								},
								{
									"key": "Date",
									"value": "Tue, 28 Apr 2020 20:27:24 GMT"
								},
								{
									"key": "Connection",
									"value": "keep-alive"
								},
								{
									"key": "Transfer-Encoding",
									"value": "chunked"
								}
							],
							"cookie": [],
							"body": "[\n    {\n        \"packageId\": 21,\n        \"name\": \"Code 60 Package\",\n        \"emassId\": \"none\",\n        \"pocName\": \"W. E. Coyote\",\n        \"pocEmail\": \"coyote@navy.mil\",\n        \"pocPhone\": \"555-1212\",\n        \"reqRar\": false\n    },\n    {\n        \"packageId\": 1,\n        \"name\": \"STAR Package\",\n        \"emassId\": \"none\",\n        \"pocName\": \"Bob\",\n        \"pocEmail\": \"bob@navy.mil\",\n        \"pocPhone\": \"555-1212\",\n        \"reqRar\": false\n    },\n    {\n        \"packageId\": 62,\n        \"name\": \"Twine\",\n        \"emassId\": null,\n        \"pocName\": null,\n        \"pocEmail\": null,\n        \"pocPhone\": null,\n        \"reqRar\": false\n    }\n]"
						}
					]
				},
				{
					"name": "packages/{packageId} - get",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "f68ed72e-5bb5-418e-b5a4-ae26caf8513c",
								"exec": [
									"let user = pm.environment.get(\"user\");",
									"console.log(\"user: \" + user);",
									"if (user == \"packageCreator\") {",
									"    pm.test(\"Status should be is 403 for user wf10\", function () {",
									"        pm.response.to.have.status(403);",
									"    });",
									"    return;",
									"}",
									"else {",
									"    pm.test(\"Status code is 200\", function () {",
									"        pm.response.to.have.status(200);",
									"    });",
									"}",
									"",
									"let jsonData = pm.response.json();",
									"",
									"let elevated = pm.environment.get(\"elevated\");",
									"console.log(\"user: \" + user);",
									"if (pm.request.url.getQueryString().match(/elevate=true/)) {",
									"    user = \"elevated\";",
									"}",
									"",
									"",
									"// var stuff = pm.request.auth;",
									"// console.log(stuff);",
									"// var stuff = pm.request;",
									"// console.log(stuff);",
									"",
									"//console.log(jsonData);",
									"// pm.test(\"Your test name (fail)\", function () {",
									"//     pm.expect(jsonData.value).to.eql(100);",
									"// });",
									"",
									"// pm.test(\"environment: stig-manager localhost packages\", function () {",
									"//     pm.expect(pm.environment.get(\"env\")).to.equal(\"stig-manager localhost packages\");",
									"// });",
									"",
									"console.log(jsonData);",
									"// console.log(pm.environment.get(\"env\"));",
									"",
									"pm.test(\"Response JSON is an object\", function () {",
									"    pm.expect(jsonData).to.be.an('object');",
									"});",
									"",
									"// let testPackage = JSON.parse(pm.environment.get((\"testPackage\")));",
									"// pm.test(\"Response JSON is an object with packageId\", function () {",
									"//     pm.expect(jsonData).to.have.deep.property('packageId', testPackage);",
									"// });",
									"",
									"let allowedPackages, disallowedPackages, validStigs, invalidStigs, validAssets, invalidAssets;",
									"console.log(\"assignments\");",
									"validStigs = JSON.parse(pm.environment.get(\"stigs.valid\"));",
									"// validAssets = JSON.parse(pm.environment.get(\"assets.valid\"));",
									"console.log(\"user is \" + user);",
									"",
									"",
									"let packageIds = [];",
									"let assetIds = [];",
									"let assetNames = [];",
									"let stigIds = [];",
									"pm.test(\"Each item in response has packageId\", function () {",
									"    pm.expect(jsonData).to.have.property('packageId');",
									"    packageIds.push(jsonData.packageId);",
									"    jsonData.assets.forEach(function (asset) {",
									"        pm.expect(asset).to.have.property('assetId');",
									"        assetIds.push(asset.assetId);",
									"        pm.expect(asset).to.have.property('name');",
									"        assetNames.push(asset.name);",
									"    });",
									"    jsonData.stigs.forEach(function (stig) {",
									"        pm.expect(stig).to.have.property('benchmarkId');",
									"        stigIds.push(stig.benchmarkId);",
									"    });",
									"    // pm.expect(packageIds).to.include.oneOf(allowedPackages);",
									"});",
									"",
									"console.log(\"packageIds = \" + packageIds);",
									"",
									"// pm.test(\"Response contains VALID packageIds for this user\", function () {",
									"//     // jsonData.forEach( function (item) {",
									"//     // console.log(\"checking packageId: \" + item.packageId);",
									"//     pm.expect(jsonData.packageId).to.be.oneOf(allowedPackages);",
									"//     // });",
									"// });",
									"",
									"",
									"",
									"",
									"let assetMatchString = pm.environment.get(\"assetMatchString\");",
									"",
									"console.log(\"asset string = \" + assetMatchString);",
									"var regex = new RegExp(assetMatchString);",
									"",
									"pm.test(\"Response contains authorized asset names for this user\", function () {",
									"    assetNames.forEach(function (name) {",
									"        console.log(\"checking name: \" + name);",
									"        pm.expect(name).to.match(regex);",
									"    });",
									"});",
									"",
									"",
									"",
									"",
									"",
									"",
									"",
									"// pm.test(\"Response does NOT contain INvalid packageIds for this user\", function () {",
									"//     // jsonData.forEach( function (item) {",
									"//     // console.log(\"checking packageId: \" + item.packageId);",
									"//     pm.expect(jsonData.packageId).to.not.be.oneOf(disallowedPackages);",
									"//     // });",
									"// });",
									"",
									"",
									"// if (user == \"wf60\" || user == \"officer60\") {",
									"//     pm.test(\"Response contains valid projection data (assets)\", function () {",
									"//         assetIds.forEach(function (assetId) {",
									"//             pm.expect(assetId).to.be.oneOf(validAssets);",
									"//             console.log(\"checking assetId: \" + assetId);",
									"//         });",
									"//     });",
									"",
									"//     pm.test(\"Response contains valid projection data (stigs)\", function () {",
									"//         stigIds.forEach(function (stigId) {",
									"//             pm.expect(stigId).to.be.oneOf(validStigs);",
									"//             console.log(\"checking stigId: \" + stigId);",
									"//         });",
									"//     });",
									"// }",
									"",
									"// if (user == \"wf60\" || user == \"officer60\") {",
									"//     pm.test(\"checking package assets returned\", function () {",
									"//         jsonData.assets.forEach(function (item) {",
									"//             console.log(\"checking assetId: \" + item.assetId);",
									"//             pm.expect(item.assetId).to.be.oneOf(validAssets);",
									"//         });",
									"//         // pm.expect(jsonData.assets).to.deep.include({packageId:21});",
									"//     });",
									"",
									"// }",
									"",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/packages/:packageId?projection=assets&projection=stigs&elevate={{elevated}}&projection=grants",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"packages",
								":packageId"
							],
							"query": [
								{
									"key": "projection",
									"value": "assets"
								},
								{
									"key": "projection",
									"value": "stigs"
								},
								{
									"key": "elevate",
									"value": "{{elevated}}"
								},
								{
									"key": "projection",
									"value": "grants"
								},
								{
									"key": "elevate",
									"value": "false",
									"disabled": true
								}
							],
							"variable": [
								{
									"id": "ce470dc6-c186-4939-b33a-e8e4c51ae8f6",
									"key": "packageId",
									"type": "string",
									"value": "{{testPackage}}"
								}
							]
						}
					},
					"response": [
						{
							"name": "PackageProjected response",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/packages/:packageId?elevate=<boolean>&projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages",
										":packageId"
									],
									"query": [
										{
											"key": "elevate",
											"value": "<boolean>"
										},
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									],
									"variable": [
										{
											"key": "packageId"
										}
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"packageId\": \"<integer>\",\n \"name\": \"<string>\",\n \"emassId\": \"<string>\",\n \"pocName\": \"<string>\",\n \"pocEmail\": \"<string>\",\n \"pocPhone\": \"<string>\",\n \"reqRar\": \"<boolean>\",\n \"macCl\": \"<string>\",\n \"assets\": [\n  {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  },\n  {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"title\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"title\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\"\n  }\n ]\n}"
						},
						{
							"name": "unexpected error",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/packages/:packageId?elevate=<boolean>&projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages",
										":packageId"
									],
									"query": [
										{
											"key": "elevate",
											"value": "<boolean>"
										},
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									],
									"variable": [
										{
											"key": "packageId"
										}
									]
								}
							},
							"status": "Internal Server Error",
							"code": 500,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
						}
					]
				},
				{
					"name": "Packages - post",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "08a7525c-65eb-4c8e-97d1-b68e8c70a2e9",
								"exec": [
									"let user = pm.environment.get(\"user\");",
									"console.log(\"user: \" + user);",
									"if (user == \"wf10\") {",
									"    pm.test(\"Status should be is 403 for user wf10\", function () {",
									"        pm.response.to.have.status(403);",
									"    });",
									"    return;",
									"}",
									"",
									"if (pm.request.url.getQueryString().match(/elevate=true/)) {",
									"    user = \"elevated\";",
									"    console.log(\"user is elevated\");",
									"",
									"}",
									"",
									"",
									"var stuff = pm.request.auth;",
									"var stuff = pm.request;",
									"",
									"if (user == 'elevated' || user == 'packageCreator') {",
									"    pm.test(\"User is elevated or packageCreator. Status code is 201\", function () {",
									"        pm.response.to.have.status(201);",
									"    });",
									"}",
									"else {",
									"    pm.test(\"User is not packageCreator or elevated. Expected status code is 403\", function () {",
									"        pm.response.to.have.status(403);",
									"    });",
									"    return;",
									"}",
									"",
									"if (pm.response.code == 500) {",
									"    console.log(\"Server returned 500\")",
									"    return;",
									"}",
									"",
									"var jsonData = pm.response.json();",
									"",
									"",
									"",
									"pm.test(\"Response JSON is an object\", function () {",
									"    pm.expect(jsonData).to.be.an('object');",
									"});",
									"",
									"let createdPackage = jsonData.packageId;",
									"if (createdPackage === undefined) {",
									"    console.log(\"Did not create package. Setting to dummy value: \" + createdPackage)",
									"    pm.environment.set(\"createdPackage\", 2);",
									"    return;",
									"}",
									"console.log(\"created package: \" + createdPackage)",
									"pm.environment.set(\"createdPackage\", createdPackage);",
									"",
									"pm.test(`Created Package: ${createdPackage}`, function () {",
									"    pm.expect(createdPackage).to.be.an('string');",
									"});",
									"",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"name\": \"z_packageTestCreate-1\",\r\n  \"workflow\": \"continuous\",\r\n  \"metadata\": {\r\n  \"pocName\": \"poc2\",\r\n  \"pocEmail\": \"pocEmail@email.com\",\r\n  \"pocPhone\": \"12342\",\r\n  \"reqRar\": true\r\n  },\r\n  \"grants\": [\r\n      {\r\n    \"userId\": \"1\",\r\n    \"accessLevel\": 4\r\n  },\r\n  {\r\n    \"userId\": \"82\",\r\n    \"accessLevel\": 4\r\n  }\r\n  ]\r\n}",
							"options": {
								"raw": {}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/packages?projection=assets&projection=stigs&elevate={{elevated}}&projection=grants",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"packages"
							],
							"query": [
								{
									"key": "projection",
									"value": "assets"
								},
								{
									"key": "projection",
									"value": "stigs"
								},
								{
									"key": "elevate",
									"value": "{{elevated}}"
								},
								{
									"key": "projection",
									"value": "grants"
								}
							]
						}
					},
					"response": [
						{
							"name": "unexpected error",
							"originalRequest": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"emassId\": \"<string>\",\n    \"pocName\": \"<string>\",\n    \"pocEmail\": \"<string>\",\n    \"pocPhone\": \"<string>\",\n    \"reqRar\": \"<boolean>\",\n    \"macCl\": \"<string>\",\n    \"assetIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ]\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/packages?projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages"
									],
									"query": [
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									]
								}
							},
							"status": "Internal Server Error",
							"code": 500,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
						},
						{
							"name": "PackageProjected response",
							"originalRequest": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"emassId\": \"<string>\",\n    \"pocName\": \"<string>\",\n    \"pocEmail\": \"<string>\",\n    \"pocPhone\": \"<string>\",\n    \"reqRar\": \"<boolean>\",\n    \"macCl\": \"<string>\",\n    \"assetIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ]\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/packages?projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages"
									],
									"query": [
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									]
								}
							},
							"status": "Created",
							"code": 201,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "[\n {\n  \"packageId\": \"<integer>\",\n  \"name\": \"<string>\",\n  \"emassId\": \"<string>\",\n  \"pocName\": \"<string>\",\n  \"pocEmail\": \"<string>\",\n  \"pocPhone\": \"<string>\",\n  \"reqRar\": \"<boolean>\",\n  \"macCl\": \"<string>\",\n  \"assets\": [\n   {\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\"\n   },\n   {\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\"\n   }\n  ],\n  \"stigs\": [\n   {\n    \"benchmarkId\": \"<string>\",\n    \"title\": \"<string>\",\n    \"lastRevisionStr\": \"<string>\",\n    \"lastRevisionDate\": \"<string>\"\n   },\n   {\n    \"benchmarkId\": \"<string>\",\n    \"title\": \"<string>\",\n    \"lastRevisionStr\": \"<string>\",\n    \"lastRevisionDate\": \"<string>\"\n   }\n  ]\n },\n {\n  \"packageId\": \"<integer>\",\n  \"name\": \"<string>\",\n  \"emassId\": \"<string>\",\n  \"pocName\": \"<string>\",\n  \"pocEmail\": \"<string>\",\n  \"pocPhone\": \"<string>\",\n  \"reqRar\": \"<boolean>\",\n  \"macCl\": \"<string>\",\n  \"assets\": [\n   {\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\"\n   },\n   {\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\"\n   }\n  ],\n  \"stigs\": [\n   {\n    \"benchmarkId\": \"<string>\",\n    \"title\": \"<string>\",\n    \"lastRevisionStr\": \"<string>\",\n    \"lastRevisionDate\": \"<string>\"\n   },\n   {\n    \"benchmarkId\": \"<string>\",\n    \"title\": \"<string>\",\n    \"lastRevisionStr\": \"<string>\",\n    \"lastRevisionDate\": \"<string>\"\n   }\n  ]\n }\n]"
						}
					]
				},
				{
					"name": "Package - delete - uses lvl4 grant from created package or elevation",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "0c1bab7f-5a86-4196-acc9-f632c92a47ac",
								"exec": [
									"",
									"let user = pm.environment.get(\"user\");",
									"console.log(\"user: \" + user);",
									"",
									"",
									"if (pm.request.url.getQueryString().match(/elevate=true/)) {",
									"    user = \"elevated\";",
									"}",
									"",
									"",
									"if (user == \"elevated\" || user == \"packageCreator\") {",
									"     pm.test(\"Status code should be 200 for pacakgeCreator or elevated. packageCreator sets self as lvl4 for created packages\", function () {",
									"        pm.response.to.have.status(200);",
									"    });",
									"        ",
									"}",
									"else{",
									"    pm.test(\"Status code should be 403\", function () {",
									"        pm.response.to.have.status(403);",
									"    });",
									"    console.log(`Status code: ${pm.response.code}. Either previous test did not create the package, the package has already been deleted, or this user is not authorized to delete this package.`);",
									"    return;",
									"}",
									"",
									"var jsonData = pm.response.json();",
									"",
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"console.log(jsonData);",
									"// console.log(pm.environment.get(\"env\"));",
									"",
									"pm.test(\"Response is an array with one JSON object\", function () {",
									"    pm.expect(jsonData).to.be.an('object');",
									"});",
									"",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/packages/:packageId?projection=assets&projection=stigs&elevate={{elevated}}&projection=grants",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"packages",
								":packageId"
							],
							"query": [
								{
									"key": "projection",
									"value": "assets",
									"description": "Additional properties to include in the response.\n"
								},
								{
									"key": "projection",
									"value": "stigs",
									"description": "Additional properties to include in the response.\n"
								},
								{
									"key": "elevate",
									"value": "{{elevated}}"
								},
								{
									"key": "projection",
									"value": "grants"
								}
							],
							"variable": [
								{
									"id": "c5d04b00-9c54-4951-8e22-f18c05f8affa",
									"key": "packageId",
									"type": "string",
									"value": "{{createdPackage}}"
								}
							]
						}
					},
					"response": [
						{
							"name": "unexpected error",
							"originalRequest": {
								"method": "DELETE",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/packages/:packageId?projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages",
										":packageId"
									],
									"query": [
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									],
									"variable": [
										{
											"key": "packageId"
										}
									]
								}
							},
							"status": "Internal Server Error",
							"code": 500,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
						},
						{
							"name": "PackageProjected response",
							"originalRequest": {
								"method": "DELETE",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/packages/:packageId?projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages",
										":packageId"
									],
									"query": [
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									],
									"variable": [
										{
											"key": "packageId"
										}
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"packageId\": \"<integer>\",\n \"name\": \"<string>\",\n \"emassId\": \"<string>\",\n \"pocName\": \"<string>\",\n \"pocEmail\": \"<string>\",\n \"pocPhone\": \"<string>\",\n \"reqRar\": \"<boolean>\",\n \"macCl\": \"<string>\",\n \"assets\": [\n  {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  },\n  {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"title\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"title\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\"\n  }\n ]\n}"
						}
					]
				},
				{
					"name": "packages/{packageId} - patch",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "359413f2-4c4a-4075-a650-449a5183415c",
								"exec": [
									"let user = pm.environment.get(\"user\");\r",
									"console.log(\"user: \" + user);\r",
									"if (user == \"wf10\") {\r",
									"    pm.test(\"Status should be is 403 for user wf10\", function () {\r",
									"        pm.response.to.have.status(403);\r",
									"    });\r",
									"    return;\r",
									"}\r",
									"\r",
									"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
									"    user = \"elevated\";\r",
									"    console.log(\"user is elevated\");\r",
									"\r",
									"}\r",
									"\r",
									"if (user == 'elevated' || user == 'lvl3' || user == \"lvl4\") {\r",
									"    pm.test(\"User is elevated or Staff. Status code should be 200\", function () {\r",
									"        pm.response.to.have.status(200);\r",
									"    });\r",
									"}\r",
									"else {\r",
									"    pm.test(\"User is not Staff or elevated. Expected status code is 403\", function () {\r",
									"        pm.response.to.have.status(403);\r",
									"    });\r",
									"    return;\r",
									"}\r",
									"\r",
									"if (pm.response.code == 500) {\r",
									"    console.log(\"Server returned 500\")\r",
									"    return;\r",
									"}\r",
									"\r",
									"let createdPackage = pm.environment.get(\"createdPackage\");\r",
									"if (createdPackage === undefined) {\r",
									"    return;\r",
									"}\r",
									"\r",
									"if (pm.response.code == 204) {\r",
									"    console.log(\"Server returned 204 No Content\")\r",
									"    return;\r",
									"}\r",
									"\r",
									"let jsonData = pm.response.json();\r",
									"\r",
									"//console.log(jsonData);\r",
									"// pm.test(\"Your test name (fail)\", function () {\r",
									"//     pm.expect(jsonData.value).to.eql(100);\r",
									"// });\r",
									"\r",
									"\r",
									"pm.test(\"Response JSON is an object\", function () {\r",
									"    pm.expect(jsonData).to.be.an('object');\r",
									"});\r",
									"\r",
									"let patchedPackage = jsonData.packageId;\r",
									"// console.log(\"created package: \" + createdPackage)\r",
									"// pm.environment.set(\"createdPackage\", createdPackage);\r",
									"\r",
									"pm.test(`Patched Package: ${patchedPackage}`, function () {\r",
									"    pm.expect(patchedPackage).to.be.an('string');\r",
									"});\r",
									"\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Package X\",\n  \"workflow\": \"continuous\",\n  \"metadata\": {\n  \"pocName\": \"poc2Patched\",\n  \"pocEmail\": \"pocEmail@email.com\",\n  \"pocPhone\": \"12342\",\n  \"reqRar\": true\n  },\n    \"grants\": [\n        {\n          \"userId\": \"85\",\n          \"accessLevel\": 1\n        },\n        {\n                \"userId\": \"21\",\n            \"accessLevel\": 2\n        },\n        {\n                \"userId\": \"44\",\n            \"accessLevel\": 3\n        },\n        {\n                \"userId\": \"45\",\n            \"accessLevel\": 4\n        }\n    ]\n}",
							"options": {
								"raw": {}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/packages/:packageId?projection=assets&projection=stigs&elevate={{elevated}}&projection=grants",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"packages",
								":packageId"
							],
							"query": [
								{
									"key": "projection",
									"value": "assets"
								},
								{
									"key": "projection",
									"value": "stigs"
								},
								{
									"key": "elevate",
									"value": "{{elevated}}"
								},
								{
									"key": "projection",
									"value": "grants"
								}
							],
							"variable": [
								{
									"key": "packageId",
									"type": "string",
									"value": "{{testPackage}}"
								}
							]
						}
					},
					"response": [
						{
							"name": "unexpected error",
							"originalRequest": {
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"emassId\": \"<string>\",\n    \"pocName\": \"<string>\",\n    \"pocEmail\": \"<string>\",\n    \"pocPhone\": \"<string>\",\n    \"reqRar\": \"<boolean>\",\n    \"macCl\": \"<string>\",\n    \"assetIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ]\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/packages/:packageId?projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages",
										":packageId"
									],
									"query": [
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									],
									"variable": [
										{
											"key": "packageId"
										}
									]
								}
							},
							"status": "Internal Server Error",
							"code": 500,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
						},
						{
							"name": "PackageProjected response",
							"originalRequest": {
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"emassId\": \"<string>\",\n    \"pocName\": \"<string>\",\n    \"pocEmail\": \"<string>\",\n    \"pocPhone\": \"<string>\",\n    \"reqRar\": \"<boolean>\",\n    \"macCl\": \"<string>\",\n    \"assetIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ]\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/packages/:packageId?projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages",
										":packageId"
									],
									"query": [
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									],
									"variable": [
										{
											"key": "packageId"
										}
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"packageId\": \"<integer>\",\n \"name\": \"<string>\",\n \"emassId\": \"<string>\",\n \"pocName\": \"<string>\",\n \"pocEmail\": \"<string>\",\n \"pocPhone\": \"<string>\",\n \"reqRar\": \"<boolean>\",\n \"macCl\": \"<string>\",\n \"assets\": [\n  {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  },\n  {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"title\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"title\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\"\n  }\n ]\n}"
						}
					]
				},
				{
					"name": "packages/{packageId} - put",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "a9bae891-4d5a-45ea-a1c3-41ceaf967cac",
								"exec": [
									"let user = pm.environment.get(\"user\");\r",
									"console.log(\"user: \" + user);\r",
									"if (user == \"wf10\") {\r",
									"    pm.test(\"Status should be is 403 for user wf10\", function () {\r",
									"        pm.response.to.have.status(403);\r",
									"    });\r",
									"    return;\r",
									"}\r",
									"\r",
									"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
									"    user = \"elevated\";\r",
									"    console.log(\"user is elevated\");\r",
									"\r",
									"}\r",
									"\r",
									"if (user == 'elevated' || user == 'lvl3' || user == 'lvl4') {\r",
									"    pm.test(\"User is elevated. Status code is 200\", function () {\r",
									"        pm.response.to.have.status(200);\r",
									"    });\r",
									"}\r",
									"else {\r",
									"    pm.test(\"User is not Staff or elevated. Expected status code is 403\", function () {\r",
									"        pm.response.to.have.status(403);\r",
									"    });\r",
									"    return;\r",
									"}\r",
									"\r",
									"if (pm.response.code == 500) {\r",
									"    console.log(\"Server returned 500\")\r",
									"    return;\r",
									"}\r",
									"\r",
									"var jsonData = pm.response.json();\r",
									"\r",
									"//console.log(jsonData);\r",
									"// pm.test(\"Your test name (fail)\", function () {\r",
									"//     pm.expect(jsonData.value).to.eql(100);\r",
									"// });\r",
									"\r",
									"\r",
									"pm.test(\"Response JSON is an object\", function () {\r",
									"    pm.expect(jsonData).to.be.an('object');\r",
									"});\r",
									"\r",
									"let putPackage = jsonData.packageId;\r",
									"// console.log(\"created package: \" + createdPackage)\r",
									"// pm.environment.set(\"createdPackage\", createdPackage);\r",
									"\r",
									"pm.test(`PUT Package: ${putPackage}`, function () {\r",
									"    pm.expect(putPackage).to.be.an('string');\r",
									"});\r",
									"\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"name\": \"Package X\",\r\n  \"workflow\": \"continuous\",\r\n  \"metadata\": {\r\n  \"pocName\": \"poc2Put\",\r\n  \"pocEmail\": \"pocEmailPut@email.com\",\r\n  \"pocPhone\": \"12342\",\r\n  \"reqRar\": true\r\n  },\r\n    \"grants\": [\r\n        {\r\n          \"userId\": \"85\",\r\n          \"accessLevel\": 1\r\n        },\r\n        {\r\n                \"userId\": \"21\",\r\n            \"accessLevel\": 2\r\n        },\r\n        {\r\n                \"userId\": \"44\",\r\n            \"accessLevel\": 3\r\n        },\r\n        {\r\n                \"userId\": \"45\",\r\n            \"accessLevel\": 4\r\n        }\r\n    ]\r\n}\r\n",
							"options": {
								"raw": {}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/packages/:packageId?projection=assets&projection=stigs&elevate={{elevated}}&projection=grants",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"packages",
								":packageId"
							],
							"query": [
								{
									"key": "projection",
									"value": "assets",
									"description": "Additional properties to include in the response.\n"
								},
								{
									"key": "projection",
									"value": "stigs",
									"description": "Additional properties to include in the response.\n"
								},
								{
									"key": "elevate",
									"value": "{{elevated}}"
								},
								{
									"key": "projection",
									"value": "grants"
								}
							],
							"variable": [
								{
									"description": "(Required) A path parameter that indentifies a Package",
									"id": "35c18528-2b8a-4225-ab25-df9a8baf7370",
									"key": "packageId",
									"type": "string",
									"value": "{{testPackage}}"
								}
							]
						}
					},
					"response": [
						{
							"name": "PackageProjected response",
							"originalRequest": {
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"emassId\": \"<string>\",\n    \"pocName\": \"<string>\",\n    \"pocEmail\": \"<string>\",\n    \"pocPhone\": \"<string>\",\n    \"reqRar\": \"<boolean>\",\n    \"macCl\": \"<string>\",\n    \"assetIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ]\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/packages/:packageId?projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages",
										":packageId"
									],
									"query": [
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									],
									"variable": [
										{
											"key": "packageId"
										}
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"packageId\": \"<integer>\",\n \"name\": \"<string>\",\n \"emassId\": \"<string>\",\n \"pocName\": \"<string>\",\n \"pocEmail\": \"<string>\",\n \"pocPhone\": \"<string>\",\n \"reqRar\": \"<boolean>\",\n \"macCl\": \"<string>\",\n \"assets\": [\n  {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  },\n  {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"title\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"title\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\"\n  }\n ]\n}"
						},
						{
							"name": "unexpected error",
							"originalRequest": {
								"method": "PATCH",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"emassId\": \"<string>\",\n    \"pocName\": \"<string>\",\n    \"pocEmail\": \"<string>\",\n    \"pocPhone\": \"<string>\",\n    \"reqRar\": \"<boolean>\",\n    \"macCl\": \"<string>\",\n    \"assetIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ]\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/packages/:packageId?projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages",
										":packageId"
									],
									"query": [
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									],
									"variable": [
										{
											"key": "packageId"
										}
									]
								}
							},
							"status": "Internal Server Error",
							"code": 500,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
						}
					]
				},
				{
					"name": "packages/packageId/checklist LATEST - get",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "c139c3e6-6938-4b5c-beca-feb7dbe21e65",
								"exec": [
									"let user = pm.environment.get(\"user\");\r",
									"console.log(\"user: \" + user);\r",
									"if (user == \"wf10\") {\r",
									"    pm.test(\"Status should be is 403 for user wf10\", function () {\r",
									"        pm.response.to.have.status(403);\r",
									"    });\r",
									"    return;\r",
									"}\r",
									"\r",
									"\r",
									"\r",
									"pm.test(\"Status code is 200\", function () {\r",
									"    pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"var jsonData = pm.response.json();\r",
									"\r",
									"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
									"    user = \"elevated\";\r",
									"}\r",
									"\r",
									"pm.test(\"Check for an array of checklist items.\", function () {\r",
									"    pm.expect(jsonData).to.be.an('array');\r",
									"    console.log(\"jsonData:\" + jsonData);\r",
									"\r",
									"});\r",
									"\r",
									"\r",
									"\r",
									"\r",
									"\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/packages/{{testPackage}}/checklists/{{testBenchmark}}/latest",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"packages",
								"{{testPackage}}",
								"checklists",
								"{{testBenchmark}}",
								"latest"
							]
						},
						"description": "Returns checklist for specified package/benchmark/rev"
					},
					"response": []
				},
				{
					"name": "packages/packageId/checklist revisionStr - get",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "fa45bfd6-6520-4903-8aa1-4765a442967f",
								"exec": [
									"let user = pm.environment.get(\"user\");\r",
									"console.log(\"user: \" + user);\r",
									"if (user == \"wf10\") {\r",
									"    pm.test(\"Status should be is 403 for user wf10\", function () {\r",
									"        pm.response.to.have.status(403);\r",
									"    });\r",
									"    return;\r",
									"}\r",
									"\r",
									"\r",
									"pm.test(\"Status code is 200\", function () {\r",
									"    pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"var jsonData = pm.response.json();\r",
									"\r",
									"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
									"    user = \"elevated\";\r",
									"}\r",
									"\r",
									"pm.test(\"Check for an array of checklist items.\", function () {\r",
									"    pm.expect(jsonData).to.be.an('array');\r",
									"    console.log(\"jsonData:\" + jsonData);\r",
									"\r",
									"});\r",
									"\r",
									"\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/packages/{{testPackage}}/checklists/{{testBenchmark}}/{{testRev}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"packages",
								"{{testPackage}}",
								"checklists",
								"{{testBenchmark}}",
								"{{testRev}}"
							]
						},
						"description": "Returns checklist for specified package/benchmark/rev"
					},
					"response": []
				},
				{
					"name": "Return the Findings for the specified Package",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "b8e7cfc3-0d59-486d-8040-55335257f510",
								"exec": [
									"pm.test(\"Status code is 200\", function () {\r",
									"    pm.response.to.have.status(200);\r",
									"});\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/packages/:packageId/findings?acceptedOnly=false&projection=assets&projection=benchmarkIds&projection=ccis&projection=poamRarSummary",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"packages",
								":packageId",
								"findings"
							],
							"query": [
								{
									"key": "acceptedOnly",
									"value": "false"
								},
								{
									"key": "benchmarkId",
									"value": "<string>",
									"description": "A query parameter that indentifies a STIG",
									"disabled": true
								},
								{
									"key": "assetId",
									"value": "<string>",
									"description": "A query parameter that indentifies an Asset",
									"disabled": true
								},
								{
									"key": "projection",
									"value": "assets",
									"description": "Optional properties to return"
								},
								{
									"key": "projection",
									"value": "benchmarkIds"
								},
								{
									"key": "projection",
									"value": "ccis"
								},
								{
									"key": "projection",
									"value": "poamRarSummary"
								}
							],
							"variable": [
								{
									"description": "(Required) A path parameter that indentifies a Package",
									"key": "packageId",
									"type": "string",
									"value": "{{testPackage}}"
								}
							]
						}
					},
					"response": [
						{
							"name": "PackageFinding response",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/packages/:packageId/findings?acceptedOnly=false&benchmarkId=<string>&assetId=<string>&projection=<string>,<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages",
										":packageId",
										"findings"
									],
									"query": [
										{
											"key": "acceptedOnly",
											"value": "false"
										},
										{
											"key": "benchmarkId",
											"value": "<string>"
										},
										{
											"key": "assetId",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>,<string>"
										}
									],
									"variable": [
										{
											"key": "packageId"
										}
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "[\n {\n  \"ruleId\": \"<string>\",\n  \"ruleTitle\": \"<string>\",\n  \"groupId\": \"<string>\",\n  \"groupTitle\": \"<string>\",\n  \"severity\": \"<string>\",\n  \"ccis\": [\n   {\n    \"cci\": \"<string>\",\n    \"emassAp\": \"<string>\",\n    \"controls\": [\n     {\n      \"indexDisa\": \"<string>\",\n      \"textRefNist\": \"<string>\",\n      \"parentControl\": \"<string>\"\n     },\n     {\n      \"indexDisa\": \"<string>\",\n      \"textRefNist\": \"<string>\",\n      \"parentControl\": \"<string>\"\n     }\n    ]\n   },\n   {\n    \"cci\": \"<string>\",\n    \"emassAp\": \"<string>\",\n    \"controls\": [\n     {\n      \"indexDisa\": \"<string>\",\n      \"textRefNist\": \"<string>\",\n      \"parentControl\": \"<string>\"\n     },\n     {\n      \"indexDisa\": \"<string>\",\n      \"textRefNist\": \"<string>\",\n      \"parentControl\": \"<string>\"\n     }\n    ]\n   }\n  ],\n  \"benchmarkIds\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"assets\": [\n   {\n    \"assetId\": \"<string>\",\n    \"name\": \"<string>\"\n   },\n   {\n    \"assetId\": \"<string>\",\n    \"name\": \"<string>\"\n   }\n  ]\n },\n {\n  \"ruleId\": \"<string>\",\n  \"ruleTitle\": \"<string>\",\n  \"groupId\": \"<string>\",\n  \"groupTitle\": \"<string>\",\n  \"severity\": \"<string>\",\n  \"ccis\": [\n   {\n    \"cci\": \"<string>\",\n    \"emassAp\": \"<string>\",\n    \"controls\": [\n     {\n      \"indexDisa\": \"<string>\",\n      \"textRefNist\": \"<string>\",\n      \"parentControl\": \"<string>\"\n     },\n     {\n      \"indexDisa\": \"<string>\",\n      \"textRefNist\": \"<string>\",\n      \"parentControl\": \"<string>\"\n     }\n    ]\n   },\n   {\n    \"cci\": \"<string>\",\n    \"emassAp\": \"<string>\",\n    \"controls\": [\n     {\n      \"indexDisa\": \"<string>\",\n      \"textRefNist\": \"<string>\",\n      \"parentControl\": \"<string>\"\n     },\n     {\n      \"indexDisa\": \"<string>\",\n      \"textRefNist\": \"<string>\",\n      \"parentControl\": \"<string>\"\n     }\n    ]\n   }\n  ],\n  \"benchmarkIds\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"assets\": [\n   {\n    \"assetId\": \"<string>\",\n    \"name\": \"<string>\"\n   },\n   {\n    \"assetId\": \"<string>\",\n    \"name\": \"<string>\"\n   }\n  ]\n }\n]"
						},
						{
							"name": "unexpected error",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/packages/:packageId/findings?acceptedOnly=false&benchmarkId=<string>&assetId=<string>&projection=<string>,<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages",
										":packageId",
										"findings"
									],
									"query": [
										{
											"key": "acceptedOnly",
											"value": "false"
										},
										{
											"key": "benchmarkId",
											"value": "<string>"
										},
										{
											"key": "assetId",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>,<string>"
										}
									],
									"variable": [
										{
											"key": "packageId"
										}
									]
								}
							},
							"status": "Internal Server Error",
							"code": 500,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
						}
					]
				},
				{
					"name": "Return the STIGs mapped in the specified Package",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "0cb76165-9088-4ebd-a1cf-9039c25deac2",
								"exec": [
									"\r",
									"pm.test(\"Status code is 200\", function () {\r",
									"    pm.response.to.have.status(200);\r",
									"});\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/packages/:packageId/stigs",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"packages",
								":packageId",
								"stigs"
							],
							"variable": [
								{
									"key": "packageId",
									"value": "{{testPackage}}",
									"type": "string",
									"description": "(Required) A path parameter that indentifies a Package"
								}
							]
						}
					},
					"response": [
						{
							"name": "PackageFinding response",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/packages/:packageId/stigs",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages",
										":packageId",
										"stigs"
									],
									"variable": [
										{
											"key": "packageId"
										}
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "[\n {\n  \"benchmarkId\": \"<string>\",\n  \"lastRevisionStr\": \"<string>\",\n  \"lastRevisionDate\": \"<string>\",\n  \"title\": \"<string>\"\n },\n {\n  \"benchmarkId\": \"<string>\",\n  \"lastRevisionStr\": \"<string>\",\n  \"lastRevisionDate\": \"<string>\",\n  \"title\": \"<string>\"\n }\n]"
						},
						{
							"name": "unexpected error",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/packages/:packageId/stigs",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"packages",
										":packageId",
										"stigs"
									],
									"variable": [
										{
											"key": "packageId"
										}
									]
								}
							},
							"status": "Internal Server Error",
							"code": 500,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
						}
					]
				}
			],
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"id": "b2cb3879-dc28-49aa-97dc-b0c5ff1d2767",
						"type": "text/javascript",
						"exec": [
							"// // pm.environment.set(\"curUser\", \"staff\");",
							"",
							"// let user = pm.iterationData.get(\"user\");",
							"// let elevate = pm.iterationData.get(\"elevate\");",
							"// console.log(`user: ${user} elevate: ${elevate}`);",
							"",
							"",
							"",
							"// if (user === undefined) {",
							"//     elevate = true;",
							"//     pm.environment.set(\"elevated\", elevate);",
							"//     user = \"admin\";",
							"//     pm.environment.set(\"user\", user);",
							"//     console.log(`setting environment variables elevated to ${elevate}, user to ${user}`);",
							"// }",
							"",
							"",
							"// let token = pm.environment.get(\"token.\" + user)",
							"// pm.environment.set(\"token\", token);",
							"// pm.environment.set(\"user\", user);",
							"// pm.environment.set(\"elevated\", elevate);",
							"// console.log(`User: ${user} elevated: ${elevate} Bearer: ${token}`);",
							"",
							"// pm.environment.set(\"packages.valid\", pm.iterationData.get(\"packages.valid\"));",
							"// pm.environment.set(\"packages.invalid\", pm.iterationData.get(\"packages.invalid\"));",
							"// pm.environment.set(\"assets.valid\", pm.iterationData.get(\"assets.valid\"));",
							"// pm.environment.set(\"assets.invalid\", pm.iterationData.get(\"assets.invalid\"));",
							"// pm.environment.set(\"stigs.valid\", pm.iterationData.get(\"stigs.valid\"));",
							"// pm.environment.set(\"stigs.invalid\", pm.iterationData.get(\"stigs.invalid\"));",
							"// pm.environment.set(\"testPackage\", pm.iterationData.get(\"testPackage\"));",
							"// pm.environment.set(\"testBenchmark\", pm.iterationData.get(\"testBenchmark\"));",
							"// pm.environment.set(\"testRev\", pm.iterationData.get(\"testRev\"));",
							"",
							"",
							"",
							"",
							"",
							"",
							""
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"id": "e8e876bb-9c45-4de0-a26c-c3fe6838c0ee",
						"type": "text/javascript",
						"exec": [
							"// // var user = pm.environment.get(\"user\");",
							"// // var elevated = pm.environment.get(\"elevated\");",
							"",
							"// // pm.test(`Packages Tests with user: ${user} elevated: ${elevated} `, function () {",
							"// //     pm.expect(pm.environment.get(\"user\")).to.equal(user);",
							"// // });",
							"",
							"",
							"// let user = pm.environment.get(\"user\");",
							"// let elevated = pm.environment.get(\"elevated\");",
							"",
							"// pm.test(`user: ${user}, elevated: ${elevated}`, function () {",
							"//     pm.expect(1).to.equal(1);",
							"// });",
							"",
							"// let env = pm.environment.get(\"env\");",
							"// pm.test(`environment: ${env}`, function () {",
							"//     pm.expect(env).to.equal(\"stig-manager localhost packages\");",
							"// });",
							"",
							"",
							"",
							""
						]
					}
				}
			],
			"protocolProfileBehavior": {}
		},
		{
			"name": "Assets Tests - data file driven",
			"item": [
				{
					"name": "Assets - get - parameter combos",
					"item": [
						{
							"name": "Assets - get - pkgId Param",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "0a157fa0-3674-4dc7-b387-00a05b315378",
										"exec": [
											"let user = pm.environment.get(\"user\");\r",
											"console.log(\"user: \" + user);\r",
											"if (user == \"wf10\") {\r",
											"    pm.test(\"Status should be 403 for user wf10, elevated\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"if ((user == \"lvl1\" || user == \"packageCreator\") && pm.request.url.getQueryString().match(/elevate=false/) && pm.request.url.getQueryString().match(/projection=stigReviewers/)) {\r",
											"    pm.test(\"Status should be 403 for user wf60, with stigReviewer projection, not elevated\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;     \r",
											"}\r",
											"else {\r",
											"    pm.test(\"Status code is 200\", function () {\r",
											"        pm.response.to.have.status(200);\r",
											"    });\r",
											"}\r",
											"\r",
											"let jsonData = pm.response.json();\r",
											"\r",
											"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
											"    user = \"elevated\";\r",
											"}\r",
											"\r",
											"// console.log(\"url: \" + pm.request.url.getQueryString().match(/elevate=true/));\r",
											"\r",
											"var stuff = pm.request.auth;\r",
											"var stuff = pm.request.url.query;\r",
											"\r",
											"\r",
											"\r",
											"let allowedPackages, disallowedPackages, validStigs, invalidStigs, validAssets, invalidAssets;\r",
											"console.log(\"assignments\");\r",
											"allowedPackages = JSON.parse(pm.environment.get((\"packages.valid\")));\r",
											"// disallowedPackages = JSON.parse(pm.environment.get(\"packages.invalid\"));\r",
											"// validStigs = JSON.parse(pm.environment.get(\"stigs.valid\"));\r",
											"// invalidStigs = JSON.parse(pm.environment.get(\"stigs.invalid\"));\r",
											"// validAssets = JSON.parse(pm.environment.get(\"assets.valid\"));\r",
											"// invalidAssets = JSON.parse(pm.environment.get(\"assets.invalid\"));\r",
											"\r",
											"let assetsForPackageQuery,assetsForBenchmarkQuery,assetsForDeptQuery;\r",
											" assetsForPackageQuery = JSON.parse(pm.environment.get(\"testPackage.assets\"));\r",
											"//  assetsForBenchmarkQuery = JSON.parse(pm.environment.get(\"assets.benchmarkQuery.response\"));\r",
											"//  assetsForDeptQuery = JSON.parse(pm.environment.get(\"assets.deptQuery.response\"));\r",
											"\r",
											"\r",
											"console.log(\"user is \" + user);\r",
											"\r",
											"\r",
											"\r",
											"// console.log(jsonData);\r",
											"// console.log(pm.environment.get(\"env\"));\r",
											"\r",
											"pm.test(\"Response JSON is an array\", function () {\r",
											"    pm.expect(jsonData).to.be.an('array');\r",
											"});\r",
											"\r",
											"let packageIds = [];\r",
											"let assetIds = [];\r",
											"let assetNames = [];\r",
											"let stigIds = [];\r",
											"let stigReviewers = [];\r",
											"let adminStats = [];\r",
											"pm.test(\"Each item in response has proper properties\", function () {\r",
											"    jsonData.forEach(function (item) {\r",
											"        pm.expect(item).to.have.property('assetId');\r",
											"        assetIds.push(item.assetId);\r",
											"        pm.expect(item).to.have.property('name');\r",
											"        assetNames.push(item.name);\r",
											"        // console.log (item.assets);\r",
											"        // let assets = [];\r",
											"        // assets = item.assets;\r",
											"        // console.log (assets);\r",
											"\r",
											"        item.stigs.forEach(function (stig) {\r",
											"            pm.expect(stig).to.have.property('benchmarkId');\r",
											"            stigIds.push(stig.benchmarkId);\r",
											"        });\r",
											"        if (user == \"wf60\"){\r",
											"            pm.expect(item).to.not.have.property('stigReviewers');\r",
											"        }\r",
											"        else{    \r",
											"            item.stigReviewers.forEach(function (stigReviewer) {\r",
											"                pm.expect(stigReviewer).to.have.property('benchmarkId');\r",
											"                stigIds.push(stigReviewer.benchmarkId);\r",
											"            });\r",
											"        }\r",
											"\r",
											"        pm.expect(item.adminStats).to.have.property('stigCount');\r",
											"        pm.expect(item.adminStats).to.have.property('stigAssignedCount');         \r",
											"    });\r",
											"\r",
											"    //     pm.expect(packageIds).to.include.members(allowedPackages);\r",
											"});\r",
											"\r",
											"// console.log(\"packageIds = \" + packageIds);\r",
											"\r",
											"let packageQuery, benchmarkQuery, deptQuery = 0;\r",
											"\r",
											"pm.test(\"Response contains correct assets for this user\", function () {\r",
											"\r",
											"    if (pm.request.url.getQueryString().match(/packageId=/)) {\r",
											"        packageQuery = 1;\r",
											"        assetIds.forEach(function (asset) {\r",
											"            console.log(\"checking package query assetId: \" + asset);\r",
											"            pm.expect(parseInt(asset)).to.be.oneOf(assetsForPackageQuery);\r",
											"        });\r",
											"    }\r",
											"    if (pm.request.url.getQueryString().match(/benchmarkId=/)) {\r",
											"        benchmarkQuery = 1;\r",
											"        assetIds.forEach(function (asset) {\r",
											"            console.log(\"checking benchmark query assetId: \" + asset);\r",
											"            pm.expect(parseInt(asset)).to.be.oneOf(assetsForBenchmarkQuery);\r",
											"        });        \r",
											"    }\r",
											"    if (pm.request.url.getQueryString().match(/deptId=/)) {\r",
											"        deptQuery = 1;\r",
											"        assetIds.forEach(function (asset) {\r",
											"            console.log(\"checking dept query assetId: \" + asset);\r",
											"            pm.expect(parseInt(asset)).to.be.oneOf(assetsForDeptQuery);\r",
											"        });        \r",
											"    }\r",
											"\r",
											"});\r",
											"\r",
											"pm.test(\"Response contains authorized packageIds for this user\", function () {\r",
											"    packageIds.forEach(function (item) {\r",
											"        console.log(\"checking packageId: \" + item);\r",
											"        pm.expect(item).to.be.oneOf(allowedPackages);\r",
											"    });\r",
											"});\r",
											"\r",
											"let assetMatchString = pm.environment.get(\"assetMatchString\");\r",
											"\r",
											"console.log(\"asset string = \" + assetMatchString);\r",
											"var regex = new RegExp(assetMatchString);\r",
											"\r",
											"pm.test(\"Response contains authorized package names for this user\", function () {\r",
											"    assetNames.forEach(function (name) {\r",
											"        console.log(\"checking name: \" + name);\r",
											"        pm.expect(name).to.match(regex);\r",
											"    });\r",
											"});\r",
											"\r",
											"\r",
											"\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/assets?elevate={{elevated}}&packageId={{assets.queryPkg}}&projection=stigs&projection=stigReviewers&projection=adminStats",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets"
									],
									"query": [
										{
											"key": "elevate",
											"value": "{{elevated}}",
											"description": "Elevate the user context for this request if user is permitted (canAdmin)"
										},
										{
											"key": "packageId",
											"value": "{{assets.queryPkg}}",
											"description": "Selects Assets mapped to a Package"
										},
										{
											"key": "benchmarkId",
											"value": "{{testBenchmark}}",
											"description": "Selects Assets mapped to a STIG",
											"disabled": true
										},
										{
											"key": "projection",
											"value": "stigs",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "stigReviewers"
										},
										{
											"key": "projection",
											"value": "adminStats"
										}
									]
								}
							},
							"response": [
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets?elevate=<boolean>&packageId=<integer>&benchmarkId=<string>&dept=<string>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "packageId",
													"value": "<integer>"
												},
												{
													"key": "benchmarkId",
													"value": "<string>"
												},
												{
													"key": "dept",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								},
								{
									"name": "AssetProjected response",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets?elevate=<boolean>&packageId=<integer>&benchmarkId=<string>&dept=<string>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "packageId",
													"value": "<integer>"
												},
												{
													"key": "benchmarkId",
													"value": "<string>"
												},
												{
													"key": "dept",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "[\n {\n  \"assetId\": \"<integer>\",\n  \"name\": \"<string>\",\n  \"dept\": \"<string>\",\n  \"ip\": \"<string>\",\n  \"nonnetwork\": \"<boolean>\",\n  \"scanexempt\": \"<boolean>\",\n  \"adminStats\": {\n   \"stigCount\": \"<integer>\",\n   \"stigAssignedCount\": \"<integer>\"\n  },\n  \"packages\": [\n   {\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\"\n   },\n   {\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\"\n   }\n  ],\n  \"stigs\": [\n   {\n    \"benchmarkId\": \"<string>\",\n    \"lastRevisionStr\": \"<string>\",\n    \"lastRevisionDate\": \"<string>\",\n    \"title\": \"<string>\"\n   },\n   {\n    \"benchmarkId\": \"<string>\",\n    \"lastRevisionStr\": \"<string>\",\n    \"lastRevisionDate\": \"<string>\",\n    \"title\": \"<string>\"\n   }\n  ],\n  \"stigReviewers\": [\n   {\n    \"benchmarkId\": \"<string>\",\n    \"reviewers\": [\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     },\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     }\n    ]\n   },\n   {\n    \"benchmarkId\": \"<string>\",\n    \"reviewers\": [\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     },\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     }\n    ]\n   }\n  ]\n },\n {\n  \"assetId\": \"<integer>\",\n  \"name\": \"<string>\",\n  \"dept\": \"<string>\",\n  \"ip\": \"<string>\",\n  \"nonnetwork\": \"<boolean>\",\n  \"scanexempt\": \"<boolean>\",\n  \"adminStats\": {\n   \"stigCount\": \"<integer>\",\n   \"stigAssignedCount\": \"<integer>\"\n  },\n  \"packages\": [\n   {\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\"\n   },\n   {\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\"\n   }\n  ],\n  \"stigs\": [\n   {\n    \"benchmarkId\": \"<string>\",\n    \"lastRevisionStr\": \"<string>\",\n    \"lastRevisionDate\": \"<string>\",\n    \"title\": \"<string>\"\n   },\n   {\n    \"benchmarkId\": \"<string>\",\n    \"lastRevisionStr\": \"<string>\",\n    \"lastRevisionDate\": \"<string>\",\n    \"title\": \"<string>\"\n   }\n  ],\n  \"stigReviewers\": [\n   {\n    \"benchmarkId\": \"<string>\",\n    \"reviewers\": [\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     },\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     }\n    ]\n   },\n   {\n    \"benchmarkId\": \"<string>\",\n    \"reviewers\": [\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     },\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     }\n    ]\n   }\n  ]\n }\n]"
								}
							]
						},
						{
							"name": "Assets - get - pkgId, benchmarkId",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "bd6116db-ebae-4330-a1c0-ec07577b8406",
										"exec": [
											"let user = pm.environment.get(\"user\");\r",
											"console.log(\"user: \" + user);\r",
											"if (user == \"wf10\") {\r",
											"    pm.test(\"Status should be 403 for user wf10, elevated\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"if ((user == \"lvl1\" || user == \"packageCreator\") && pm.request.url.getQueryString().match(/elevate=false/) && pm.request.url.getQueryString().match(/projection=stigReviewers/)) {\r",
											"    pm.test(\"Status should be 403 for user wf60, with stigReviewer projection, not elevated\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;     \r",
											"}\r",
											"else {\r",
											"    pm.test(\"Status code is 200\", function () {\r",
											"        pm.response.to.have.status(200);\r",
											"    });\r",
											"}\r",
											"\r",
											"let jsonData = pm.response.json();\r",
											"\r",
											"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
											"    user = \"elevated\";\r",
											"}\r",
											"\r",
											"// console.log(\"url: \" + pm.request.url.getQueryString().match(/elevate=true/));\r",
											"\r",
											"var stuff = pm.request.auth;\r",
											"var stuff = pm.request.url.query;\r",
											"\r",
											"\r",
											"\r",
											"let allowedPackages, disallowedPackages, validStigs, invalidStigs, validAssets, invalidAssets;\r",
											"console.log(\"assignments\");\r",
											"allowedPackages = JSON.parse(pm.environment.get((\"packages.valid\")));\r",
											"// disallowedPackages = JSON.parse(pm.environment.get(\"packages.invalid\"));\r",
											"// validStigs = JSON.parse(pm.environment.get(\"stigs.valid\"));\r",
											"// invalidStigs = JSON.parse(pm.environment.get(\"stigs.invalid\"));\r",
											"validAssets = JSON.parse(pm.environment.get(\"assets.valid\"));\r",
											"// invalidAssets = JSON.parse(pm.environment.get(\"assets.invalid\"));\r",
											"\r",
											"let assetsForPackageQuery,assetsForBenchmarkQuery,assetsForDeptQuery;\r",
											" assetsForPackageQuery = JSON.parse(pm.environment.get(\"testPackage.assets\"));\r",
											" assetsForBenchmarkQuery = JSON.parse(pm.environment.get(\"assets.benchmarkQuery.response\"));\r",
											"//  assetsForDeptQuery = JSON.parse(pm.environment.get(\"assets.deptQuery.response\"));\r",
											"\r",
											"\r",
											"console.log(\"user is \" + user);\r",
											"\r",
											"\r",
											"\r",
											"// console.log(jsonData);\r",
											"// console.log(pm.environment.get(\"env\"));\r",
											"\r",
											"pm.test(\"Response JSON is an array\", function () {\r",
											"    pm.expect(jsonData).to.be.an('array');\r",
											"});\r",
											"\r",
											"let packageIds = [];\r",
											"let assetIds = [];\r",
											"let assetNames = [];\r",
											"let stigIds = [];\r",
											"let stigReviewers = [];\r",
											"let adminStats = [];\r",
											"pm.test(\"Each item in response has proper properties\", function () {\r",
											"    jsonData.forEach(function (item) {\r",
											"        pm.expect(item).to.have.property('assetId');\r",
											"        assetIds.push(item.assetId);\r",
											"        pm.expect(item).to.have.property('name');\r",
											"        assetNames.push(item.name);\r",
											"        // console.log (item.assets);\r",
											"        // let assets = [];\r",
											"        // assets = item.assets;\r",
											"        // console.log (assets);\r",
											"\r",
											"        item.stigs.forEach(function (stig) {\r",
											"            pm.expect(stig).to.have.property('benchmarkId');\r",
											"            stigIds.push(stig.benchmarkId);\r",
											"        });\r",
											"        if (user == \"wf60\"){\r",
											"            pm.expect(item).to.not.have.property('stigReviewers');\r",
											"        }\r",
											"        else{    \r",
											"            item.stigReviewers.forEach(function (stigReviewer) {\r",
											"                pm.expect(stigReviewer).to.have.property('benchmarkId');\r",
											"                stigIds.push(stigReviewer.benchmarkId);\r",
											"            });\r",
											"        }\r",
											"\r",
											"        pm.expect(item.adminStats).to.have.property('stigCount');\r",
											"        pm.expect(item.adminStats).to.have.property('stigAssignedCount');         \r",
											"    });\r",
											"\r",
											"    //     pm.expect(packageIds).to.include.members(allowedPackages);\r",
											"});\r",
											"\r",
											"// console.log(\"packageIds = \" + packageIds);\r",
											"\r",
											"let packageQuery, benchmarkQuery, deptQuery = 0;\r",
											"\r",
											"pm.test(\"Response contains correct assets for this user\", function () {\r",
											"\r",
											"    if (pm.request.url.getQueryString().match(/packageId=/)) {\r",
											"        packageQuery = 1;\r",
											"        assetIds.forEach(function (asset) {\r",
											"            console.log(\"checking package query assetId: \" + asset);\r",
											"            pm.expect(parseInt(asset)).to.be.oneOf(assetsForPackageQuery);\r",
											"        });\r",
											"    }\r",
											"    if (pm.request.url.getQueryString().match(/benchmarkId=/)) {\r",
											"        benchmarkQuery = 1;\r",
											"        assetIds.forEach(function (asset) {\r",
											"            console.log(\"checking benchmark query assetId: \" + asset);\r",
											"            pm.expect(parseInt(asset)).to.be.oneOf(assetsForBenchmarkQuery);\r",
											"        });        \r",
											"    }\r",
											"\r",
											"});\r",
											"\r",
											"pm.test(\"Response contains authorized packageIds for this user\", function () {\r",
											"    packageIds.forEach(function (item) {\r",
											"        console.log(\"checking packageId: \" + item);\r",
											"        pm.expect(item).to.be.oneOf(allowedPackages);\r",
											"    });\r",
											"});\r",
											"\r",
											"\r",
											"pm.test(\"Response contains authorized packageIds for this user\", function () {\r",
											"    packageIds.forEach(function (item) {\r",
											"        console.log(\"checking packageId: \" + item);\r",
											"        pm.expect(item).to.be.oneOf(allowedPackages);\r",
											"    });\r",
											"});\r",
											"\r",
											"let assetMatchString = pm.environment.get(\"assetMatchString\");\r",
											"\r",
											"console.log(\"asset string = \" + assetMatchString);\r",
											"var regex = new RegExp(assetMatchString);\r",
											"\r",
											"pm.test(\"Response contains authorized package names for this user\", function () {\r",
											"    assetNames.forEach(function (name) {\r",
											"        console.log(\"checking name: \" + name);\r",
											"        pm.expect(name).to.match(regex);\r",
											"    });\r",
											"});\r",
											"\r",
											"\r",
											"// pm.test(\"Response does NOT contain unAuthorized packageIds for this user\", function () {\r",
											"//     packageIds.forEach(function (item) {\r",
											"//         pm.expect(item).to.not.be.oneOf(disallowedPackages);\r",
											"//     });\r",
											"// });\r",
											"\r",
											"\r",
											"// if (user == \"wf60\" || user == \"officer60\") {\r",
											"//     pm.test(\"Response contains authorized projection data (assets)\", function () {\r",
											"//         assetIds.forEach(function (assetId) {\r",
											"//             pm.expect(assetId).to.be.oneOf(validAssets);\r",
											"//             console.log(\"checking assetId: \" + assetId);\r",
											"//         });\r",
											"//     });\r",
											"\r",
											"//     pm.test(\"Response contains authorized projection data (stigs)\", function () {\r",
											"//         stigIds.forEach(function (stigId) {\r",
											"//             pm.expect(stigId).to.be.oneOf(validStigs);\r",
											"//             console.log(\"checking stigId: \" + stigId);\r",
											"//         });\r",
											"//     });\r",
											"// }\r",
											"\r",
											"\r",
											"\r",
											"\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/assets?elevate={{elevated}}&packageId={{assets.queryPkg}}&benchmarkId={{testBenchmark}}&projection=stigs&projection=stigReviewers&projection=adminStats",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets"
									],
									"query": [
										{
											"key": "elevate",
											"value": "{{elevated}}",
											"description": "Elevate the user context for this request if user is permitted (canAdmin)"
										},
										{
											"key": "packageId",
											"value": "{{assets.queryPkg}}",
											"description": "Selects Assets mapped to a Package"
										},
										{
											"key": "benchmarkId",
											"value": "{{testBenchmark}}",
											"description": "Selects Assets mapped to a STIG"
										},
										{
											"key": "projection",
											"value": "stigs",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "stigReviewers"
										},
										{
											"key": "projection",
											"value": "adminStats"
										}
									]
								}
							},
							"response": [
								{
									"name": "AssetProjected response",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets?elevate=<boolean>&packageId=<integer>&benchmarkId=<string>&dept=<string>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "packageId",
													"value": "<integer>"
												},
												{
													"key": "benchmarkId",
													"value": "<string>"
												},
												{
													"key": "dept",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "[\n {\n  \"assetId\": \"<integer>\",\n  \"name\": \"<string>\",\n  \"dept\": \"<string>\",\n  \"ip\": \"<string>\",\n  \"nonnetwork\": \"<boolean>\",\n  \"scanexempt\": \"<boolean>\",\n  \"adminStats\": {\n   \"stigCount\": \"<integer>\",\n   \"stigAssignedCount\": \"<integer>\"\n  },\n  \"packages\": [\n   {\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\"\n   },\n   {\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\"\n   }\n  ],\n  \"stigs\": [\n   {\n    \"benchmarkId\": \"<string>\",\n    \"lastRevisionStr\": \"<string>\",\n    \"lastRevisionDate\": \"<string>\",\n    \"title\": \"<string>\"\n   },\n   {\n    \"benchmarkId\": \"<string>\",\n    \"lastRevisionStr\": \"<string>\",\n    \"lastRevisionDate\": \"<string>\",\n    \"title\": \"<string>\"\n   }\n  ],\n  \"stigReviewers\": [\n   {\n    \"benchmarkId\": \"<string>\",\n    \"reviewers\": [\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     },\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     }\n    ]\n   },\n   {\n    \"benchmarkId\": \"<string>\",\n    \"reviewers\": [\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     },\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     }\n    ]\n   }\n  ]\n },\n {\n  \"assetId\": \"<integer>\",\n  \"name\": \"<string>\",\n  \"dept\": \"<string>\",\n  \"ip\": \"<string>\",\n  \"nonnetwork\": \"<boolean>\",\n  \"scanexempt\": \"<boolean>\",\n  \"adminStats\": {\n   \"stigCount\": \"<integer>\",\n   \"stigAssignedCount\": \"<integer>\"\n  },\n  \"packages\": [\n   {\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\"\n   },\n   {\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\"\n   }\n  ],\n  \"stigs\": [\n   {\n    \"benchmarkId\": \"<string>\",\n    \"lastRevisionStr\": \"<string>\",\n    \"lastRevisionDate\": \"<string>\",\n    \"title\": \"<string>\"\n   },\n   {\n    \"benchmarkId\": \"<string>\",\n    \"lastRevisionStr\": \"<string>\",\n    \"lastRevisionDate\": \"<string>\",\n    \"title\": \"<string>\"\n   }\n  ],\n  \"stigReviewers\": [\n   {\n    \"benchmarkId\": \"<string>\",\n    \"reviewers\": [\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     },\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     }\n    ]\n   },\n   {\n    \"benchmarkId\": \"<string>\",\n    \"reviewers\": [\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     },\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     }\n    ]\n   }\n  ]\n }\n]"
								},
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets?elevate=<boolean>&packageId=<integer>&benchmarkId=<string>&dept=<string>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "packageId",
													"value": "<integer>"
												},
												{
													"key": "benchmarkId",
													"value": "<string>"
												},
												{
													"key": "dept",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								}
							]
						},
						{
							"name": "Assets - get - pkgId Param no StigReviewers Projection (prohibited for level 1)",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "8f869eec-4c2a-485d-a94d-3f6f7482c36c",
										"exec": [
											"let user = pm.environment.get(\"user\");\r",
											"console.log(\"user: \" + user);\r",
											"if (user == \"wf10\") {\r",
											"    pm.test(\"Status should be 403 for user wf10, elevated\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"if (user == \"packageCreator\" && pm.request.url.getQueryString().match(/elevate=false/) ) {\r",
											"    pm.test(\"Status should be 403 for user packageCreator, with stigReviewer projection, not elevated\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;     \r",
											"}\r",
											"else {\r",
											"    pm.test(\"Status code is 200\", function () {\r",
											"        pm.response.to.have.status(200);\r",
											"    });\r",
											"}\r",
											"\r",
											"let jsonData = pm.response.json();\r",
											"\r",
											"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
											"    user = \"elevated\";\r",
											"}\r",
											"\r",
											"// console.log(\"url: \" + pm.request.url.getQueryString().match(/elevate=true/));\r",
											"\r",
											"var stuff = pm.request.auth;\r",
											"var stuff = pm.request.url.query;\r",
											"\r",
											"\r",
											"\r",
											"let allowedPackages, disallowedPackages, validStigs, invalidStigs, validAssets, invalidAssets;\r",
											"console.log(\"assignments\");\r",
											"allowedPackages = JSON.parse(pm.environment.get((\"packages.valid\")));\r",
											"// disallowedPackages = JSON.parse(pm.environment.get(\"packages.invalid\"));\r",
											"// validStigs = JSON.parse(pm.environment.get(\"stigs.valid\"));\r",
											"// invalidStigs = JSON.parse(pm.environment.get(\"stigs.invalid\"));\r",
											"// validAssets = JSON.parse(pm.environment.get(\"assets.valid\"));\r",
											"// invalidAssets = JSON.parse(pm.environment.get(\"assets.invalid\"));\r",
											"\r",
											"let assetsForPackageQuery,assetsForBenchmarkQuery,assetsForDeptQuery;\r",
											" assetsForPackageQuery = JSON.parse(pm.environment.get(\"testPackage.assets\"));\r",
											"//  assetsForBenchmarkQuery = JSON.parse(pm.environment.get(\"assets.benchmarkQuery.response\"));\r",
											"//  assetsForDeptQuery = JSON.parse(pm.environment.get(\"assets.deptQuery.response\"));\r",
											"\r",
											"\r",
											"console.log(\"user is \" + user);\r",
											"\r",
											"\r",
											"\r",
											"// console.log(jsonData);\r",
											"// console.log(pm.environment.get(\"env\"));\r",
											"\r",
											"pm.test(\"Response JSON is an array\", function () {\r",
											"    pm.expect(jsonData).to.be.an('array');\r",
											"});\r",
											"\r",
											"let packageIds = [];\r",
											"let assetIds = [];\r",
											"let assetNames = [];\r",
											"let stigIds = [];\r",
											"let stigReviewers = [];\r",
											"let adminStats = [];\r",
											"pm.test(\"Each item in response has proper properties\", function () {\r",
											"    jsonData.forEach(function (item) {\r",
											"        pm.expect(item).to.have.property('assetId');\r",
											"        assetIds.push(item.assetId);\r",
											"        pm.expect(item).to.have.property('name');\r",
											"        assetNames.push(item.name);\r",
											"        // console.log (item.assets);\r",
											"        // let assets = [];\r",
											"        // assets = item.assets;\r",
											"        // console.log (assets);\r",
											"\r",
											"        item.stigs.forEach(function (stig) {\r",
											"            pm.expect(stig).to.have.property('benchmarkId');\r",
											"            stigIds.push(stig.benchmarkId);\r",
											"        });\r",
											"\r",
											"        pm.expect(item.adminStats).to.have.property('stigCount');\r",
											"        pm.expect(item.adminStats).to.have.property('stigAssignedCount');         \r",
											"    });\r",
											"\r",
											"    //     pm.expect(packageIds).to.include.members(allowedPackages);\r",
											"});\r",
											"\r",
											"// console.log(\"packageIds = \" + packageIds);\r",
											"\r",
											"let packageQuery, benchmarkQuery, deptQuery = 0;\r",
											"\r",
											"pm.test(\"Response contains correct assets for this user\", function () {\r",
											"\r",
											"    if (pm.request.url.getQueryString().match(/packageId=/)) {\r",
											"        packageQuery = 1;\r",
											"        assetIds.forEach(function (asset) {\r",
											"            console.log(\"checking package query assetId: \" + asset);\r",
											"            pm.expect(parseInt(asset)).to.be.oneOf(assetsForPackageQuery);\r",
											"        });\r",
											"    }\r",
											"    if (pm.request.url.getQueryString().match(/benchmarkId=/)) {\r",
											"        benchmarkQuery = 1;\r",
											"        assetIds.forEach(function (asset) {\r",
											"            console.log(\"checking benchmark query assetId: \" + asset);\r",
											"            pm.expect(parseInt(asset)).to.be.oneOf(assetsForBenchmarkQuery);\r",
											"        });        \r",
											"    }\r",
											"    if (pm.request.url.getQueryString().match(/deptId=/)) {\r",
											"        deptQuery = 1;\r",
											"        assetIds.forEach(function (asset) {\r",
											"            console.log(\"checking dept query assetId: \" + asset);\r",
											"            pm.expect(parseInt(asset)).to.be.oneOf(assetsForDeptQuery);\r",
											"        });        \r",
											"    }\r",
											"\r",
											"});\r",
											"\r",
											"pm.test(\"Response contains authorized packageIds for this user\", function () {\r",
											"    packageIds.forEach(function (item) {\r",
											"        console.log(\"checking packageId: \" + item);\r",
											"        pm.expect(item).to.be.oneOf(allowedPackages);\r",
											"    });\r",
											"});\r",
											"\r",
											"\r",
											"let assetMatchString = pm.environment.get(\"assetMatchString\");\r",
											"\r",
											"console.log(\"asset string = \" + assetMatchString);\r",
											"var regex = new RegExp(assetMatchString);\r",
											"\r",
											"pm.test(\"Response contains authorized package names for this user\", function () {\r",
											"    assetNames.forEach(function (name) {\r",
											"        console.log(\"checking name: \" + name);\r",
											"        pm.expect(name).to.match(regex);\r",
											"    });\r",
											"});\r",
											"\r",
											"\r",
											"// pm.test(\"Response does NOT contain unAuthorized packageIds for this user\", function () {\r",
											"//     packageIds.forEach(function (item) {\r",
											"//         pm.expect(item).to.not.be.oneOf(disallowedPackages);\r",
											"//     });\r",
											"// });\r",
											"\r",
											"\r",
											"// if (user == \"wf60\" || user == \"officer60\") {\r",
											"//     pm.test(\"Response contains authorized projection data (assets)\", function () {\r",
											"//         assetIds.forEach(function (assetId) {\r",
											"//             pm.expect(assetId).to.be.oneOf(validAssets);\r",
											"//             console.log(\"checking assetId: \" + assetId);\r",
											"//         });\r",
											"//     });\r",
											"\r",
											"//     pm.test(\"Response contains authorized projection data (stigs)\", function () {\r",
											"//         stigIds.forEach(function (stigId) {\r",
											"//             pm.expect(stigId).to.be.oneOf(validStigs);\r",
											"//             console.log(\"checking stigId: \" + stigId);\r",
											"//         });\r",
											"//     });\r",
											"// }\r",
											"\r",
											"\r",
											"\r",
											"\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/assets?elevate={{elevated}}&packageId={{assets.queryPkg}}&projection=stigs&projection=adminStats",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets"
									],
									"query": [
										{
											"key": "elevate",
											"value": "{{elevated}}",
											"description": "Elevate the user context for this request if user is permitted (canAdmin)"
										},
										{
											"key": "packageId",
											"value": "{{assets.queryPkg}}",
											"description": "Selects Assets mapped to a Package"
										},
										{
											"key": "projection",
											"value": "stigs",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "adminStats"
										}
									]
								}
							},
							"response": [
								{
									"name": "AssetProjected response",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets?elevate=<boolean>&packageId=<integer>&benchmarkId=<string>&dept=<string>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "packageId",
													"value": "<integer>"
												},
												{
													"key": "benchmarkId",
													"value": "<string>"
												},
												{
													"key": "dept",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "[\n {\n  \"assetId\": \"<integer>\",\n  \"name\": \"<string>\",\n  \"dept\": \"<string>\",\n  \"ip\": \"<string>\",\n  \"nonnetwork\": \"<boolean>\",\n  \"scanexempt\": \"<boolean>\",\n  \"adminStats\": {\n   \"stigCount\": \"<integer>\",\n   \"stigAssignedCount\": \"<integer>\"\n  },\n  \"packages\": [\n   {\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\"\n   },\n   {\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\"\n   }\n  ],\n  \"stigs\": [\n   {\n    \"benchmarkId\": \"<string>\",\n    \"lastRevisionStr\": \"<string>\",\n    \"lastRevisionDate\": \"<string>\",\n    \"title\": \"<string>\"\n   },\n   {\n    \"benchmarkId\": \"<string>\",\n    \"lastRevisionStr\": \"<string>\",\n    \"lastRevisionDate\": \"<string>\",\n    \"title\": \"<string>\"\n   }\n  ],\n  \"stigReviewers\": [\n   {\n    \"benchmarkId\": \"<string>\",\n    \"reviewers\": [\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     },\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     }\n    ]\n   },\n   {\n    \"benchmarkId\": \"<string>\",\n    \"reviewers\": [\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     },\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     }\n    ]\n   }\n  ]\n },\n {\n  \"assetId\": \"<integer>\",\n  \"name\": \"<string>\",\n  \"dept\": \"<string>\",\n  \"ip\": \"<string>\",\n  \"nonnetwork\": \"<boolean>\",\n  \"scanexempt\": \"<boolean>\",\n  \"adminStats\": {\n   \"stigCount\": \"<integer>\",\n   \"stigAssignedCount\": \"<integer>\"\n  },\n  \"packages\": [\n   {\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\"\n   },\n   {\n    \"packageId\": \"<integer>\",\n    \"name\": \"<string>\"\n   }\n  ],\n  \"stigs\": [\n   {\n    \"benchmarkId\": \"<string>\",\n    \"lastRevisionStr\": \"<string>\",\n    \"lastRevisionDate\": \"<string>\",\n    \"title\": \"<string>\"\n   },\n   {\n    \"benchmarkId\": \"<string>\",\n    \"lastRevisionStr\": \"<string>\",\n    \"lastRevisionDate\": \"<string>\",\n    \"title\": \"<string>\"\n   }\n  ],\n  \"stigReviewers\": [\n   {\n    \"benchmarkId\": \"<string>\",\n    \"reviewers\": [\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     },\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     }\n    ]\n   },\n   {\n    \"benchmarkId\": \"<string>\",\n    \"reviewers\": [\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     },\n     {\n      \"userId\": \"<integer>\",\n      \"username\": \"<string>\"\n     }\n    ]\n   }\n  ]\n }\n]"
								},
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets?elevate=<boolean>&packageId=<integer>&benchmarkId=<string>&dept=<string>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "packageId",
													"value": "<integer>"
												},
												{
													"key": "benchmarkId",
													"value": "<string>"
												},
												{
													"key": "dept",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								}
							]
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "{asset Id} ",
					"item": [
						{
							"name": "asset - get - assetId all projections",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "a6565516-1fe7-4f48-bc95-60d9199db952",
										"exec": [
											"let user = pm.environment.get(\"user\");\r",
											"console.log(\"user: \" + user);\r",
											"if (user == \"wf10\") {\r",
											"    pm.test(\"Status should be 403 for user wf10, elevated\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"if (user == \"lvl1\" && pm.request.url.getQueryString().match(/elevate=false/) && pm.request.url.getQueryString().match(/projection=stigReviewers/)) {\r",
											"        pm.test(\"Status should be 403 for user lvl1 with prohibited stigReviewer projection, not elevated\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;     \r",
											"}\r",
											"if (user == \"packageCreator\" && pm.request.url.getQueryString().match(/elevate=false/) ) {\r",
											"        pm.test(\"Status should be 204 for user packageCreator, , not elevated. packageCreator does have access to this asset\", function () {\r",
											"        pm.response.to.have.status(204);\r",
											"    });\r",
											"    return;     \r",
											"}\r",
											"else {\r",
											"    pm.test(\"Status code is 200\", function () {\r",
											"        pm.response.to.have.status(200);\r",
											"    });\r",
											"}\r",
											"\r",
											"\r",
											"let jsonData = pm.response.json();\r",
											"\r",
											"let elevated = pm.environment.get(\"elevated\");\r",
											"console.log(\"user: \" + user);\r",
											"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
											"    user = \"elevated\";\r",
											"}\r",
											"\r",
											"\r",
											"console.log(jsonData);\r",
											"// console.log(pm.environment.get(\"env\"));\r",
											"\r",
											"pm.test(\"Response JSON is an object\", function () {\r",
											"    pm.expect(jsonData).to.be.an('object');\r",
											"});\r",
											"\r",
											"let testAsset = pm.environment.get((\"assets.queryAsset\"));\r",
											"pm.test(\"Response JSON is an object with requested assetId\", function () {\r",
											"    pm.expect(parseInt(jsonData.assetId)).to.eql(testAsset);\r",
											"});\r",
											"\r",
											"let allowedPackages, disallowedPackages, validStigs, invalidStigs, validAssets, invalidAssets;\r",
											"console.log(\"assignments\");\r",
											"// allowedPackages = JSON.parse(pm.environment.get((\"packages.valid\")));\r",
											"// disallowedPackages = JSON.parse(pm.environment.get(\"packages.invalid\"));\r",
											"validStigs = JSON.parse(pm.environment.get(\"stigs.valid\"));\r",
											"// invalidStigs = JSON.parse(pm.environment.get(\"stigs.invalid\"));\r",
											"// validAssets = JSON.parse(pm.environment.get(\"assets.valid\"));\r",
											"// invalidAssets = JSON.parse(pm.environment.get(\"assets.invalid\"));\r",
											"console.log(\"user is \" + user);\r",
											"\r",
											"\r",
											"let packageIds = [];\r",
											"let assetIds = [];\r",
											"let stigReviewersStigs = [];\r",
											"let stigs = [];\r",
											"\r",
											"\r",
											"pm.test(\"Each item in response has proper properties\", function () {\r",
											"    // pm.expect(jsonData).to.have.property('packages');\r",
											"    // packageIds.push(jsonData.packageId);\r",
											"    pm.expect(jsonData).to.have.property('adminStats');\r",
											"    pm.expect(jsonData).to.have.property('stigs');\r",
											"\r",
											"    // jsonData.packages.forEach(function (package) {\r",
											"    //     pm.expect(package).to.have.property('packageId');\r",
											"    //     packageIds.push(package.packageId);\r",
											"    // });\r",
											"    jsonData.stigs.forEach(function (stig) {\r",
											"        pm.expect(stig).to.have.property('benchmarkId');\r",
											"        stigs.push(stig.benchmarkId);\r",
											"    });\r",
											"    if (user == \"lvl1\" ){\r",
											"        pm.expect(jsonData).to.not.have.property('stigReviewers');\r",
											"    }\r",
											"    else {\r",
											"        pm.expect(jsonData).to.have.property('stigReviewers');\r",
											"        jsonData.stigReviewers.forEach(function (stigReviewer) {\r",
											"            pm.expect(stigReviewer).to.have.property('benchmarkId');\r",
											"            stigReviewersStigs.push(stigReviewer.benchmarkId);\r",
											"        });\r",
											"    }\r",
											"    // pm.expect(packageIds).to.include.oneOf(allowedPackages);\r",
											"});\r",
											"\r",
											"console.log(\"packageIds = \" + packageIds);\r",
											"\r",
											"pm.test(\"Response contains valid projection data (packages)\", function () {\r",
											"    packageIds.forEach( function (package) {\r",
											"    console.log(\"checking packageId: \" + package);\r",
											"    pm.expect(package).to.be.oneOf(allowedPackages);\r",
											"    });\r",
											"});\r",
											"\r",
											"pm.test(\"Response contains valid projection data (stigs)\", function () {\r",
											"    stigs.forEach( function (stig) {\r",
											"    console.log(\"checking stig: \" + stig);\r",
											"    pm.expect(stig).to.be.oneOf(validStigs);\r",
											"    });\r",
											"});\r",
											"\r",
											"\r",
											"\r",
											"// let assetMatchString = pm.environment.get(\"assetMatchString\");\r",
											"\r",
											"// console.log(\"asset string = \" + assetMatchString);\r",
											"// var regex = new RegExp(assetMatchString);\r",
											"\r",
											"// pm.test(\"Response contains authorized package names for this user\", function () {\r",
											"//     names.forEach(function (name) {\r",
											"//         console.log(\"checking name: \" + name);\r",
											"//         pm.expect(name).to.match(regex);\r",
											"//     });\r",
											"// });\r",
											"\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/assets/:assetId?projection=stigReviewers&projection=adminStats&elevate={{elevated}}&projection=stigs",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets",
										":assetId"
									],
									"query": [
										{
											"key": "projection",
											"value": "stigReviewers",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "adminStats"
										},
										{
											"key": "elevate",
											"value": "{{elevated}}",
											"description": "Elevate the user context for this request if user is permitted (canAdmin)"
										},
										{
											"key": "projection",
											"value": "stigs"
										}
									],
									"variable": [
										{
											"description": "(Required) A path parameter that indentifies an Asset",
											"id": "4e20264d-4b0c-44ff-880f-8b1e3267c361",
											"key": "assetId",
											"type": "string",
											"value": "{{assets.queryAsset}}"
										}
									]
								}
							},
							"response": [
								{
									"name": "AssetProjected response",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"assetId\": \"<integer>\",\n \"name\": \"<string>\",\n \"dept\": \"<string>\",\n \"ip\": \"<string>\",\n \"nonnetwork\": \"<boolean>\",\n \"scanexempt\": \"<boolean>\",\n \"adminStats\": {\n  \"stigCount\": \"<integer>\",\n  \"stigAssignedCount\": \"<integer>\"\n },\n \"packages\": [\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  },\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  }\n ],\n \"stigReviewers\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  }\n ]\n}"
								},
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								}
							]
						},
						{
							"name": "Create an Asset",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "dc86cbae-93c3-46ca-a06a-44eb7c44a14e",
										"exec": [
											"let user = pm.environment.get(\"user\");\r",
											"console.log(\"user: \" + user);\r",
											"if (user == \"wf10\") {\r",
											"    pm.test(\"Status should be is 403 for user wf10\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"\r",
											"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
											"    user = \"elevated\";\r",
											"    console.log(\"user is elevated\");\r",
											"\r",
											"}\r",
											"\r",
											"var stuff = pm.request.auth;\r",
											"var stuff = pm.request;\r",
											"\r",
											"if (user == 'elevated' || user == 'lvl3' || user == \"lvl4\" ) {\r",
											"    pm.test(\"User is elevated. Status code is 201\", function () {\r",
											"        pm.response.to.have.status(201);\r",
											"    });\r",
											"}\r",
											"else {\r",
											"    pm.test(\"User is not lvl3, 4, or elevated. Expected status code is 403\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"\r",
											"if (pm.response.code == 500) {\r",
											"    console.log(\"Server returned 500\")\r",
											"    return;\r",
											"}\r",
											"\r",
											"var jsonData = pm.response.json();\r",
											"\r",
											"\r",
											"\r",
											"pm.test(\"Response JSON is an object\", function () {\r",
											"    pm.expect(jsonData).to.be.an('object');\r",
											"});\r",
											"\r",
											"let createdAsset = jsonData.assetId;\r",
											"console.log(\"created asset: \" + createdAsset)\r",
											"pm.environment.set(\"createdAsset\", createdAsset);\r",
											"\r",
											"pm.test(`Created Asset: ${createdAsset}`, function () {\r",
											"    pm.expect(createdAsset).to.be.an('string');\r",
											"});\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"name\": \"z_testAssetExpectSuccess-X\",\n    \"ip\": \"0.0.0.0\",\n    \"nonnetwork\": false,\n    \"packageId\": \"21\",\n    \"stigReviewers\": [],\n    \"metadata\": {  \n        \"assetName2\": \"namely\"\n    }\n}\n\n",
									"options": {
										"raw": {}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/assets?projection=stigs&projection=stigReviewers&projection=adminStats&elevate={{elevated}}",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets"
									],
									"query": [
										{
											"key": "projection",
											"value": "stigs",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "stigReviewers"
										},
										{
											"key": "projection",
											"value": "adminStats"
										},
										{
											"key": "elevate",
											"value": "{{elevated}}"
										}
									]
								}
							},
							"response": [
								{
									"name": "AssetProjected response",
									"originalRequest": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\",\n    \"ip\": \"<string>\",\n    \"nonnetwork\": \"<boolean>\",\n    \"scanexempt\": \"<boolean>\",\n    \"packageIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ],\n    \"benchmarkIds\": [\n        \"<string>\",\n        \"<string>\"\n    ],\n    \"stigReviewers\": [\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        },\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        }\n    ]\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/assets?projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets"
											],
											"query": [
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "Created",
									"code": 201,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"assetId\": \"<integer>\",\n \"name\": \"<string>\",\n \"dept\": \"<string>\",\n \"ip\": \"<string>\",\n \"nonnetwork\": \"<boolean>\",\n \"scanexempt\": \"<boolean>\",\n \"adminStats\": {\n  \"stigCount\": \"<integer>\",\n  \"stigAssignedCount\": \"<integer>\"\n },\n \"packages\": [\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  },\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  }\n ],\n \"stigReviewers\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  }\n ]\n}"
								},
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\",\n    \"ip\": \"<string>\",\n    \"nonnetwork\": \"<boolean>\",\n    \"scanexempt\": \"<boolean>\",\n    \"packageIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ],\n    \"benchmarkIds\": [\n        \"<string>\",\n        \"<string>\"\n    ],\n    \"stigReviewers\": [\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        },\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        }\n    ]\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/assets?projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets"
											],
											"query": [
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								}
							]
						},
						{
							"name": "Merge updates to an Asset",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "4e5cd8f6-38a2-4341-866f-80c3f17fdec9",
										"exec": [
											"let user = pm.environment.get(\"user\");\r",
											"console.log(\"user: \" + user);\r",
											"if (user == \"wf10\") {\r",
											"    pm.test(\"Status should be is 403 for user wf10\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"\r",
											"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
											"    user = \"elevated\";\r",
											"    console.log(\"user is elevated\");\r",
											"\r",
											"}\r",
											"\r",
											"var stuff = pm.request.auth;\r",
											"var stuff = pm.request;\r",
											"\r",
											"if (user == 'elevated' || user == 'staff' || user == \"officer60\") {\r",
											"    pm.test(\"User is elevated. Status code is 200\", function () {\r",
											"        pm.response.to.have.status(200);\r",
											"    });\r",
											"}\r",
											"else {\r",
											"    pm.test(\"User is not Staff, IAO (w/ proper dept) or elevated. Expected status code is 403\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"\r",
											"if (pm.response.code == 500) {\r",
											"    console.log(\"Server returned 500\")\r",
											"    return;\r",
											"}\r",
											"\r",
											"var jsonData = pm.response.json();\r",
											"\r",
											"\r",
											"\r",
											"pm.test(\"Response JSON is an object\", function () {\r",
											"    pm.expect(jsonData).to.be.an('object');\r",
											"});\r",
											"\r",
											"let createdAsset = jsonData.assetId;\r",
											"\r",
											"\r",
											"pm.test(`Patched Asset: ${createdAsset}`, function () {\r",
											"    pm.expect(createdAsset).to.be.an('string');\r",
											"});\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PATCH",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"name\": \"z_testAssetPatched\",\n    \"ip\": \"1.1.1.1\",\n    \"nonnetwork\": true,\n    \"stigReviewers\": [\n        {\n            \"benchmarkId\": \"DNS_SRG\",\n            \"userIds\": [\n                \"22\"\n            ]\n        }\n    ]\n}",
									"options": {
										"raw": {}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/assets/:assetId?elevate={{elevated}}&projection=stigReviewers&projection=stigs&projection=adminStats",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets",
										":assetId"
									],
									"query": [
										{
											"key": "elevate",
											"value": "{{elevated}}",
											"description": "Elevate the user context for this request if user is permitted (canAdmin)"
										},
										{
											"key": "projection",
											"value": "stigReviewers",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "stigs",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "adminStats"
										}
									],
									"variable": [
										{
											"description": "(Required) A path parameter that indentifies an Asset",
											"id": "9cd8e7cd-03bc-474b-a2d0-9a99c99a0b12",
											"key": "assetId",
											"type": "string",
											"value": "{{createdAsset}}"
										}
									]
								}
							},
							"response": [
								{
									"name": "AssetProjected response",
									"originalRequest": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\",\n    \"ip\": \"<string>\",\n    \"nonnetwork\": \"<boolean>\",\n    \"scanexempt\": \"<boolean>\",\n    \"packageIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ],\n    \"benchmarkIds\": [\n        \"<string>\",\n        \"<string>\"\n    ],\n    \"stigReviewers\": [\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        },\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        }\n    ]\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"assetId\": \"<integer>\",\n \"name\": \"<string>\",\n \"dept\": \"<string>\",\n \"ip\": \"<string>\",\n \"nonnetwork\": \"<boolean>\",\n \"scanexempt\": \"<boolean>\",\n \"adminStats\": {\n  \"stigCount\": \"<integer>\",\n  \"stigAssignedCount\": \"<integer>\"\n },\n \"packages\": [\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  },\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  }\n ],\n \"stigReviewers\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  }\n ]\n}"
								},
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "PATCH",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\",\n    \"ip\": \"<string>\",\n    \"nonnetwork\": \"<boolean>\",\n    \"scanexempt\": \"<boolean>\",\n    \"packageIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ],\n    \"benchmarkIds\": [\n        \"<string>\",\n        \"<string>\"\n    ],\n    \"stigReviewers\": [\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        },\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        }\n    ]\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								}
							]
						},
						{
							"name": "Replace all properties of an Asset",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "c3c89587-a269-4b33-bc05-9f9b50975cd5",
										"exec": [
											"let user = pm.environment.get(\"user\");\r",
											"console.log(\"user: \" + user);\r",
											"if (user == \"wf10\") {\r",
											"    pm.test(\"Status should be is 403 for user wf10\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"\r",
											"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
											"    user = \"elevated\";\r",
											"    console.log(\"user is elevated\");\r",
											"\r",
											"}\r",
											"\r",
											"var stuff = pm.request.auth;\r",
											"var stuff = pm.request;\r",
											"\r",
											"if (user == 'elevated' || user == 'lvl3' || user == \"lvl4\") {\r",
											"    pm.test(\"User is elevated, lvl3, or lvl4. Status code is 200\", function () {\r",
											"        pm.response.to.have.status(200);\r",
											"    });\r",
											"}\r",
											"else {\r",
											"    pm.test(\"User is not lvl3, lvl4 or elevated. Expected status code is 403\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"\r",
											"if (pm.response.code == 500) {\r",
											"    console.log(\"Server returned 500\")\r",
											"    return;\r",
											"}\r",
											"\r",
											"var jsonData = pm.response.json();\r",
											"\r",
											"\r",
											"\r",
											"pm.test(\"Response JSON is an object\", function () {\r",
											"    pm.expect(jsonData).to.be.an('object');\r",
											"});\r",
											"\r",
											"let createdAsset = jsonData.assetId;\r",
											"\r",
											"pm.test(`Put Asset: ${createdAsset}`, function () {\r",
											"    pm.expect(createdAsset).to.be.an('string');\r",
											"});\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PUT",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"name\": \"z_testAssetPut\",\n    \"ip\": \"1.1.1.2\",\n    \"nonnetwork\": false,\n    \"packageId\": \"21\",\n    \"stigReviewers\": [\n        {\n            \"benchmarkId\": \"DNS_SRG\",\n            \"userIds\": [\n                \"21\"\n            ]\n        }\n    ],\n    \"metadata\": {  \n        \"assetName2\": \"namely\"\n    }\n}",
									"options": {
										"raw": {}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/assets/:assetId?elevate={{elevated}}&projection=stigReviewers&projection=stigs&projection=adminStats",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets",
										":assetId"
									],
									"query": [
										{
											"key": "elevate",
											"value": "{{elevated}}",
											"description": "Elevate the user context for this request if user is permitted (canAdmin)"
										},
										{
											"key": "projection",
											"value": "stigReviewers",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "stigs",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "adminStats"
										}
									],
									"variable": [
										{
											"description": "(Required) A path parameter that indentifies an Asset",
											"id": "10696bd4-f3b0-4d41-bcbc-123a7d6998f5",
											"key": "assetId",
											"type": "string",
											"value": "{{createdAsset}}"
										}
									]
								}
							},
							"response": [
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "PUT",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\",\n    \"ip\": \"<string>\",\n    \"nonnetwork\": \"<boolean>\",\n    \"scanexempt\": \"<boolean>\",\n    \"packageIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ],\n    \"benchmarkIds\": [\n        \"<string>\",\n        \"<string>\"\n    ],\n    \"stigReviewers\": [\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        },\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        }\n    ]\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								},
								{
									"name": "AssetProjected response",
									"originalRequest": {
										"method": "PUT",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\",\n    \"ip\": \"<string>\",\n    \"nonnetwork\": \"<boolean>\",\n    \"scanexempt\": \"<boolean>\",\n    \"packageIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ],\n    \"benchmarkIds\": [\n        \"<string>\",\n        \"<string>\"\n    ],\n    \"stigReviewers\": [\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        },\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        }\n    ]\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"assetId\": \"<integer>\",\n \"name\": \"<string>\",\n \"dept\": \"<string>\",\n \"ip\": \"<string>\",\n \"nonnetwork\": \"<boolean>\",\n \"scanexempt\": \"<boolean>\",\n \"adminStats\": {\n  \"stigCount\": \"<integer>\",\n  \"stigAssignedCount\": \"<integer>\"\n },\n \"packages\": [\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  },\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  }\n ],\n \"stigReviewers\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  }\n ]\n}"
								}
							]
						},
						{
							"name": "Delete an Asset",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "fa3dce14-4f7f-490b-98ab-30fa9d762753",
										"exec": [
											"\r",
											"let user = pm.environment.get(\"user\");\r",
											"console.log(\"user: \" + user);\r",
											"if (user == \"wf10\") {\r",
											"    pm.test(\"Status should be is 403 for user wf10\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"\r",
											"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
											"    user = \"elevated\";\r",
											"}\r",
											"\r",
											"var jsonData = pm.response.json();\r",
											"\r",
											"\r",
											"if (user == \"lvl1\" || user == \"lvl2\" || user == \"packageCreator\" || user == \"globular\" || user == \"admin\") {\r",
											"    pm.test(\"Status code should be 403\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    console.log(`Status code: ${pm.response.code}. Either previous test did not create the package, the package has already been deleted, or this user is not authorized to delete this package.`);\r",
											"    return;\r",
											"}\r",
											"\r",
											"pm.test(\"Status code is 200\", function () {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"console.log(jsonData);\r",
											"// console.log(pm.environment.get(\"env\"));\r",
											"\r",
											"pm.test(\"Response is a JSON object\", function () {\r",
											"    pm.expect(jsonData).to.be.an('object');\r",
											"});\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "DELETE",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/assets/:assetId?projection=stigs&projection=stigReviewers&projection=adminStats&elevate={{elevated}}",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets",
										":assetId"
									],
									"query": [
										{
											"key": "projection",
											"value": "stigs",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "stigReviewers",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "adminStats"
										},
										{
											"key": "elevate",
											"value": "{{elevated}}",
											"description": "Elevate the user context for this request if user is permitted (canAdmin)"
										}
									],
									"variable": [
										{
											"description": "(Required) A path parameter that indentifies an Asset",
											"id": "d9b08ac7-bf6b-495b-8d61-2177f4e397f6",
											"key": "assetId",
											"type": "string",
											"value": "{{createdAsset}}"
										}
									]
								}
							},
							"response": [
								{
									"name": "AssetProjected response",
									"originalRequest": {
										"method": "DELETE",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"assetId\": \"<integer>\",\n \"name\": \"<string>\",\n \"dept\": \"<string>\",\n \"ip\": \"<string>\",\n \"nonnetwork\": \"<boolean>\",\n \"scanexempt\": \"<boolean>\",\n \"adminStats\": {\n  \"stigCount\": \"<integer>\",\n  \"stigAssignedCount\": \"<integer>\"\n },\n \"packages\": [\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  },\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  }\n ],\n \"stigReviewers\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  }\n ]\n}"
								},
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "DELETE",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								}
							]
						},
						{
							"name": "Delete an Asset CLEANUP",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "6f7de0e1-de1a-4941-b769-586a50f26df4",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "oauth2",
									"oauth2": [
										{
											"key": "accessToken",
											"value": "{{token.admin}}",
											"type": "string"
										}
									]
								},
								"method": "DELETE",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/assets/:assetId?elevate=true&projection=stigReviewers&projection=adminStats",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets",
										":assetId"
									],
									"query": [
										{
											"key": "elevate",
											"value": "true",
											"description": "Elevate the user context for this request if user is permitted (canAdmin)"
										},
										{
											"key": "projection",
											"value": "stigReviewers",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "adminStats"
										}
									],
									"variable": [
										{
											"description": "(Required) A path parameter that indentifies an Asset",
											"id": "44ec95c1-32a8-4f0c-a131-bf74dd057e65",
											"key": "assetId",
											"type": "string",
											"value": "{{createdAsset}}"
										}
									]
								}
							},
							"response": [
								{
									"name": "AssetProjected response",
									"originalRequest": {
										"method": "DELETE",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"assetId\": \"<integer>\",\n \"name\": \"<string>\",\n \"dept\": \"<string>\",\n \"ip\": \"<string>\",\n \"nonnetwork\": \"<boolean>\",\n \"scanexempt\": \"<boolean>\",\n \"adminStats\": {\n  \"stigCount\": \"<integer>\",\n  \"stigAssignedCount\": \"<integer>\"\n },\n \"packages\": [\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  },\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  }\n ],\n \"stigReviewers\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  }\n ]\n}"
								},
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "DELETE",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								}
							]
						},
						{
							"name": "Return the Checklist for the supplied Asset and STIG",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "9d36be91-004d-4364-bf3c-4534c5434c9e",
										"exec": [
											"let user = pm.environment.get(\"user\");\r",
											"console.log(\"user: \" + user);\r",
											"if (user == \"packageCreator\") {\r",
											"    pm.test(\"Status should be is 403 for user packageCreator\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"else {\r",
											"    pm.test(\"Status code is 200\", function () {\r",
											"        pm.response.to.have.status(200);\r",
											"    });\r",
											"}\r",
											"\r",
											"let jsonData = pm.response.json();\r",
											"\r",
											"let elevated = pm.environment.get(\"elevated\");\r",
											"console.log(\"user: \" + user);\r",
											"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
											"    user = \"elevated\";\r",
											"}\r",
											"\r",
											"\r",
											"console.log(jsonData);\r",
											"// console.log(pm.environment.get(\"env\"));\r",
											"\r",
											"pm.test(\"Response JSON is an array\", function () {\r",
											"    pm.expect(jsonData).to.be.an('array');\r",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/assets/:assetId/checklists/:benchmarkId/:revisionStr?elevate={{elevated}}&format=json",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets",
										":assetId",
										"checklists",
										":benchmarkId",
										":revisionStr"
									],
									"query": [
										{
											"key": "elevate",
											"value": "{{elevated}}",
											"description": "Elevate the user context for this request if user is permitted (canAdmin)"
										},
										{
											"key": "format",
											"value": "json",
											"description": "The format of the response. Default if missing is 'json'"
										}
									],
									"variable": [
										{
											"description": "(Required) A path parameter that indentifies an Asset",
											"id": "27f87033-4b83-4f39-891e-6e7df2aac681",
											"key": "assetId",
											"type": "string",
											"value": "{{assets.queryAsset}}"
										},
										{
											"description": "(Required) A path parameter that indentifies a STIG",
											"id": "579915c3-9046-479a-898b-6da50475a6d4",
											"key": "benchmarkId",
											"type": "string",
											"value": "{{assets.queryBenchmark}}"
										},
										{
											"description": "(Required) A path parameter that indentifies a STIG revision [ V{version_num}R{release_num} | 'latest' ]",
											"id": "9af76621-877b-42ba-9c98-893c894286f3",
											"key": "revisionStr",
											"type": "string",
											"value": "{{assets.queryRev}}"
										}
									]
								}
							},
							"response": [
								{
									"name": "Review response",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId/checklists/:benchmarkId/:revisionStr?elevate=<boolean>&format=json",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId",
												"checklists",
												":benchmarkId",
												":revisionStr"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "format",
													"value": "json"
												}
											],
											"variable": [
												{
													"key": "assetId"
												},
												{
													"key": "benchmarkId"
												},
												{
													"key": "revisionStr"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"reviewId\": \"<integer>\",\n \"assetId\": \"<integer>\",\n \"ruleId\": \"<string>\",\n \"state\": \"<string>\",\n \"stateComment\": \"<string>\",\n \"autoState\": \"<boolean>\",\n \"action\": \"<string>\",\n \"actionComment\": \"<string>\",\n \"reqDoc\": \"<boolean>\",\n \"status\": \"<string>\",\n \"userId\": \"<integer>\",\n \"ts\": \"<string>\",\n \"rejectText\": \"<string>\",\n \"rejectUserId\": \"<integer>\"\n}"
								},
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId/checklists/:benchmarkId/:revisionStr?elevate=<boolean>&format=json",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId",
												"checklists",
												":benchmarkId",
												":revisionStr"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "format",
													"value": "json"
												}
											],
											"variable": [
												{
													"key": "assetId"
												},
												{
													"key": "benchmarkId"
												},
												{
													"key": "revisionStr"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								}
							]
						},
						{
							"name": "asset - get - assetId no StigReviewers projection (prohibited for level 1)",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "8d735212-c78b-4e5a-ba16-fbd79c4875bf",
										"exec": [
											"let user = pm.environment.get(\"user\");\r",
											"console.log(\"user: \" + user);\r",
											"if (user == \"wf10\") {\r",
											"    pm.test(\"Status should be 403 for user wf10, elevated\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"\r",
											"\r",
											"let elevated = pm.environment.get(\"elevated\");\r",
											"console.log(\"user: \" + user);\r",
											"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
											"    user = \"elevated\";\r",
											"}\r",
											"\r",
											"if (user == \"packageCreator\") {\r",
											"    pm.test(\"Status should be 403 for user packageCreator, not elevated\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"return;\r",
											"}\r",
											"\r",
											"pm.test(\"Status code is 200\", function () {\r",
											"    pm.response.to.have.status(200);\r",
											"});\r",
											"\r",
											"let jsonData = pm.response.json();\r",
											"\r",
											"console.log(jsonData);\r",
											"// console.log(pm.environment.get(\"env\"));\r",
											"\r",
											"pm.test(\"Response JSON is an object\", function () {\r",
											"    pm.expect(jsonData).to.be.an('object');\r",
											"});\r",
											"\r",
											"\r",
											"\r",
											"let allowedPackages, disallowedPackages, validStigs, invalidStigs, validAssets, invalidAssets;\r",
											"console.log(\"assignments\");\r",
											"// allowedPackages = JSON.parse(pm.environment.get((\"packages.valid\")));\r",
											"// disallowedPackages = JSON.parse(pm.environment.get(\"packages.invalid\"));\r",
											"validStigs = JSON.parse(pm.environment.get(\"stigs.valid\"));\r",
											"// invalidStigs = JSON.parse(pm.environment.get(\"stigs.invalid\"));\r",
											"// validAssets = JSON.parse(pm.environment.get(\"assets.valid\"));\r",
											"// invalidAssets = JSON.parse(pm.environment.get(\"assets.invalid\"));\r",
											"console.log(\"user is \" + user);\r",
											"\r",
											"\r",
											"let packageIds = [];\r",
											"let assetIds = [];\r",
											"let stigReviewersStigs = [];\r",
											"let stigs = [];\r",
											"\r",
											"\r",
											"pm.test(\"Each item in response has proper properties\", function () {\r",
											"    // pm.expect(jsonData).to.have.property('packages');\r",
											"    // packageIds.push(jsonData.packageId);\r",
											"    pm.expect(jsonData).to.have.property('adminStats');\r",
											"    pm.expect(jsonData).to.have.property('stigs');\r",
											"\r",
											"    // jsonData.packages.forEach(function (package) {\r",
											"    //     pm.expect(package).to.have.property('packageId');\r",
											"    //     packageIds.push(package.packageId);\r",
											"    // });\r",
											"    jsonData.stigs.forEach(function (stig) {\r",
											"        pm.expect(stig).to.have.property('benchmarkId');\r",
											"        stigs.push(stig.benchmarkId);\r",
											"    });\r",
											"\r",
											"    // pm.expect(packageIds).to.include.oneOf(allowedPackages);\r",
											"});\r",
											"\r",
											"console.log(\"packageIds = \" + packageIds);\r",
											"\r",
											"pm.test(\"Response contains valid projection data (packages)\", function () {\r",
											"    packageIds.forEach( function (package) {\r",
											"    console.log(\"checking packageId: \" + package);\r",
											"    pm.expect(package).to.be.oneOf(allowedPackages);\r",
											"    });\r",
											"});\r",
											"\r",
											"pm.test(\"Response contains valid projection data (stigs)\", function () {\r",
											"    stigs.forEach( function (stig) {\r",
											"    console.log(\"checking stig: \" + stig);\r",
											"    pm.expect(stig).to.be.oneOf(validStigs);\r",
											"    });\r",
											"});\r",
											"\r",
											" if (user != \"wf60\" && user != \"guest\"){\r",
											"    pm.test(\"Response contains valid projection data (stigs in stigReviewers objects)\", function () {\r",
											"    stigReviewersStigs.forEach( function (stig) {\r",
											"        console.log(\"checking stig: \" + stig);\r",
											"        pm.expect(stig).to.be.oneOf(validStigs);\r",
											"        });\r",
											"    });\r",
											"}\r",
											"\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/assets/:assetId?projection=adminStats&elevate={{elevated}}&projection=stigs",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets",
										":assetId"
									],
									"query": [
										{
											"key": "projection",
											"value": "adminStats"
										},
										{
											"key": "elevate",
											"value": "{{elevated}}"
										},
										{
											"key": "projection",
											"value": "stigs"
										}
									],
									"variable": [
										{
											"id": "1bb4a48c-1fc2-4a6f-bb6a-113e660c7290",
											"key": "assetId",
											"type": "string",
											"value": "{{assets.queryAsset}}"
										}
									]
								}
							},
							"response": [
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								},
								{
									"name": "AssetProjected response",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"assetId\": \"<integer>\",\n \"name\": \"<string>\",\n \"dept\": \"<string>\",\n \"ip\": \"<string>\",\n \"nonnetwork\": \"<boolean>\",\n \"scanexempt\": \"<boolean>\",\n \"adminStats\": {\n  \"stigCount\": \"<integer>\",\n  \"stigAssignedCount\": \"<integer>\"\n },\n \"packages\": [\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  },\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  }\n ],\n \"stigReviewers\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  }\n ]\n}"
								}
							]
						}
					],
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "7ba62e59-26b9-4ac5-91f1-f85216fd6ad7",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "61df1598-bcc6-4032-92f5-b393f59e708a",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "Optional Params and Edge Cases",
					"item": [
						{
							"name": "Create an Asset - lvl3- non-existent package",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "eab93c75-0817-4f1d-985d-7a7db2157229",
										"exec": [
											"let user = pm.environment.get(\"user\");\r",
											"console.log(\"user: \" + user);\r",
											"\r",
											"pm.test(\"Status should be is 403 for posting asset to non-existent package\", function () {\r",
											"    pm.response.to.have.status(403);\r",
											"});\r",
											"\r",
											"return;\r",
											"\r",
											"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
											"    user = \"elevated\";\r",
											"    console.log(\"user is elevated\");\r",
											"\r",
											"}\r",
											"\r",
											"var stuff = pm.request.auth;\r",
											"var stuff = pm.request;\r",
											"\r",
											"if (user == 'elevated' || user == 'staff' ) {\r",
											"    pm.test(\"User is elevated. Status code is 201\", function () {\r",
											"        pm.response.to.have.status(201);\r",
											"    });\r",
											"}\r",
											"else {\r",
											"    pm.test(\"User is not elevated, or staff, or code 85 IAO. Expected status code is 403\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"\r",
											"if (pm.response.code == 500) {\r",
											"    console.log(\"Server returned 500\")\r",
											"    return;\r",
											"}\r",
											"\r",
											"var jsonData = pm.response.json();\r",
											"\r",
											"\r",
											"\r",
											"pm.test(\"Response JSON is an object\", function () {\r",
											"    pm.expect(jsonData).to.be.an('object');\r",
											"});\r",
											"\r",
											"let createdAsset = jsonData.assetId;\r",
											"console.log(\"created asset: \" + createdAsset)\r",
											"pm.environment.set(\"createdAsset\", createdAsset);\r",
											"\r",
											"pm.test(`Created Asset: ${createdAsset}`, function () {\r",
											"    pm.expect(createdAsset).to.be.an('number');\r",
											"});\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"name\": \"z_testAsset_expectFail-1\",\n    \"packageId\": \"2\",\n    \"ip\": \"\",\n    \"nonnetwork\": false,\n    \"stigReviewers\": [],\n    \"metadata\":{}\n}",
									"options": {
										"raw": {}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/assets?projection=stigReviewers&projection=adminStats&elevate={{elevated}}",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets"
									],
									"query": [
										{
											"key": "projection",
											"value": "stigs",
											"description": "Additional properties to include in the response.\n",
											"disabled": true
										},
										{
											"key": "projection",
											"value": "stigReviewers"
										},
										{
											"key": "projection",
											"value": "adminStats"
										},
										{
											"key": "elevate",
											"value": "{{elevated}}"
										}
									]
								}
							},
							"response": [
								{
									"name": "AssetProjected response",
									"originalRequest": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\",\n    \"ip\": \"<string>\",\n    \"nonnetwork\": \"<boolean>\",\n    \"scanexempt\": \"<boolean>\",\n    \"packageIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ],\n    \"benchmarkIds\": [\n        \"<string>\",\n        \"<string>\"\n    ],\n    \"stigReviewers\": [\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        },\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        }\n    ]\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/assets?projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets"
											],
											"query": [
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "Created",
									"code": 201,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"assetId\": \"<integer>\",\n \"name\": \"<string>\",\n \"dept\": \"<string>\",\n \"ip\": \"<string>\",\n \"nonnetwork\": \"<boolean>\",\n \"scanexempt\": \"<boolean>\",\n \"adminStats\": {\n  \"stigCount\": \"<integer>\",\n  \"stigAssignedCount\": \"<integer>\"\n },\n \"packages\": [\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  },\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  }\n ],\n \"stigReviewers\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  }\n ]\n}"
								},
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\",\n    \"ip\": \"<string>\",\n    \"nonnetwork\": \"<boolean>\",\n    \"scanexempt\": \"<boolean>\",\n    \"packageIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ],\n    \"benchmarkIds\": [\n        \"<string>\",\n        \"<string>\"\n    ],\n    \"stigReviewers\": [\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        },\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        }\n    ]\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/assets?projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets"
											],
											"query": [
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								}
							]
						},
						{
							"name": "Delete an Asset CLEANUP",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "bcb68035-15c1-48fe-acff-cfa67a7b7bd3",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "oauth2",
									"oauth2": [
										{
											"key": "accessToken",
											"value": "{{token.admin}}",
											"type": "string"
										}
									]
								},
								"method": "DELETE",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/assets/:assetId?elevate=true&projection=stigReviewers&projection=adminStats",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets",
										":assetId"
									],
									"query": [
										{
											"key": "elevate",
											"value": "true",
											"description": "Elevate the user context for this request if user is permitted (canAdmin)"
										},
										{
											"key": "projection",
											"value": "stigReviewers",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "adminStats"
										}
									],
									"variable": [
										{
											"description": "(Required) A path parameter that indentifies an Asset",
											"id": "f78b98eb-81d4-4d74-a5e1-fa79d6f8ebb1",
											"key": "assetId",
											"type": "string",
											"value": "{{createdAsset}}"
										}
									]
								}
							},
							"response": [
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "DELETE",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								},
								{
									"name": "AssetProjected response",
									"originalRequest": {
										"method": "DELETE",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"assetId\": \"<integer>\",\n \"name\": \"<string>\",\n \"dept\": \"<string>\",\n \"ip\": \"<string>\",\n \"nonnetwork\": \"<boolean>\",\n \"scanexempt\": \"<boolean>\",\n \"adminStats\": {\n  \"stigCount\": \"<integer>\",\n  \"stigAssignedCount\": \"<integer>\"\n },\n \"packages\": [\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  },\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  }\n ],\n \"stigReviewers\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  }\n ]\n}"
								}
							]
						},
						{
							"name": "Create an Asset - reviewer not in package",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "001397d5-43c0-4256-8862-a88ee5f25737",
										"exec": [
											"let user = pm.environment.get(\"user\");\r",
											"console.log(\"user: \" + user);\r",
											"\r",
											"pm.test(\"Status should be is 403 for posting asset with invalid reviewer\", function () {\r",
											"    pm.response.to.have.status(403);\r",
											"});\r",
											"\r",
											"return;\r",
											"\r",
											"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
											"    user = \"elevated\";\r",
											"    console.log(\"user is elevated\");\r",
											"\r",
											"}\r",
											"\r",
											"var stuff = pm.request.auth;\r",
											"var stuff = pm.request;\r",
											"\r",
											"if (user == 'elevated' || user == 'staff' ) {\r",
											"    pm.test(\"User is elevated. Status code is 201\", function () {\r",
											"        pm.response.to.have.status(201);\r",
											"    });\r",
											"}\r",
											"else {\r",
											"    pm.test(\"User is not elevated, or staff, or code 85 IAO. Expected status code is 403\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"\r",
											"if (pm.response.code == 500) {\r",
											"    console.log(\"Server returned 500\")\r",
											"    return;\r",
											"}\r",
											"\r",
											"var jsonData = pm.response.json();\r",
											"\r",
											"\r",
											"\r",
											"pm.test(\"Response JSON is an object\", function () {\r",
											"    pm.expect(jsonData).to.be.an('object');\r",
											"});\r",
											"\r",
											"let createdAsset = jsonData.assetId;\r",
											"console.log(\"created asset: \" + createdAsset)\r",
											"pm.environment.set(\"createdAsset\", createdAsset);\r",
											"\r",
											"pm.test(`Created Asset: ${createdAsset}`, function () {\r",
											"    pm.expect(createdAsset).to.be.an('number');\r",
											"});\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"name\": \"z_testAsset_expectFail-2\",\n    \"packageId\": \"1\",\n    \"ip\": \"\",\n    \"nonnetwork\": false,\n    \"stigReviewers\": \n    [{\n      \"benchmarkId\": \"Active_Directory_Domain\",\n      \"userIds\": [\"22\"]\n    }],\n    \"metadata\": {}\n}",
									"options": {
										"raw": {}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/assets?projection=stigReviewers&projection=adminStats&elevate={{elevated}}",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets"
									],
									"query": [
										{
											"key": "projection",
											"value": "stigs",
											"description": "Additional properties to include in the response.\n",
											"disabled": true
										},
										{
											"key": "projection",
											"value": "stigReviewers"
										},
										{
											"key": "projection",
											"value": "adminStats"
										},
										{
											"key": "elevate",
											"value": "{{elevated}}"
										}
									]
								}
							},
							"response": [
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\",\n    \"ip\": \"<string>\",\n    \"nonnetwork\": \"<boolean>\",\n    \"scanexempt\": \"<boolean>\",\n    \"packageIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ],\n    \"benchmarkIds\": [\n        \"<string>\",\n        \"<string>\"\n    ],\n    \"stigReviewers\": [\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        },\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        }\n    ]\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/assets?projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets"
											],
											"query": [
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								},
								{
									"name": "AssetProjected response",
									"originalRequest": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\",\n    \"ip\": \"<string>\",\n    \"nonnetwork\": \"<boolean>\",\n    \"scanexempt\": \"<boolean>\",\n    \"packageIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ],\n    \"benchmarkIds\": [\n        \"<string>\",\n        \"<string>\"\n    ],\n    \"stigReviewers\": [\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        },\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        }\n    ]\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/assets?projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets"
											],
											"query": [
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "Created",
									"code": 201,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"assetId\": \"<integer>\",\n \"name\": \"<string>\",\n \"dept\": \"<string>\",\n \"ip\": \"<string>\",\n \"nonnetwork\": \"<boolean>\",\n \"scanexempt\": \"<boolean>\",\n \"adminStats\": {\n  \"stigCount\": \"<integer>\",\n  \"stigAssignedCount\": \"<integer>\"\n },\n \"packages\": [\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  },\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  }\n ],\n \"stigReviewers\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  }\n ]\n}"
								}
							]
						},
						{
							"name": "Delete an Asset CLEANUP",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "ec71fb6c-78de-4366-8791-a0b88011280e",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "oauth2",
									"oauth2": [
										{
											"key": "accessToken",
											"value": "{{token.admin}}",
											"type": "string"
										}
									]
								},
								"method": "DELETE",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/assets/:assetId?elevate=true&projection=stigReviewers&projection=adminStats",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets",
										":assetId"
									],
									"query": [
										{
											"key": "elevate",
											"value": "true",
											"description": "Elevate the user context for this request if user is permitted (canAdmin)"
										},
										{
											"key": "projection",
											"value": "stigReviewers",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "adminStats"
										}
									],
									"variable": [
										{
											"description": "(Required) A path parameter that indentifies an Asset",
											"id": "5a3f7b9d-aa8a-4d25-b68c-ae98b1745f5f",
											"key": "assetId",
											"type": "string",
											"value": "{{createdAsset}}"
										}
									]
								}
							},
							"response": [
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "DELETE",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								},
								{
									"name": "AssetProjected response",
									"originalRequest": {
										"method": "DELETE",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"assetId\": \"<integer>\",\n \"name\": \"<string>\",\n \"dept\": \"<string>\",\n \"ip\": \"<string>\",\n \"nonnetwork\": \"<boolean>\",\n \"scanexempt\": \"<boolean>\",\n \"adminStats\": {\n  \"stigCount\": \"<integer>\",\n  \"stigAssignedCount\": \"<integer>\"\n },\n \"packages\": [\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  },\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  }\n ],\n \"stigReviewers\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  }\n ]\n}"
								}
							]
						},
						{
							"name": "Create an Asset - with no assignments to for subsequent PUT test",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "74de4181-4246-456b-86cd-7141eb33c97a",
										"exec": [
											"let user = pm.environment.get(\"user\");\r",
											"console.log(\"user: \" + user);\r",
											"if (user == \"wf10\") {\r",
											"    pm.test(\"Status should be is 403 for user wf10\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"\r",
											"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
											"    user = \"elevated\";\r",
											"    console.log(\"user is elevated\");\r",
											"\r",
											"}\r",
											"\r",
											"var stuff = pm.request.auth;\r",
											"var stuff = pm.request;\r",
											"\r",
											"if (user == 'elevated' || user == 'staff' || user == \"officer60\") {\r",
											"    pm.test(\"User is elevated. Status code is 201\", function () {\r",
											"        pm.response.to.have.status(201);\r",
											"    });\r",
											"}\r",
											"else {\r",
											"    pm.test(\"User is not Staff, IAO (w/ proper dept) or elevated. Expected status code is 403\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"\r",
											"if (pm.response.code == 500) {\r",
											"    console.log(\"Server returned 500\")\r",
											"    return;\r",
											"}\r",
											"\r",
											"var jsonData = pm.response.json();\r",
											"\r",
											"\r",
											"\r",
											"pm.test(\"Response JSON is an object\", function () {\r",
											"    pm.expect(jsonData).to.be.an('object');\r",
											"});\r",
											"\r",
											"let createdAsset = jsonData.assetId;\r",
											"console.log(\"created asset: \" + createdAsset)\r",
											"pm.environment.set(\"createdAsset\", createdAsset);\r",
											"\r",
											"pm.test(`Created Asset: ${createdAsset}`, function () {\r",
											"    pm.expect(createdAsset).to.be.an('string');\r",
											"});\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"name\": \"z_testAsset_expectSuccess-1\",\n    \"packageId\": \"1\",\n    \"ip\": \"\",\n    \"nonnetwork\": false,\n    \"stigReviewers\": [],\n    \"metadata\": {}\n}",
									"options": {
										"raw": {}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/assets?projection=stigReviewers&projection=adminStats&elevate={{elevated}}",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets"
									],
									"query": [
										{
											"key": "projection",
											"value": "stigs",
											"description": "Additional properties to include in the response.\n",
											"disabled": true
										},
										{
											"key": "projection",
											"value": "stigReviewers"
										},
										{
											"key": "projection",
											"value": "adminStats"
										},
										{
											"key": "elevate",
											"value": "{{elevated}}"
										}
									]
								}
							},
							"response": [
								{
									"name": "AssetProjected response",
									"originalRequest": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\",\n    \"ip\": \"<string>\",\n    \"nonnetwork\": \"<boolean>\",\n    \"scanexempt\": \"<boolean>\",\n    \"packageIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ],\n    \"benchmarkIds\": [\n        \"<string>\",\n        \"<string>\"\n    ],\n    \"stigReviewers\": [\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        },\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        }\n    ]\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/assets?projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets"
											],
											"query": [
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "Created",
									"code": 201,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"assetId\": \"<integer>\",\n \"name\": \"<string>\",\n \"dept\": \"<string>\",\n \"ip\": \"<string>\",\n \"nonnetwork\": \"<boolean>\",\n \"scanexempt\": \"<boolean>\",\n \"adminStats\": {\n  \"stigCount\": \"<integer>\",\n  \"stigAssignedCount\": \"<integer>\"\n },\n \"packages\": [\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  },\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  }\n ],\n \"stigReviewers\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  }\n ]\n}"
								},
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "POST",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\",\n    \"ip\": \"<string>\",\n    \"nonnetwork\": \"<boolean>\",\n    \"scanexempt\": \"<boolean>\",\n    \"packageIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ],\n    \"benchmarkIds\": [\n        \"<string>\",\n        \"<string>\"\n    ],\n    \"stigReviewers\": [\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        },\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        }\n    ]\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/assets?projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets"
											],
											"query": [
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								}
							]
						},
						{
							"name": "Replace all properties of an Asset with no Current Assignments",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "00991b6d-4267-4345-9880-28bcad00d719",
										"exec": [
											"let user = pm.environment.get(\"user\");\r",
											"console.log(\"user: \" + user);\r",
											"if (user == \"wf10\") {\r",
											"    pm.test(\"Status should be is 403 for user wf10\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"\r",
											"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
											"    user = \"elevated\";\r",
											"    console.log(\"user is elevated\");\r",
											"\r",
											"}\r",
											"\r",
											"var stuff = pm.request.auth;\r",
											"var stuff = pm.request;\r",
											"\r",
											"if (user == 'elevated' || user == 'staff' || user == \"officer60\") {\r",
											"    pm.test(\"User is elevated. Status code is 200\", function () {\r",
											"        pm.response.to.have.status(200);\r",
											"    });\r",
											"}\r",
											"else {\r",
											"    pm.test(\"User is not Staff, IAO (w/ proper dept) or elevated. Expected status code is 403\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"\r",
											"if (pm.response.code == 500) {\r",
											"    console.log(\"Server returned 500\")\r",
											"    return;\r",
											"}\r",
											"\r",
											"var jsonData = pm.response.json();\r",
											"\r",
											"\r",
											"\r",
											"pm.test(\"Response JSON is an object\", function () {\r",
											"    pm.expect(jsonData).to.be.an('object');\r",
											"});\r",
											"\r",
											"let createdAsset = jsonData.assetId;\r",
											"\r",
											"pm.test(`Put Asset: ${createdAsset}`, function () {\r",
											"    pm.expect(createdAsset).to.be.an('number');\r",
											"});\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "PUT",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"name\": \"z_testAssetPut\",\n    \"packageId\": \"1\",\n    \"ip\": \"1.1.1.2\",\n    \"nonnetwork\": false,\n    \"stigReviewers\": [\n        {\n            \"benchmarkId\": \"Active_Directory_Domain\",\n            \"userIds\": [\n                \"21\"\n            ]\n        }\n    ],\n    \"metadata\": {}\n}",
									"options": {
										"raw": {}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/assets/{{createdAsset}}?elevate={{elevated}}&projection=stigs&projection=adminStats",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets",
										"{{createdAsset}}"
									],
									"query": [
										{
											"key": "elevate",
											"value": "{{elevated}}"
										},
										{
											"key": "projection",
											"value": "stigs"
										},
										{
											"key": "projection",
											"value": "adminStats"
										}
									]
								}
							},
							"response": [
								{
									"name": "AssetProjected response",
									"originalRequest": {
										"method": "PUT",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\",\n    \"ip\": \"<string>\",\n    \"nonnetwork\": \"<boolean>\",\n    \"scanexempt\": \"<boolean>\",\n    \"packageIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ],\n    \"benchmarkIds\": [\n        \"<string>\",\n        \"<string>\"\n    ],\n    \"stigReviewers\": [\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        },\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        }\n    ]\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"assetId\": \"<integer>\",\n \"name\": \"<string>\",\n \"dept\": \"<string>\",\n \"ip\": \"<string>\",\n \"nonnetwork\": \"<boolean>\",\n \"scanexempt\": \"<boolean>\",\n \"adminStats\": {\n  \"stigCount\": \"<integer>\",\n  \"stigAssignedCount\": \"<integer>\"\n },\n \"packages\": [\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  },\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  }\n ],\n \"stigReviewers\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  }\n ]\n}"
								},
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "PUT",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\",\n    \"ip\": \"<string>\",\n    \"nonnetwork\": \"<boolean>\",\n    \"scanexempt\": \"<boolean>\",\n    \"packageIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ],\n    \"benchmarkIds\": [\n        \"<string>\",\n        \"<string>\"\n    ],\n    \"stigReviewers\": [\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        },\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        }\n    ]\n}"
										},
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								}
							]
						},
						{
							"name": "Delete an Asset CLEANUP",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "29990466-ce86-42db-871d-7424608ac76a",
										"exec": [
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"auth": {
									"type": "oauth2",
									"oauth2": [
										{
											"key": "accessToken",
											"value": "{{token.admin}}",
											"type": "string"
										}
									]
								},
								"method": "DELETE",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/assets/:assetId?elevate=true&projection=stigReviewers&projection=adminStats",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets",
										":assetId"
									],
									"query": [
										{
											"key": "elevate",
											"value": "true",
											"description": "Elevate the user context for this request if user is permitted (canAdmin)"
										},
										{
											"key": "projection",
											"value": "stigReviewers",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "adminStats"
										}
									],
									"variable": [
										{
											"description": "(Required) A path parameter that indentifies an Asset",
											"id": "686d8552-c5bf-450b-b4d0-a751c13a5719",
											"key": "assetId",
											"type": "string",
											"value": "{{createdAsset}}"
										}
									]
								}
							},
							"response": [
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "DELETE",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								},
								{
									"name": "AssetProjected response",
									"originalRequest": {
										"method": "DELETE",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"assetId\": \"<integer>\",\n \"name\": \"<string>\",\n \"dept\": \"<string>\",\n \"ip\": \"<string>\",\n \"nonnetwork\": \"<boolean>\",\n \"scanexempt\": \"<boolean>\",\n \"adminStats\": {\n  \"stigCount\": \"<integer>\",\n  \"stigAssignedCount\": \"<integer>\"\n },\n \"packages\": [\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  },\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  }\n ],\n \"stigReviewers\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  }\n ]\n}"
								}
							]
						},
						{
							"name": "Return the Checklist (expect to fail)",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "fa1fbb91-fe4d-466c-b23e-afdfaf168080",
										"exec": [
											"let user = pm.environment.get(\"user\");\r",
											"console.log(\"user: \" + user);\r",
											"if (user == \"packageCreator\") {\r",
											"    pm.test(\"Status should be is 204 for user packageCreator\", function () {\r",
											"        pm.response.to.have.status(204);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"else {\r",
											"    pm.test(\"Status code is 200\", function () {\r",
											"        pm.response.to.have.status(200);\r",
											"    });\r",
											"}\r",
											"\r",
											"let jsonData = pm.response.json();\r",
											"\r",
											"let elevated = pm.environment.get(\"elevated\");\r",
											"console.log(\"user: \" + user);\r",
											"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
											"    user = \"elevated\";\r",
											"}\r",
											"\r",
											"\r",
											"console.log(jsonData);\r",
											"// console.log(pm.environment.get(\"env\"));\r",
											"\r",
											"pm.test(\"Response JSON is an object\", function () {\r",
											"    pm.expect(jsonData).to.be.an('array');\r",
											"});\r",
											"\r",
											"let checklistLength = pm.environment.get(\"checklistLength\");\r",
											"pm.test(`Response JSON is an array of length: ${jsonData.length}`, function () {\r",
											"    pm.expect(jsonData).to.have.lengthOf(checklistLength);\r",
											"});"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/assets/:assetId/checklists/:benchmarkId/:revisionStr?elevate={{elevated}}&format=json",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets",
										":assetId",
										"checklists",
										":benchmarkId",
										":revisionStr"
									],
									"query": [
										{
											"key": "elevate",
											"value": "{{elevated}}",
											"description": "Elevate the user context for this request if user is permitted (canAdmin)"
										},
										{
											"key": "format",
											"value": "json",
											"description": "The format of the response. Default if missing is 'json'"
										}
									],
									"variable": [
										{
											"description": "(Required) A path parameter that indentifies an Asset",
											"id": "31d5b4fc-7789-4f7a-b758-3d4313810d6d",
											"key": "assetId",
											"type": "string",
											"value": "{{assets.queryAsset}}"
										},
										{
											"description": "(Required) A path parameter that indentifies a STIG",
											"id": "2a46cad8-1dba-4036-b256-c9c8454d21a9",
											"key": "benchmarkId",
											"type": "string",
											"value": "{{assets.queryBenchmark}}"
										},
										{
											"description": "(Required) A path parameter that indentifies a STIG revision [ V{version_num}R{release_num} | 'latest' ]",
											"id": "1ca1690a-5661-4b79-ae3c-d636bc169891",
											"key": "revisionStr",
											"type": "string",
											"value": "{{assets.queryRev}}"
										}
									]
								}
							},
							"response": [
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId/checklists/:benchmarkId/:revisionStr?elevate=<boolean>&format=json",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId",
												"checklists",
												":benchmarkId",
												":revisionStr"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "format",
													"value": "json"
												}
											],
											"variable": [
												{
													"key": "assetId"
												},
												{
													"key": "benchmarkId"
												},
												{
													"key": "revisionStr"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								},
								{
									"name": "Review response",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/assets/:assetId/checklists/:benchmarkId/:revisionStr?elevate=<boolean>&format=json",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"assets",
												":assetId",
												"checklists",
												":benchmarkId",
												":revisionStr"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "format",
													"value": "json"
												}
											],
											"variable": [
												{
													"key": "assetId"
												},
												{
													"key": "benchmarkId"
												},
												{
													"key": "revisionStr"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"reviewId\": \"<integer>\",\n \"assetId\": \"<integer>\",\n \"ruleId\": \"<string>\",\n \"state\": \"<string>\",\n \"stateComment\": \"<string>\",\n \"autoState\": \"<boolean>\",\n \"action\": \"<string>\",\n \"actionComment\": \"<string>\",\n \"reqDoc\": \"<boolean>\",\n \"status\": \"<string>\",\n \"userId\": \"<integer>\",\n \"ts\": \"<string>\",\n \"rejectText\": \"<string>\",\n \"rejectUserId\": \"<integer>\"\n}"
								}
							]
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "Return Assets with specified STIG",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "79ea81f3-d66f-4e7d-85c5-cfcfdd9ea4e6",
								"exec": [
									"let user = pm.environment.get(\"user\");\r",
									"console.log(\"user: \" + user);\r",
									"if (user == \"wf10\") {\r",
									"    pm.test(\"Status should be is 403 for user wf10\", function () {\r",
									"        pm.response.to.have.status(403);\r",
									"    });\r",
									"    return;\r",
									"}\r",
									"else {\r",
									"    pm.test(\"Status code is 200\", function () {\r",
									"        pm.response.to.have.status(200);\r",
									"    });\r",
									"}\r",
									"\r",
									"let jsonData = pm.response.json();\r",
									"\r",
									"let elevated = pm.environment.get(\"elevated\");\r",
									"console.log(\"user: \" + user);\r",
									"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
									"    user = \"elevated\";\r",
									"}\r",
									"\r",
									"\r",
									"console.log(jsonData);\r",
									"// console.log(pm.environment.get(\"env\"));\r",
									"\r",
									"pm.test(\"Response JSON is an object\", function () {\r",
									"    pm.expect(jsonData).to.be.an('array');\r",
									"});\r",
									"\r",
									"let assets = JSON.parse(pm.environment.get(\"assets.benchmarkQuery.response\"));\r",
									"console.log(assets);\r",
									"\r",
									"pm.test(`Response JSON is an array of length: ${jsonData.length}`, function () {\r",
									"    pm.expect(jsonData).to.have.lengthOf(assets.length);\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/packages/:packageId/stigs/:benchmarkId/assets?projection=reviewers&elevate={{elevated}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"packages",
								":packageId",
								"stigs",
								":benchmarkId",
								"assets"
							],
							"query": [
								{
									"key": "projection",
									"value": "reviewers",
									"description": "Additional properties to include in the response.\n"
								},
								{
									"key": "elevate",
									"value": "{{elevated}}",
									"description": "Elevate the user context for this request if user is permitted (canAdmin)"
								}
							],
							"variable": [
								{
									"key": "packageId",
									"value": "{{testPackage}}"
								},
								{
									"description": "(Required) A path parameter that indentifies a STIG",
									"key": "benchmarkId",
									"type": "string",
									"value": "{{assets.queryBenchmark}}"
								}
							]
						}
					},
					"response": [
						{
							"name": "unexpected error",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/stigs/:benchmarkId/assets?elevate=<boolean>&projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"stigs",
										":benchmarkId",
										"assets"
									],
									"query": [
										{
											"key": "elevate",
											"value": "<boolean>"
										},
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									],
									"variable": [
										{
											"key": "benchmarkId"
										}
									]
								}
							},
							"status": "Internal Server Error",
							"code": 500,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
						},
						{
							"name": "Revision response",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/stigs/:benchmarkId/assets?elevate=<boolean>&projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"stigs",
										":benchmarkId",
										"assets"
									],
									"query": [
										{
											"key": "elevate",
											"value": "<boolean>"
										},
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									],
									"variable": [
										{
											"key": "benchmarkId"
										}
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "[\n {\n  \"assetId\": \"<integer>\",\n  \"name\": \"<string>\",\n  \"reviewers\": [\n   {\n    \"userId\": \"<integer>\",\n    \"username\": \"<string>\"\n   },\n   {\n    \"userId\": \"<integer>\",\n    \"username\": \"<string>\"\n   }\n  ]\n },\n {\n  \"assetId\": \"<integer>\",\n  \"name\": \"<string>\",\n  \"reviewers\": [\n   {\n    \"userId\": \"<integer>\",\n    \"username\": \"<string>\"\n   },\n   {\n    \"userId\": \"<integer>\",\n    \"username\": \"<string>\"\n   }\n  ]\n }\n]"
						}
					]
				},
				{
					"name": "Assign stig to specified assets (Invalid assets)",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "a339fabb-924d-4475-9f32-96433c15007f",
								"exec": [
									"    pm.test(\"Status should be is 403. Attempting to assign invalid reviewers.\", function () {\r",
									"        pm.response.to.have.status(403);\r",
									"    });"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "[\n  \"30\"\n]",
							"options": {
								"raw": {}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/packages/:packageId/stigs/:benchmarkId/assets?projection=reviewers&elevate={{elevated}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"packages",
								":packageId",
								"stigs",
								":benchmarkId",
								"assets"
							],
							"query": [
								{
									"key": "projection",
									"value": "reviewers",
									"description": "Additional properties to include in the response.\n"
								},
								{
									"key": "elevate",
									"value": "{{elevated}}",
									"description": "Elevate the user context for this request if user is permitted (canAdmin)"
								}
							],
							"variable": [
								{
									"key": "packageId",
									"value": "1"
								},
								{
									"description": "(Required) A path parameter that indentifies a STIG",
									"key": "benchmarkId",
									"type": "string",
									"value": "{{assets.queryBenchmark}}"
								}
							]
						},
						"description": "Invoking this endpoint will retain any previously configured Reviewer assignments"
					},
					"response": [
						{
							"name": "Revision response",
							"originalRequest": {
								"method": "PUT",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "[\n    \"<integer>\",\n    \"<integer>\"\n]"
								},
								"url": {
									"raw": "{{baseUrl}}/stigs/:benchmarkId/assets?elevate=<boolean>&projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"stigs",
										":benchmarkId",
										"assets"
									],
									"query": [
										{
											"key": "elevate",
											"value": "<boolean>"
										},
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									],
									"variable": [
										{
											"key": "benchmarkId"
										}
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "[\n {\n  \"assetId\": \"<integer>\",\n  \"name\": \"<string>\",\n  \"reviewers\": [\n   {\n    \"userId\": \"<integer>\",\n    \"username\": \"<string>\"\n   },\n   {\n    \"userId\": \"<integer>\",\n    \"username\": \"<string>\"\n   }\n  ]\n },\n {\n  \"assetId\": \"<integer>\",\n  \"name\": \"<string>\",\n  \"reviewers\": [\n   {\n    \"userId\": \"<integer>\",\n    \"username\": \"<string>\"\n   },\n   {\n    \"userId\": \"<integer>\",\n    \"username\": \"<string>\"\n   }\n  ]\n }\n]"
						},
						{
							"name": "unexpected error",
							"originalRequest": {
								"method": "PUT",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "[\n    \"<integer>\",\n    \"<integer>\"\n]"
								},
								"url": {
									"raw": "{{baseUrl}}/stigs/:benchmarkId/assets?elevate=<boolean>&projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"stigs",
										":benchmarkId",
										"assets"
									],
									"query": [
										{
											"key": "elevate",
											"value": "<boolean>"
										},
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									],
									"variable": [
										{
											"key": "benchmarkId"
										}
									]
								}
							},
							"status": "Internal Server Error",
							"code": 500,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
						}
					]
				},
				{
					"name": "Assign stig to specified assets (actual Assets)",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "142fcf8d-b0a4-4ca9-8079-c7d47b285374",
								"exec": [
									"let user = pm.environment.get(\"user\");\r",
									"console.log(\"user: \" + user);\r",
									"if (user == \"wf10\") {\r",
									"    pm.test(\"Status should be is 403 for user wf10\", function () {\r",
									"        pm.response.to.have.status(403);\r",
									"    });\r",
									"    return;\r",
									"}\r",
									"\r",
									"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
									"    user = \"elevated\";\r",
									"    console.log(\"user is elevated\");\r",
									"\r",
									"}\r",
									"\r",
									"var stuff = pm.request.auth;\r",
									"var stuff = pm.request;\r",
									"\r",
									"if (user == 'elevated' || user == 'staff' || user == \"officer60\") {\r",
									"    pm.test(\"User is elevated. Status code is 200\", function () {\r",
									"        pm.response.to.have.status(200);\r",
									"    });\r",
									"}\r",
									"else {\r",
									"    pm.test(\"User is not Staff, IAO (w/ proper dept) or elevated. Expected status code is 403\", function () {\r",
									"        pm.response.to.have.status(403);\r",
									"    });\r",
									"    return;\r",
									"}\r",
									"\r",
									"if (pm.response.code == 500) {\r",
									"    console.log(\"Server returned 500\")\r",
									"    return;\r",
									"}\r",
									"\r",
									"var jsonData = pm.response.json();\r",
									"\r",
									"\r",
									"\r",
									"pm.test(\"Response JSON is an\", function () {\r",
									"    pm.expect(jsonData).to.be.an('array');\r",
									"});\r",
									"\r",
									"\r",
									"\r",
									"\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "[\n   \"42\",\"62\",\"29\"\n]",
							"options": {
								"raw": {}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/packages/:packageId/stigs/:benchmarkId/assets?projection=reviewers&elevate={{elevated}}",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"packages",
								":packageId",
								"stigs",
								":benchmarkId",
								"assets"
							],
							"query": [
								{
									"key": "projection",
									"value": "reviewers",
									"description": "Additional properties to include in the response.\n"
								},
								{
									"key": "elevate",
									"value": "{{elevated}}",
									"description": "Elevate the user context for this request if user is permitted (canAdmin)"
								}
							],
							"variable": [
								{
									"key": "packageId",
									"value": "1"
								},
								{
									"description": "(Required) A path parameter that indentifies a STIG",
									"key": "benchmarkId",
									"type": "string",
									"value": "{{assets.queryBenchmark}}"
								}
							]
						},
						"description": "Invoking this endpoint will retain any previously configured Reviewer assignments"
					},
					"response": [
						{
							"name": "Revision response",
							"originalRequest": {
								"method": "PUT",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "[\n    \"<integer>\",\n    \"<integer>\"\n]"
								},
								"url": {
									"raw": "{{baseUrl}}/stigs/:benchmarkId/assets?elevate=<boolean>&projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"stigs",
										":benchmarkId",
										"assets"
									],
									"query": [
										{
											"key": "elevate",
											"value": "<boolean>"
										},
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									],
									"variable": [
										{
											"key": "benchmarkId"
										}
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "[\n {\n  \"assetId\": \"<integer>\",\n  \"name\": \"<string>\",\n  \"reviewers\": [\n   {\n    \"userId\": \"<integer>\",\n    \"username\": \"<string>\"\n   },\n   {\n    \"userId\": \"<integer>\",\n    \"username\": \"<string>\"\n   }\n  ]\n },\n {\n  \"assetId\": \"<integer>\",\n  \"name\": \"<string>\",\n  \"reviewers\": [\n   {\n    \"userId\": \"<integer>\",\n    \"username\": \"<string>\"\n   },\n   {\n    \"userId\": \"<integer>\",\n    \"username\": \"<string>\"\n   }\n  ]\n }\n]"
						},
						{
							"name": "unexpected error",
							"originalRequest": {
								"method": "PUT",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "[\n    \"<integer>\",\n    \"<integer>\"\n]"
								},
								"url": {
									"raw": "{{baseUrl}}/stigs/:benchmarkId/assets?elevate=<boolean>&projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"stigs",
										":benchmarkId",
										"assets"
									],
									"query": [
										{
											"key": "elevate",
											"value": "<boolean>"
										},
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									],
									"variable": [
										{
											"key": "benchmarkId"
										}
									]
								}
							},
							"status": "Internal Server Error",
							"code": 500,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
						}
					]
				}
			],
			"protocolProfileBehavior": {}
		},
		{
			"name": "WIP - Review Tests",
			"item": [
				{
					"name": "GET - Reviews - param permutations",
					"item": [
						{
							"name": "get - reviews - all Params",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/reviews?result={{rev.result}}&action={{rev.action}}&status={{rev.status}}&ruleId={{rev.rule}}&userId={{rev.user}}&assetId={{rev.asset}}&benchmarkId={{rev.benchmark}}&revisionStr={{rev.revStr}}&packageId={{rev.package}}&projection=ruleInfo&projection=stigs&projection=packages&projection=history",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"reviews"
									],
									"query": [
										{
											"key": "result",
											"value": "{{rev.result}}"
										},
										{
											"key": "action",
											"value": "{{rev.action}}"
										},
										{
											"key": "status",
											"value": "{{rev.status}}"
										},
										{
											"key": "ruleId",
											"value": "{{rev.rule}}",
											"description": "Selects Reviews of a Rule"
										},
										{
											"key": "userId",
											"value": "{{rev.user}}"
										},
										{
											"key": "assetId",
											"value": "{{rev.asset}}",
											"description": "Selects Reviews mapped to an Asset"
										},
										{
											"key": "benchmarkId",
											"value": "{{rev.benchmark}}",
											"description": "Selects Reviews mapped to a STIG"
										},
										{
											"key": "revisionStr",
											"value": "{{rev.revStr}}"
										},
										{
											"key": "packageId",
											"value": "{{rev.package}}"
										},
										{
											"key": "projection",
											"value": "ruleInfo",
											"description": "Selects Reviews mapped to a Package"
										},
										{
											"key": "projection",
											"value": "stigs",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "packages",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "history"
										}
									]
								}
							},
							"response": [
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/reviews?elevate=<boolean>&state=<string>&action=<string>&status=<string>&ruleId=<string>&benchmarkId=<string>&assetId=<string>&packageId=<integer>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"reviews"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "state",
													"value": "<string>"
												},
												{
													"key": "action",
													"value": "<string>"
												},
												{
													"key": "status",
													"value": "<string>"
												},
												{
													"key": "ruleId",
													"value": "<string>"
												},
												{
													"key": "benchmarkId",
													"value": "<string>"
												},
												{
													"key": "assetId",
													"value": "<string>"
												},
												{
													"key": "packageId",
													"value": "<integer>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								},
								{
									"name": "ReviewProjected response",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/reviews?elevate=<boolean>&state=<string>&action=<string>&status=<string>&ruleId=<string>&benchmarkId=<string>&assetId=<string>&packageId=<integer>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"reviews"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "state",
													"value": "<string>"
												},
												{
													"key": "action",
													"value": "<string>"
												},
												{
													"key": "status",
													"value": "<string>"
												},
												{
													"key": "ruleId",
													"value": "<string>"
												},
												{
													"key": "benchmarkId",
													"value": "<string>"
												},
												{
													"key": "assetId",
													"value": "<string>"
												},
												{
													"key": "packageId",
													"value": "<integer>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "[\n {\n  \"reviewId\": \"<integer>\",\n  \"assetId\": \"<integer>\",\n  \"ruleId\": \"<string>\",\n  \"state\": \"<string>\",\n  \"stateComment\": \"<string>\",\n  \"autoState\": \"<boolean>\",\n  \"action\": \"<string>\",\n  \"actionComment\": \"<string>\",\n  \"reqDoc\": \"<boolean>\",\n  \"status\": \"<string>\",\n  \"userId\": \"<integer>\",\n  \"ts\": \"<string>\",\n  \"rejectText\": \"<string>\",\n  \"rejectUserId\": \"<integer>\",\n  \"history\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"asset\": {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  },\n  \"stigs\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"rule\": {\n   \"ruleId\": \"<string>\",\n   \"version\": \"<string>\",\n   \"title\": \"<string>\",\n   \"severity\": \"<string>\"\n  }\n },\n {\n  \"reviewId\": \"<integer>\",\n  \"assetId\": \"<integer>\",\n  \"ruleId\": \"<string>\",\n  \"state\": \"<string>\",\n  \"stateComment\": \"<string>\",\n  \"autoState\": \"<boolean>\",\n  \"action\": \"<string>\",\n  \"actionComment\": \"<string>\",\n  \"reqDoc\": \"<boolean>\",\n  \"status\": \"<string>\",\n  \"userId\": \"<integer>\",\n  \"ts\": \"<string>\",\n  \"rejectText\": \"<string>\",\n  \"rejectUserId\": \"<integer>\",\n  \"history\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"asset\": {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  },\n  \"stigs\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"rule\": {\n   \"ruleId\": \"<string>\",\n   \"version\": \"<string>\",\n   \"title\": \"<string>\",\n   \"severity\": \"<string>\"\n  }\n }\n]"
								}
							]
						},
						{
							"name": "get - reviews - all Params Copy",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "04fee2a1-a536-498a-9fac-e6afae09b887",
										"exec": [
											"let user = pm.environment.get(\"user\");\r",
											"console.log(\"user: \" + user);\r",
											"if (user == \"wf10\") {\r",
											"    pm.test(\"Status should be 403 for user wf10, elevated\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
											"    pm.test(\"Status should be 403 for all elevated Reviews queries\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;     \r",
											"}\r",
											"else {\r",
											"    pm.test(\"Status code is 200\", function () {\r",
											"        pm.response.to.have.status(200);\r",
											"    });\r",
											"}\r",
											"\r",
											"let jsonData = pm.response.json();\r",
											"\r",
											"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
											"    pm.test(\"Elevated queries not allowed for review endpoints.\", function () {\r",
											"        pm.expect(1).to.equal(2);\r",
											"    });\r",
											"return;    \r",
											"}\r",
											"\r",
											"// console.log(\"url: \" + pm.request.url.getQueryString().match(/elevate=true/));\r",
											"\r",
											"var stuff = pm.request.auth;\r",
											"var stuff = pm.request.url.query;\r",
											"\r",
											"\r",
											"\r",
											"let allowedPackages, disallowedPackages, validStigs, invalidStigs, validAssets, invalidAssets;\r",
											"console.log(\"assignments\");\r",
											"allowedPackages = JSON.parse(pm.environment.get((\"packages.valid\")));\r",
											"disallowedPackages = JSON.parse(pm.environment.get(\"packages.invalid\"));\r",
											"validStigs = JSON.parse(pm.environment.get(\"stigs.valid\"));\r",
											"invalidStigs = JSON.parse(pm.environment.get(\"stigs.invalid\"));\r",
											"validAssets = JSON.parse(pm.environment.get(\"assets.valid\"));\r",
											"invalidAssets = JSON.parse(pm.environment.get(\"assets.invalid\"));\r",
											"\r",
											"let assetsForPackageQuery,assetsForBenchmarkQuery,assetsForDeptQuery;\r",
											" assetsForPackageQuery = JSON.parse(pm.environment.get(\"assets.packageQuery.response\"));\r",
											" assetsForBenchmarkQuery = JSON.parse(pm.environment.get(\"assets.benchmarkQuery.response\"));\r",
											" assetsForDeptQuery = JSON.parse(pm.environment.get(\"assets.deptQuery.response\"));\r",
											"\r",
											"\r",
											"console.log(\"user is \" + user);\r",
											"\r",
											"pm.test(\"Response JSON is an array\", function () {\r",
											"    pm.expect(jsonData).to.be.an('array');\r",
											"});\r",
											"\r",
											"let packageIds = [];\r",
											"let assetIds = [];\r",
											"let stigIds = [];\r",
											"let stigReviewers = [];\r",
											"let adminStats = [];\r",
											"\r",
											"\r",
											"pm.test(\"Each item in response has proper properties\", function () {\r",
											"    jsonData.forEach(function (review) {\r",
											"        pm.expect(review).to.have.property('assetId');\r",
											"        assetIds.push(review.assetId);\r",
											"        // console.log (item.assets);\r",
											"        // let assets = [];\r",
											"        // assets = item.assets;\r",
											"        // console.log (assets);\r",
											"        review.packages.forEach(function (package) {\r",
											"            pm.expect(package).to.have.property('packageId');\r",
											"            packageIds.push(package.packageId);\r",
											"        });\r",
											"\r",
											"        review.stigs.forEach(function (stig) {\r",
											"            pm.expect(stig).to.have.property('benchmarkId');\r",
											"            stigIds.push(stig.benchmarkId);\r",
											"        });\r",
											"\r",
											"        review.packages.forEach(function (package) {\r",
											"            pm.expect(package).to.have.property('packageId');\r",
											"            stigIds.push(package.packageId);\r",
											"        });\r",
											"    \r",
											"\r",
											"        pm.expect(review.ruleInfo).to.have.property('ruleId');\r",
											"        pm.expect(review.ruleInfo).to.have.property('ruleTitle');         \r",
											"    });\r",
											"\r",
											"    //     pm.expect(packageIds).to.include.members(allowedPackages);\r",
											"});\r",
											"\r",
											"// console.log(\"packageIds = \" + packageIds);\r",
											"\r",
											"\r",
											"\r",
											"let packageQuery, benchmarkQuery, deptQuery = 0;\r",
											"\r",
											"pm.test(\"Response does contains correct assets for this user\", function () {\r",
											"\r",
											"    if (pm.request.url.getQueryString().match(/result=/)) {\r",
											"        packageQuery = 1;\r",
											"        assetIds.forEach(function (asset) {\r",
											"            console.log(\"checking package query assetId: \" + asset);\r",
											"            pm.expect(asset).to.be.oneOf(assetsForPackageQuery);\r",
											"        });\r",
											"    }\r",
											"    \r",
											"//or....\r",
											"    if (pm.request.url.getQueryString().match(/result=/)) {\r",
											"        packageQuery = 1;\r",
											"        assetIds.forEach(function (asset) {\r",
											"            console.log(\"checking package query assetId: \" + asset);\r",
											"            pm.expect(asset).to.be.oneOf(assetsForPackageQuery);\r",
											"        });\r",
											"    }\r",
											"\r",
											"    if (pm.request.url.getQueryString().match(/benchmarkId=/)) {\r",
											"        benchmarkQuery = 1;\r",
											"        assetIds.forEach(function (asset) {\r",
											"            console.log(\"checking benchmark query assetId: \" + asset);\r",
											"            pm.expect(asset).to.be.oneOf(assetsForBenchmarkQuery);\r",
											"        });        \r",
											"    }\r",
											"\r",
											"    if (pm.request.url.getQueryString().match(/deptId=/)) {\r",
											"        deptQuery = 1;\r",
											"        assetIds.forEach(function (asset) {\r",
											"            console.log(\"checking dept query assetId: \" + asset);\r",
											"            pm.expect(asset).to.be.oneOf(assetsForDeptQuery);\r",
											"        });        \r",
											"    }\r",
											"\r",
											"});\r",
											"\r",
											"\r",
											"pm.test(\"Response contains authorized packageIds for this user\", function () {\r",
											"    packageIds.forEach(function (item) {\r",
											"        console.log(\"checking packageId: \" + item);\r",
											"        pm.expect(item).to.be.oneOf(allowedPackages);\r",
											"    });\r",
											"});\r",
											"\r",
											"\r",
											"pm.test(\"Response does NOT contain unAuthorized packageIds for this user\", function () {\r",
											"    packageIds.forEach(function (item) {\r",
											"        pm.expect(item).to.not.be.oneOf(disallowedPackages);\r",
											"    });\r",
											"\r",
											"\r",
											"});\r",
											"\r",
											"\r",
											"// if (user == \"wf60\" || user == \"officer60\") {\r",
											"//     pm.test(\"Response contains authorized projection data (assets)\", function () {\r",
											"//         assetIds.forEach(function (assetId) {\r",
											"//             pm.expect(assetId).to.be.oneOf(validAssets);\r",
											"//             console.log(\"checking assetId: \" + assetId);\r",
											"//         });\r",
											"//     });\r",
											"\r",
											"//     pm.test(\"Response contains authorized projection data (stigs)\", function () {\r",
											"//         stigIds.forEach(function (stigId) {\r",
											"//             pm.expect(stigId).to.be.oneOf(validStigs);\r",
											"//             console.log(\"checking stigId: \" + stigId);\r",
											"//         });\r",
											"//     });\r",
											"// }\r",
											"\r",
											"\r",
											"\r",
											"\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/reviews?action={{rev.action}}&benchmarkId={{rev.benchmark}}&projection=rule&projection=stigs&projection=asset",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"reviews"
									],
									"query": [
										{
											"key": "result",
											"value": "{{rev.result}}",
											"disabled": true
										},
										{
											"key": "action",
											"value": "{{rev.action}}"
										},
										{
											"key": "status",
											"value": "{{rev.status}}",
											"disabled": true
										},
										{
											"key": "ruleId",
											"value": "{{rev.rule}}",
											"description": "Selects Reviews of a Rule",
											"disabled": true
										},
										{
											"key": "userId",
											"value": "{{rev.user}}",
											"disabled": true
										},
										{
											"key": "assetId",
											"value": "{{rev.asset}}",
											"description": "Selects Reviews mapped to an Asset",
											"disabled": true
										},
										{
											"key": "benchmarkId",
											"value": "{{rev.benchmark}}",
											"description": "Selects Reviews mapped to a STIG"
										},
										{
											"key": "revisionStr",
											"value": "{{rev.revStr}}",
											"disabled": true
										},
										{
											"key": "packageId",
											"value": "{{rev.package}}",
											"disabled": true
										},
										{
											"key": "projection",
											"value": "rule",
											"description": "Selects Reviews mapped to a Package"
										},
										{
											"key": "projection",
											"value": "stigs",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "asset",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "history",
											"disabled": true
										}
									]
								}
							},
							"response": [
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/reviews?elevate=<boolean>&state=<string>&action=<string>&status=<string>&ruleId=<string>&benchmarkId=<string>&assetId=<string>&packageId=<integer>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"reviews"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "state",
													"value": "<string>"
												},
												{
													"key": "action",
													"value": "<string>"
												},
												{
													"key": "status",
													"value": "<string>"
												},
												{
													"key": "ruleId",
													"value": "<string>"
												},
												{
													"key": "benchmarkId",
													"value": "<string>"
												},
												{
													"key": "assetId",
													"value": "<string>"
												},
												{
													"key": "packageId",
													"value": "<integer>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								},
								{
									"name": "ReviewProjected response",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/reviews?elevate=<boolean>&state=<string>&action=<string>&status=<string>&ruleId=<string>&benchmarkId=<string>&assetId=<string>&packageId=<integer>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"reviews"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "state",
													"value": "<string>"
												},
												{
													"key": "action",
													"value": "<string>"
												},
												{
													"key": "status",
													"value": "<string>"
												},
												{
													"key": "ruleId",
													"value": "<string>"
												},
												{
													"key": "benchmarkId",
													"value": "<string>"
												},
												{
													"key": "assetId",
													"value": "<string>"
												},
												{
													"key": "packageId",
													"value": "<integer>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "[\n {\n  \"reviewId\": \"<integer>\",\n  \"assetId\": \"<integer>\",\n  \"ruleId\": \"<string>\",\n  \"state\": \"<string>\",\n  \"stateComment\": \"<string>\",\n  \"autoState\": \"<boolean>\",\n  \"action\": \"<string>\",\n  \"actionComment\": \"<string>\",\n  \"reqDoc\": \"<boolean>\",\n  \"status\": \"<string>\",\n  \"userId\": \"<integer>\",\n  \"ts\": \"<string>\",\n  \"rejectText\": \"<string>\",\n  \"rejectUserId\": \"<integer>\",\n  \"history\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"asset\": {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  },\n  \"stigs\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"rule\": {\n   \"ruleId\": \"<string>\",\n   \"version\": \"<string>\",\n   \"title\": \"<string>\",\n   \"severity\": \"<string>\"\n  }\n },\n {\n  \"reviewId\": \"<integer>\",\n  \"assetId\": \"<integer>\",\n  \"ruleId\": \"<string>\",\n  \"state\": \"<string>\",\n  \"stateComment\": \"<string>\",\n  \"autoState\": \"<boolean>\",\n  \"action\": \"<string>\",\n  \"actionComment\": \"<string>\",\n  \"reqDoc\": \"<boolean>\",\n  \"status\": \"<string>\",\n  \"userId\": \"<integer>\",\n  \"ts\": \"<string>\",\n  \"rejectText\": \"<string>\",\n  \"rejectUserId\": \"<integer>\",\n  \"history\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"asset\": {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  },\n  \"stigs\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"rule\": {\n   \"ruleId\": \"<string>\",\n   \"version\": \"<string>\",\n   \"title\": \"<string>\",\n   \"severity\": \"<string>\"\n  }\n }\n]"
								}
							]
						},
						{
							"name": "get - reviews - all Params Copy Copy",
							"event": [
								{
									"listen": "test",
									"script": {
										"id": "6f3ce16a-9483-43df-aec3-c03b347ce1da",
										"exec": [
											"let user = pm.environment.get(\"user\");\r",
											"console.log(\"user: \" + user);\r",
											"if (user == \"wf10\") {\r",
											"    pm.test(\"Status should be 403 for user wf10, elevated\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;\r",
											"}\r",
											"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
											"    pm.test(\"Status should be 403 for all elevated Reviews queries\", function () {\r",
											"        pm.response.to.have.status(403);\r",
											"    });\r",
											"    return;     \r",
											"}\r",
											"else {\r",
											"    pm.test(\"Status code is 200\", function () {\r",
											"        pm.response.to.have.status(200);\r",
											"    });\r",
											"}\r",
											"\r",
											"let jsonData = pm.response.json();\r",
											"\r",
											"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
											"    pm.test(\"Elevated queries not allowed for review endpoints.\", function () {\r",
											"        pm.expect(1).to.equal(2);\r",
											"    });\r",
											"return;    \r",
											"}\r",
											"\r",
											"// console.log(\"url: \" + pm.request.url.getQueryString().match(/elevate=true/));\r",
											"\r",
											"var stuff = pm.request.auth;\r",
											"var stuff = pm.request.url.query;\r",
											"\r",
											"\r",
											"\r",
											"let allowedPackages, disallowedPackages, validStigs, invalidStigs, validAssets, invalidAssets;\r",
											"console.log(\"assignments\");\r",
											"allowedPackages = JSON.parse(pm.environment.get((\"packages.valid\")));\r",
											"disallowedPackages = JSON.parse(pm.environment.get(\"packages.invalid\"));\r",
											"validStigs = JSON.parse(pm.environment.get(\"stigs.valid\"));\r",
											"invalidStigs = JSON.parse(pm.environment.get(\"stigs.invalid\"));\r",
											"validAssets = JSON.parse(pm.environment.get(\"assets.valid\"));\r",
											"invalidAssets = JSON.parse(pm.environment.get(\"assets.invalid\"));\r",
											"\r",
											"let assetsForPackageQuery,assetsForBenchmarkQuery,assetsForDeptQuery;\r",
											" assetsForPackageQuery = JSON.parse(pm.environment.get(\"assets.packageQuery.response\"));\r",
											" assetsForBenchmarkQuery = JSON.parse(pm.environment.get(\"assets.benchmarkQuery.response\"));\r",
											" assetsForDeptQuery = JSON.parse(pm.environment.get(\"assets.deptQuery.response\"));\r",
											"\r",
											"\r",
											"console.log(\"user is \" + user);\r",
											"\r",
											"pm.test(\"Response JSON is an array\", function () {\r",
											"    pm.expect(jsonData).to.be.an('array');\r",
											"});\r",
											"\r",
											"let packageIds = [];\r",
											"let assetIds = [];\r",
											"let stigIds = [];\r",
											"let stigReviewers = [];\r",
											"let adminStats = [];\r",
											"\r",
											"\r",
											"pm.test(\"Each item in response has proper properties\", function () {\r",
											"    jsonData.forEach(function (review) {\r",
											"        pm.expect(review).to.have.property('assetId');\r",
											"        assetIds.push(review.assetId);\r",
											"        // console.log (item.assets);\r",
											"        // let assets = [];\r",
											"        // assets = item.assets;\r",
											"        // console.log (assets);\r",
											"        review.packages.forEach(function (package) {\r",
											"            pm.expect(package).to.have.property('packageId');\r",
											"            packageIds.push(package.packageId);\r",
											"        });\r",
											"\r",
											"        review.stigs.forEach(function (stig) {\r",
											"            pm.expect(stig).to.have.property('benchmarkId');\r",
											"            stigIds.push(stig.benchmarkId);\r",
											"        });\r",
											"\r",
											"        review.packages.forEach(function (package) {\r",
											"            pm.expect(package).to.have.property('packageId');\r",
											"            stigIds.push(package.packageId);\r",
											"        });\r",
											"    \r",
											"\r",
											"        pm.expect(review.ruleInfo).to.have.property('ruleId');\r",
											"        pm.expect(review.ruleInfo).to.have.property('ruleTitle');         \r",
											"    });\r",
											"\r",
											"    //     pm.expect(packageIds).to.include.members(allowedPackages);\r",
											"});\r",
											"\r",
											"// console.log(\"packageIds = \" + packageIds);\r",
											"\r",
											"\r",
											"\r",
											"let packageQuery, benchmarkQuery, deptQuery = 0;\r",
											"\r",
											"pm.test(\"Response does contains correct assets for this user\", function () {\r",
											"\r",
											"    if (pm.request.url.getQueryString().match(/result=/)) {\r",
											"        packageQuery = 1;\r",
											"        assetIds.forEach(function (asset) {\r",
											"            console.log(\"checking package query assetId: \" + asset);\r",
											"            pm.expect(asset).to.be.oneOf(assetsForPackageQuery);\r",
											"        });\r",
											"    }\r",
											"    \r",
											"//or....\r",
											"    if (pm.request.url.getQueryString().match(/result=/)) {\r",
											"        packageQuery = 1;\r",
											"        assetIds.forEach(function (asset) {\r",
											"            console.log(\"checking package query assetId: \" + asset);\r",
											"            pm.expect(asset).to.be.oneOf(assetsForPackageQuery);\r",
											"        });\r",
											"    }\r",
											"\r",
											"    if (pm.request.url.getQueryString().match(/benchmarkId=/)) {\r",
											"        benchmarkQuery = 1;\r",
											"        assetIds.forEach(function (asset) {\r",
											"            console.log(\"checking benchmark query assetId: \" + asset);\r",
											"            pm.expect(asset).to.be.oneOf(assetsForBenchmarkQuery);\r",
											"        });        \r",
											"    }\r",
											"\r",
											"    if (pm.request.url.getQueryString().match(/deptId=/)) {\r",
											"        deptQuery = 1;\r",
											"        assetIds.forEach(function (asset) {\r",
											"            console.log(\"checking dept query assetId: \" + asset);\r",
											"            pm.expect(asset).to.be.oneOf(assetsForDeptQuery);\r",
											"        });        \r",
											"    }\r",
											"\r",
											"});\r",
											"\r",
											"\r",
											"pm.test(\"Response contains authorized packageIds for this user\", function () {\r",
											"    packageIds.forEach(function (item) {\r",
											"        console.log(\"checking packageId: \" + item);\r",
											"        pm.expect(item).to.be.oneOf(allowedPackages);\r",
											"    });\r",
											"});\r",
											"\r",
											"\r",
											"pm.test(\"Response does NOT contain unAuthorized packageIds for this user\", function () {\r",
											"    packageIds.forEach(function (item) {\r",
											"        pm.expect(item).to.not.be.oneOf(disallowedPackages);\r",
											"    });\r",
											"\r",
											"\r",
											"});\r",
											"\r",
											"\r",
											"// if (user == \"wf60\" || user == \"officer60\") {\r",
											"//     pm.test(\"Response contains authorized projection data (assets)\", function () {\r",
											"//         assetIds.forEach(function (assetId) {\r",
											"//             pm.expect(assetId).to.be.oneOf(validAssets);\r",
											"//             console.log(\"checking assetId: \" + assetId);\r",
											"//         });\r",
											"//     });\r",
											"\r",
											"//     pm.test(\"Response contains authorized projection data (stigs)\", function () {\r",
											"//         stigIds.forEach(function (stigId) {\r",
											"//             pm.expect(stigId).to.be.oneOf(validStigs);\r",
											"//             console.log(\"checking stigId: \" + stigId);\r",
											"//         });\r",
											"//     });\r",
											"// }\r",
											"\r",
											"\r",
											"\r",
											"\r",
											"\r",
											""
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/reviews?action={{rev.action}}&benchmarkId={{rev.benchmark}}&projection=rule&projection=stigs&projection=asset",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"reviews"
									],
									"query": [
										{
											"key": "result",
											"value": "{{rev.result}}",
											"disabled": true
										},
										{
											"key": "action",
											"value": "{{rev.action}}"
										},
										{
											"key": "status",
											"value": "{{rev.status}}",
											"disabled": true
										},
										{
											"key": "ruleId",
											"value": "{{rev.rule}}",
											"description": "Selects Reviews of a Rule",
											"disabled": true
										},
										{
											"key": "userId",
											"value": "{{rev.user}}",
											"disabled": true
										},
										{
											"key": "assetId",
											"value": "{{rev.asset}}",
											"description": "Selects Reviews mapped to an Asset",
											"disabled": true
										},
										{
											"key": "benchmarkId",
											"value": "{{rev.benchmark}}",
											"description": "Selects Reviews mapped to a STIG"
										},
										{
											"key": "revisionStr",
											"value": "{{rev.revStr}}",
											"disabled": true
										},
										{
											"key": "packageId",
											"value": "{{rev.package}}",
											"disabled": true
										},
										{
											"key": "projection",
											"value": "rule",
											"description": "Selects Reviews mapped to a Package"
										},
										{
											"key": "projection",
											"value": "stigs",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "asset",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "history",
											"disabled": true
										}
									]
								}
							},
							"response": [
								{
									"name": "ReviewProjected response",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/reviews?elevate=<boolean>&state=<string>&action=<string>&status=<string>&ruleId=<string>&benchmarkId=<string>&assetId=<string>&packageId=<integer>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"reviews"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "state",
													"value": "<string>"
												},
												{
													"key": "action",
													"value": "<string>"
												},
												{
													"key": "status",
													"value": "<string>"
												},
												{
													"key": "ruleId",
													"value": "<string>"
												},
												{
													"key": "benchmarkId",
													"value": "<string>"
												},
												{
													"key": "assetId",
													"value": "<string>"
												},
												{
													"key": "packageId",
													"value": "<integer>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "[\n {\n  \"reviewId\": \"<integer>\",\n  \"assetId\": \"<integer>\",\n  \"ruleId\": \"<string>\",\n  \"state\": \"<string>\",\n  \"stateComment\": \"<string>\",\n  \"autoState\": \"<boolean>\",\n  \"action\": \"<string>\",\n  \"actionComment\": \"<string>\",\n  \"reqDoc\": \"<boolean>\",\n  \"status\": \"<string>\",\n  \"userId\": \"<integer>\",\n  \"ts\": \"<string>\",\n  \"rejectText\": \"<string>\",\n  \"rejectUserId\": \"<integer>\",\n  \"history\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"asset\": {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  },\n  \"stigs\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"rule\": {\n   \"ruleId\": \"<string>\",\n   \"version\": \"<string>\",\n   \"title\": \"<string>\",\n   \"severity\": \"<string>\"\n  }\n },\n {\n  \"reviewId\": \"<integer>\",\n  \"assetId\": \"<integer>\",\n  \"ruleId\": \"<string>\",\n  \"state\": \"<string>\",\n  \"stateComment\": \"<string>\",\n  \"autoState\": \"<boolean>\",\n  \"action\": \"<string>\",\n  \"actionComment\": \"<string>\",\n  \"reqDoc\": \"<boolean>\",\n  \"status\": \"<string>\",\n  \"userId\": \"<integer>\",\n  \"ts\": \"<string>\",\n  \"rejectText\": \"<string>\",\n  \"rejectUserId\": \"<integer>\",\n  \"history\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"asset\": {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  },\n  \"stigs\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"rule\": {\n   \"ruleId\": \"<string>\",\n   \"version\": \"<string>\",\n   \"title\": \"<string>\",\n   \"severity\": \"<string>\"\n  }\n }\n]"
								},
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/reviews?elevate=<boolean>&state=<string>&action=<string>&status=<string>&ruleId=<string>&benchmarkId=<string>&assetId=<string>&packageId=<integer>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"reviews"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "state",
													"value": "<string>"
												},
												{
													"key": "action",
													"value": "<string>"
												},
												{
													"key": "status",
													"value": "<string>"
												},
												{
													"key": "ruleId",
													"value": "<string>"
												},
												{
													"key": "benchmarkId",
													"value": "<string>"
												},
												{
													"key": "assetId",
													"value": "<string>"
												},
												{
													"key": "packageId",
													"value": "<integer>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								}
							]
						},
						{
							"name": "get - reviews - result",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/reviews?result=<string>&action=<string>&status=<string>&ruleId=<string>&userId&assetId=<string>&benchmarkId=<string>&revisionStr&packageId&projection=ruleInfo&projection=stigs&projection=packages",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"reviews"
									],
									"query": [
										{
											"key": "result",
											"value": "<string>"
										},
										{
											"key": "action",
											"value": "<string>"
										},
										{
											"key": "status",
											"value": "<string>"
										},
										{
											"key": "ruleId",
											"value": "<string>",
											"description": "Selects Reviews of a Rule"
										},
										{
											"key": "userId",
											"value": ""
										},
										{
											"key": "assetId",
											"value": "<string>",
											"description": "Selects Reviews mapped to an Asset"
										},
										{
											"key": "benchmarkId",
											"value": "<string>",
											"description": "Selects Reviews mapped to a STIG"
										},
										{
											"key": "revisionStr",
											"value": ""
										},
										{
											"key": "packageId",
											"value": ""
										},
										{
											"key": "projection",
											"value": "ruleInfo",
											"description": "Selects Reviews mapped to a Package"
										},
										{
											"key": "projection",
											"value": "stigs",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "packages",
											"description": "Additional properties to include in the response.\n"
										}
									]
								}
							},
							"response": [
								{
									"name": "ReviewProjected response",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/reviews?elevate=<boolean>&state=<string>&action=<string>&status=<string>&ruleId=<string>&benchmarkId=<string>&assetId=<string>&packageId=<integer>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"reviews"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "state",
													"value": "<string>"
												},
												{
													"key": "action",
													"value": "<string>"
												},
												{
													"key": "status",
													"value": "<string>"
												},
												{
													"key": "ruleId",
													"value": "<string>"
												},
												{
													"key": "benchmarkId",
													"value": "<string>"
												},
												{
													"key": "assetId",
													"value": "<string>"
												},
												{
													"key": "packageId",
													"value": "<integer>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "[\n {\n  \"reviewId\": \"<integer>\",\n  \"assetId\": \"<integer>\",\n  \"ruleId\": \"<string>\",\n  \"state\": \"<string>\",\n  \"stateComment\": \"<string>\",\n  \"autoState\": \"<boolean>\",\n  \"action\": \"<string>\",\n  \"actionComment\": \"<string>\",\n  \"reqDoc\": \"<boolean>\",\n  \"status\": \"<string>\",\n  \"userId\": \"<integer>\",\n  \"ts\": \"<string>\",\n  \"rejectText\": \"<string>\",\n  \"rejectUserId\": \"<integer>\",\n  \"history\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"asset\": {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  },\n  \"stigs\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"rule\": {\n   \"ruleId\": \"<string>\",\n   \"version\": \"<string>\",\n   \"title\": \"<string>\",\n   \"severity\": \"<string>\"\n  }\n },\n {\n  \"reviewId\": \"<integer>\",\n  \"assetId\": \"<integer>\",\n  \"ruleId\": \"<string>\",\n  \"state\": \"<string>\",\n  \"stateComment\": \"<string>\",\n  \"autoState\": \"<boolean>\",\n  \"action\": \"<string>\",\n  \"actionComment\": \"<string>\",\n  \"reqDoc\": \"<boolean>\",\n  \"status\": \"<string>\",\n  \"userId\": \"<integer>\",\n  \"ts\": \"<string>\",\n  \"rejectText\": \"<string>\",\n  \"rejectUserId\": \"<integer>\",\n  \"history\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"asset\": {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": \"<string>\"\n  },\n  \"stigs\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"rule\": {\n   \"ruleId\": \"<string>\",\n   \"version\": \"<string>\",\n   \"title\": \"<string>\",\n   \"severity\": \"<string>\"\n  }\n }\n]"
								},
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/reviews?elevate=<boolean>&state=<string>&action=<string>&status=<string>&ruleId=<string>&benchmarkId=<string>&assetId=<string>&packageId=<integer>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"reviews"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "state",
													"value": "<string>"
												},
												{
													"key": "action",
													"value": "<string>"
												},
												{
													"key": "status",
													"value": "<string>"
												},
												{
													"key": "ruleId",
													"value": "<string>"
												},
												{
													"key": "benchmarkId",
													"value": "<string>"
												},
												{
													"key": "assetId",
													"value": "<string>"
												},
												{
													"key": "packageId",
													"value": "<integer>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								}
							]
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "{asset Id}",
					"item": [
						{
							"name": "{rule Id}",
							"item": [
								{
									"name": "Return the Review for an Asset and Rule",
									"request": {
										"auth": {
											"type": "oauth2"
										},
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/reviews/:assetId/:ruleId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"reviews",
												":assetId",
												":ruleId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>",
													"description": "Elevate the user context for this request if user is permitted (canAdmin)"
												},
												{
													"key": "projection",
													"value": "<string>",
													"description": "Additional properties to include in the response.\n"
												},
												{
													"key": "projection",
													"value": "<string>",
													"description": "Additional properties to include in the response.\n"
												}
											],
											"variable": [
												{
													"description": "(Required) A path parameter that indentifies an Asset",
													"id": "a55b9081-800d-4032-8cb3-b3ac7650c817",
													"key": "assetId",
													"type": "string",
													"value": "<integer>"
												},
												{
													"description": "(Required) A path parameter that indentifies a Rule",
													"id": "bec30c63-535f-424b-8987-e4ca1f1270f6",
													"key": "ruleId",
													"type": "string",
													"value": "<string>"
												}
											]
										}
									},
									"response": [
										{
											"name": "ReviewProjected response",
											"originalRequest": {
												"method": "GET",
												"header": [],
												"url": {
													"raw": "{{baseUrl}}/reviews/:assetId/:ruleId?elevate=<boolean>&projection=<string>&projection=<string>",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"reviews",
														":assetId",
														":ruleId"
													],
													"query": [
														{
															"key": "elevate",
															"value": "<boolean>"
														},
														{
															"key": "projection",
															"value": "<string>"
														},
														{
															"key": "projection",
															"value": "<string>"
														}
													],
													"variable": [
														{
															"key": "assetId"
														},
														{
															"key": "ruleId"
														}
													]
												}
											},
											"status": "OK",
											"code": 200,
											"_postman_previewlanguage": "json",
											"header": [
												{
													"key": "Content-Type",
													"value": "application/json"
												}
											],
											"cookie": [],
											"body": "{\n \"reviewId\": \"<integer>\",\n \"assetId\": \"<integer>\",\n \"ruleId\": \"<string>\",\n \"state\": \"<string>\",\n \"stateComment\": \"<string>\",\n \"autoState\": \"<boolean>\",\n \"action\": \"<string>\",\n \"actionComment\": \"<string>\",\n \"reqDoc\": \"<boolean>\",\n \"status\": \"<string>\",\n \"userId\": \"<integer>\",\n \"ts\": \"<string>\",\n \"rejectText\": \"<string>\",\n \"rejectUserId\": \"<integer>\",\n \"history\": [\n  {\n   \"ts\": \"<string>\",\n   \"activityType\": \"<string>\",\n   \"columnName\": \"<string>\",\n   \"oldValue\": \"<string>\",\n   \"newValue\": \"<string>\",\n   \"userId\": \"<integer>\",\n   \"username\": \"<string>\"\n  },\n  {\n   \"ts\": \"<string>\",\n   \"activityType\": \"<string>\",\n   \"columnName\": \"<string>\",\n   \"oldValue\": \"<string>\",\n   \"newValue\": \"<string>\",\n   \"userId\": \"<integer>\",\n   \"username\": \"<string>\"\n  }\n ],\n \"asset\": {\n  \"assetId\": \"<integer>\",\n  \"name\": \"<string>\"\n },\n \"stigs\": [\n  \"<string>\",\n  \"<string>\"\n ],\n \"rule\": {\n  \"ruleId\": \"<string>\",\n  \"version\": \"<string>\",\n  \"title\": \"<string>\",\n  \"severity\": \"<string>\"\n }\n}"
										},
										{
											"name": "unexpected error",
											"originalRequest": {
												"method": "GET",
												"header": [],
												"url": {
													"raw": "{{baseUrl}}/reviews/:assetId/:ruleId?elevate=<boolean>&projection=<string>&projection=<string>",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"reviews",
														":assetId",
														":ruleId"
													],
													"query": [
														{
															"key": "elevate",
															"value": "<boolean>"
														},
														{
															"key": "projection",
															"value": "<string>"
														},
														{
															"key": "projection",
															"value": "<string>"
														}
													],
													"variable": [
														{
															"key": "assetId"
														},
														{
															"key": "ruleId"
														}
													]
												}
											},
											"status": "Internal Server Error",
											"code": 500,
											"_postman_previewlanguage": "json",
											"header": [
												{
													"key": "Content-Type",
													"value": "application/json"
												}
											],
											"cookie": [],
											"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
										}
									]
								},
								{
									"name": "Create or update a Review",
									"request": {
										"auth": {
											"type": "oauth2"
										},
										"method": "PUT",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"state\": \"<string>\",\n    \"stateComment\": \"<string>\",\n    \"action\": \"<string>\",\n    \"actionComment\": \"<string>\",\n    \"autoState\": \"<boolean>\",\n    \"status\": \"<string>\"\n}",
											"options": {
												"raw": {}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/reviews/:assetId/:ruleId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"reviews",
												":assetId",
												":ruleId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>",
													"description": "Elevate the user context for this request if user is permitted (canAdmin)"
												},
												{
													"key": "projection",
													"value": "<string>",
													"description": "Additional properties to include in the response.\n"
												},
												{
													"key": "projection",
													"value": "<string>",
													"description": "Additional properties to include in the response.\n"
												}
											],
											"variable": [
												{
													"description": "(Required) A path parameter that indentifies an Asset",
													"id": "3a076770-ed03-4e16-8f54-dafef67a1544",
													"key": "assetId",
													"type": "string",
													"value": "<integer>"
												},
												{
													"description": "(Required) A path parameter that indentifies a Rule",
													"id": "858cc759-e7f0-4055-8a01-2242cd7fe28c",
													"key": "ruleId",
													"type": "string",
													"value": "<string>"
												}
											]
										},
										"description": "Create a new Review, or update all properties of an existing Review, setting missing properties to null"
									},
									"response": [
										{
											"name": "unexpected error",
											"originalRequest": {
												"method": "PUT",
												"header": [],
												"body": {
													"mode": "raw",
													"raw": "{\n    \"state\": \"<string>\",\n    \"stateComment\": \"<string>\",\n    \"action\": \"<string>\",\n    \"actionComment\": \"<string>\",\n    \"autoState\": \"<boolean>\",\n    \"status\": \"<string>\"\n}"
												},
												"url": {
													"raw": "{{baseUrl}}/reviews/:assetId/:ruleId?elevate=<boolean>&projection=<string>&projection=<string>",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"reviews",
														":assetId",
														":ruleId"
													],
													"query": [
														{
															"key": "elevate",
															"value": "<boolean>"
														},
														{
															"key": "projection",
															"value": "<string>"
														},
														{
															"key": "projection",
															"value": "<string>"
														}
													],
													"variable": [
														{
															"key": "assetId"
														},
														{
															"key": "ruleId"
														}
													]
												}
											},
											"status": "Internal Server Error",
											"code": 500,
											"_postman_previewlanguage": "json",
											"header": [
												{
													"key": "Content-Type",
													"value": "application/json"
												}
											],
											"cookie": [],
											"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
										},
										{
											"name": "ReviewProjected response",
											"originalRequest": {
												"method": "PUT",
												"header": [],
												"body": {
													"mode": "raw",
													"raw": "{\n    \"state\": \"<string>\",\n    \"stateComment\": \"<string>\",\n    \"action\": \"<string>\",\n    \"actionComment\": \"<string>\",\n    \"autoState\": \"<boolean>\",\n    \"status\": \"<string>\"\n}"
												},
												"url": {
													"raw": "{{baseUrl}}/reviews/:assetId/:ruleId?elevate=<boolean>&projection=<string>&projection=<string>",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"reviews",
														":assetId",
														":ruleId"
													],
													"query": [
														{
															"key": "elevate",
															"value": "<boolean>"
														},
														{
															"key": "projection",
															"value": "<string>"
														},
														{
															"key": "projection",
															"value": "<string>"
														}
													],
													"variable": [
														{
															"key": "assetId"
														},
														{
															"key": "ruleId"
														}
													]
												}
											},
											"status": "OK",
											"code": 200,
											"_postman_previewlanguage": "json",
											"header": [
												{
													"key": "Content-Type",
													"value": "application/json"
												}
											],
											"cookie": [],
											"body": "{\n \"reviewId\": \"<integer>\",\n \"assetId\": \"<integer>\",\n \"ruleId\": \"<string>\",\n \"state\": \"<string>\",\n \"stateComment\": \"<string>\",\n \"autoState\": \"<boolean>\",\n \"action\": \"<string>\",\n \"actionComment\": \"<string>\",\n \"reqDoc\": \"<boolean>\",\n \"status\": \"<string>\",\n \"userId\": \"<integer>\",\n \"ts\": \"<string>\",\n \"rejectText\": \"<string>\",\n \"rejectUserId\": \"<integer>\",\n \"history\": [\n  {\n   \"ts\": \"<string>\",\n   \"activityType\": \"<string>\",\n   \"columnName\": \"<string>\",\n   \"oldValue\": \"<string>\",\n   \"newValue\": \"<string>\",\n   \"userId\": \"<integer>\",\n   \"username\": \"<string>\"\n  },\n  {\n   \"ts\": \"<string>\",\n   \"activityType\": \"<string>\",\n   \"columnName\": \"<string>\",\n   \"oldValue\": \"<string>\",\n   \"newValue\": \"<string>\",\n   \"userId\": \"<integer>\",\n   \"username\": \"<string>\"\n  }\n ],\n \"asset\": {\n  \"assetId\": \"<integer>\",\n  \"name\": \"<string>\"\n },\n \"stigs\": [\n  \"<string>\",\n  \"<string>\"\n ],\n \"rule\": {\n  \"ruleId\": \"<string>\",\n  \"version\": \"<string>\",\n  \"title\": \"<string>\",\n  \"severity\": \"<string>\"\n }\n}"
										}
									]
								},
								{
									"name": "Merge update a Review",
									"request": {
										"auth": {
											"type": "oauth2"
										},
										"method": "PATCH",
										"header": [
											{
												"key": "Content-Type",
												"value": "application/json"
											}
										],
										"body": {
											"mode": "raw",
											"raw": "{\n    \"state\": \"<string>\",\n    \"stateComment\": \"<string>\",\n    \"action\": \"<string>\",\n    \"actionComment\": \"<string>\",\n    \"autoState\": \"<boolean>\",\n    \"status\": \"<string>\"\n}",
											"options": {
												"raw": {}
											}
										},
										"url": {
											"raw": "{{baseUrl}}/reviews/:assetId/:ruleId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"reviews",
												":assetId",
												":ruleId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>",
													"description": "Elevate the user context for this request if user is permitted (canAdmin)"
												},
												{
													"key": "projection",
													"value": "<string>",
													"description": "Additional properties to include in the response.\n"
												},
												{
													"key": "projection",
													"value": "<string>",
													"description": "Additional properties to include in the response.\n"
												}
											],
											"variable": [
												{
													"description": "(Required) A path parameter that indentifies an Asset",
													"id": "28574e14-0e50-45eb-91f3-bd5e606ea763",
													"key": "assetId",
													"type": "string",
													"value": "<integer>"
												},
												{
													"description": "(Required) A path parameter that indentifies a Rule",
													"id": "09f9d417-5f67-49f6-ba24-281848652e59",
													"key": "ruleId",
													"type": "string",
													"value": "<string>"
												}
											]
										},
										"description": "Update the given properties of a Review, if it exists"
									},
									"response": [
										{
											"name": "ReviewProjected response",
											"originalRequest": {
												"method": "PATCH",
												"header": [],
												"body": {
													"mode": "raw",
													"raw": "{\n    \"state\": \"<string>\",\n    \"stateComment\": \"<string>\",\n    \"action\": \"<string>\",\n    \"actionComment\": \"<string>\",\n    \"autoState\": \"<boolean>\",\n    \"status\": \"<string>\"\n}"
												},
												"url": {
													"raw": "{{baseUrl}}/reviews/:assetId/:ruleId?elevate=<boolean>&projection=<string>&projection=<string>",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"reviews",
														":assetId",
														":ruleId"
													],
													"query": [
														{
															"key": "elevate",
															"value": "<boolean>"
														},
														{
															"key": "projection",
															"value": "<string>"
														},
														{
															"key": "projection",
															"value": "<string>"
														}
													],
													"variable": [
														{
															"key": "assetId"
														},
														{
															"key": "ruleId"
														}
													]
												}
											},
											"status": "OK",
											"code": 200,
											"_postman_previewlanguage": "json",
											"header": [
												{
													"key": "Content-Type",
													"value": "application/json"
												}
											],
											"cookie": [],
											"body": "{\n \"reviewId\": \"<integer>\",\n \"assetId\": \"<integer>\",\n \"ruleId\": \"<string>\",\n \"state\": \"<string>\",\n \"stateComment\": \"<string>\",\n \"autoState\": \"<boolean>\",\n \"action\": \"<string>\",\n \"actionComment\": \"<string>\",\n \"reqDoc\": \"<boolean>\",\n \"status\": \"<string>\",\n \"userId\": \"<integer>\",\n \"ts\": \"<string>\",\n \"rejectText\": \"<string>\",\n \"rejectUserId\": \"<integer>\",\n \"history\": [\n  {\n   \"ts\": \"<string>\",\n   \"activityType\": \"<string>\",\n   \"columnName\": \"<string>\",\n   \"oldValue\": \"<string>\",\n   \"newValue\": \"<string>\",\n   \"userId\": \"<integer>\",\n   \"username\": \"<string>\"\n  },\n  {\n   \"ts\": \"<string>\",\n   \"activityType\": \"<string>\",\n   \"columnName\": \"<string>\",\n   \"oldValue\": \"<string>\",\n   \"newValue\": \"<string>\",\n   \"userId\": \"<integer>\",\n   \"username\": \"<string>\"\n  }\n ],\n \"asset\": {\n  \"assetId\": \"<integer>\",\n  \"name\": \"<string>\"\n },\n \"stigs\": [\n  \"<string>\",\n  \"<string>\"\n ],\n \"rule\": {\n  \"ruleId\": \"<string>\",\n  \"version\": \"<string>\",\n  \"title\": \"<string>\",\n  \"severity\": \"<string>\"\n }\n}"
										},
										{
											"name": "unexpected error",
											"originalRequest": {
												"method": "PATCH",
												"header": [],
												"body": {
													"mode": "raw",
													"raw": "{\n    \"state\": \"<string>\",\n    \"stateComment\": \"<string>\",\n    \"action\": \"<string>\",\n    \"actionComment\": \"<string>\",\n    \"autoState\": \"<boolean>\",\n    \"status\": \"<string>\"\n}"
												},
												"url": {
													"raw": "{{baseUrl}}/reviews/:assetId/:ruleId?elevate=<boolean>&projection=<string>&projection=<string>",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"reviews",
														":assetId",
														":ruleId"
													],
													"query": [
														{
															"key": "elevate",
															"value": "<boolean>"
														},
														{
															"key": "projection",
															"value": "<string>"
														},
														{
															"key": "projection",
															"value": "<string>"
														}
													],
													"variable": [
														{
															"key": "assetId"
														},
														{
															"key": "ruleId"
														}
													]
												}
											},
											"status": "Internal Server Error",
											"code": 500,
											"_postman_previewlanguage": "json",
											"header": [
												{
													"key": "Content-Type",
													"value": "application/json"
												}
											],
											"cookie": [],
											"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
										}
									]
								},
								{
									"name": "Delete a Review",
									"request": {
										"auth": {
											"type": "oauth2"
										},
										"method": "DELETE",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/reviews/:assetId/:ruleId?elevate=<boolean>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"reviews",
												":assetId",
												":ruleId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>",
													"description": "Elevate the user context for this request if user is permitted (canAdmin)"
												},
												{
													"key": "projection",
													"value": "<string>",
													"description": "Additional properties to include in the response.\n"
												},
												{
													"key": "projection",
													"value": "<string>",
													"description": "Additional properties to include in the response.\n"
												}
											],
											"variable": [
												{
													"description": "(Required) A path parameter that indentifies an Asset",
													"id": "f7d9e5ca-9b55-415e-b5bb-5785c978cbb7",
													"key": "assetId",
													"type": "string",
													"value": "<integer>"
												},
												{
													"description": "(Required) A path parameter that indentifies a Rule",
													"id": "b1930828-2bb1-494e-887e-578041c9f923",
													"key": "ruleId",
													"type": "string",
													"value": "<string>"
												}
											]
										}
									},
									"response": [
										{
											"name": "unexpected error",
											"originalRequest": {
												"method": "DELETE",
												"header": [],
												"url": {
													"raw": "{{baseUrl}}/reviews/:assetId/:ruleId?elevate=<boolean>&projection=<string>&projection=<string>",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"reviews",
														":assetId",
														":ruleId"
													],
													"query": [
														{
															"key": "elevate",
															"value": "<boolean>"
														},
														{
															"key": "projection",
															"value": "<string>"
														},
														{
															"key": "projection",
															"value": "<string>"
														}
													],
													"variable": [
														{
															"key": "assetId"
														},
														{
															"key": "ruleId"
														}
													]
												}
											},
											"status": "Internal Server Error",
											"code": 500,
											"_postman_previewlanguage": "json",
											"header": [
												{
													"key": "Content-Type",
													"value": "application/json"
												}
											],
											"cookie": [],
											"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
										},
										{
											"name": "ReviewProjected response",
											"originalRequest": {
												"method": "DELETE",
												"header": [],
												"url": {
													"raw": "{{baseUrl}}/reviews/:assetId/:ruleId?elevate=<boolean>&projection=<string>&projection=<string>",
													"host": [
														"{{baseUrl}}"
													],
													"path": [
														"reviews",
														":assetId",
														":ruleId"
													],
													"query": [
														{
															"key": "elevate",
															"value": "<boolean>"
														},
														{
															"key": "projection",
															"value": "<string>"
														},
														{
															"key": "projection",
															"value": "<string>"
														}
													],
													"variable": [
														{
															"key": "assetId"
														},
														{
															"key": "ruleId"
														}
													]
												}
											},
											"status": "OK",
											"code": 200,
											"_postman_previewlanguage": "json",
											"header": [
												{
													"key": "Content-Type",
													"value": "application/json"
												}
											],
											"cookie": [],
											"body": "{\n \"reviewId\": \"<integer>\",\n \"assetId\": \"<integer>\",\n \"ruleId\": \"<string>\",\n \"state\": \"<string>\",\n \"stateComment\": \"<string>\",\n \"autoState\": \"<boolean>\",\n \"action\": \"<string>\",\n \"actionComment\": \"<string>\",\n \"reqDoc\": \"<boolean>\",\n \"status\": \"<string>\",\n \"userId\": \"<integer>\",\n \"ts\": \"<string>\",\n \"rejectText\": \"<string>\",\n \"rejectUserId\": \"<integer>\",\n \"history\": [\n  {\n   \"ts\": \"<string>\",\n   \"activityType\": \"<string>\",\n   \"columnName\": \"<string>\",\n   \"oldValue\": \"<string>\",\n   \"newValue\": \"<string>\",\n   \"userId\": \"<integer>\",\n   \"username\": \"<string>\"\n  },\n  {\n   \"ts\": \"<string>\",\n   \"activityType\": \"<string>\",\n   \"columnName\": \"<string>\",\n   \"oldValue\": \"<string>\",\n   \"newValue\": \"<string>\",\n   \"userId\": \"<integer>\",\n   \"username\": \"<string>\"\n  }\n ],\n \"asset\": {\n  \"assetId\": \"<integer>\",\n  \"name\": \"<string>\"\n },\n \"stigs\": [\n  \"<string>\",\n  \"<string>\"\n ],\n \"rule\": {\n  \"ruleId\": \"<string>\",\n  \"version\": \"<string>\",\n  \"title\": \"<string>\",\n  \"severity\": \"<string>\"\n }\n}"
										}
									]
								}
							],
							"protocolProfileBehavior": {},
							"_postman_isSubFolder": true
						},
						{
							"name": "Create or update one or more Reviews Copy",
							"request": {
								"auth": {
									"type": "oauth2"
								},
								"method": "PUT",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "[\n    {\n        \"state\": \"<string>\",\n        \"stateComment\": \"<string>\",\n        \"assetId\": \"<integer>\",\n        \"ruleId\": \"<string>\",\n        \"action\": \"<string>\",\n        \"actionComment\": \"<string>\",\n        \"autoState\": \"<boolean>\",\n        \"status\": \"<string>\"\n    },\n    {\n        \"state\": \"<string>\",\n        \"stateComment\": \"<string>\",\n        \"assetId\": \"<integer>\",\n        \"ruleId\": \"<string>\",\n        \"action\": \"<string>\",\n        \"actionComment\": \"<string>\",\n        \"autoState\": \"<boolean>\",\n        \"status\": \"<string>\"\n    }\n]",
									"options": {
										"raw": {}
									}
								},
								"url": {
									"raw": "{{baseUrl}}/reviews?elevate=<boolean>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"reviews"
									],
									"query": [
										{
											"key": "elevate",
											"value": "<boolean>",
											"description": "Elevate the user context for this request if user is permitted (canAdmin)"
										}
									]
								}
							},
							"response": [
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "PUT",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "[\n    {\n        \"state\": \"<string>\",\n        \"stateComment\": \"<string>\",\n        \"assetId\": \"<integer>\",\n        \"ruleId\": \"<string>\",\n        \"action\": \"<string>\",\n        \"actionComment\": \"<string>\",\n        \"autoState\": \"<boolean>\",\n        \"status\": \"<string>\"\n    },\n    {\n        \"state\": \"<string>\",\n        \"stateComment\": \"<string>\",\n        \"assetId\": \"<integer>\",\n        \"ruleId\": \"<string>\",\n        \"action\": \"<string>\",\n        \"actionComment\": \"<string>\",\n        \"autoState\": \"<boolean>\",\n        \"status\": \"<string>\"\n    }\n]"
										},
										"url": {
											"raw": "{{baseUrl}}/reviews?elevate=<boolean>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"reviews"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								},
								{
									"name": "ReviewProjected response",
									"originalRequest": {
										"method": "PUT",
										"header": [],
										"body": {
											"mode": "raw",
											"raw": "[\n    {\n        \"state\": \"<string>\",\n        \"stateComment\": \"<string>\",\n        \"assetId\": \"<integer>\",\n        \"ruleId\": \"<string>\",\n        \"action\": \"<string>\",\n        \"actionComment\": \"<string>\",\n        \"autoState\": \"<boolean>\",\n        \"status\": \"<string>\"\n    },\n    {\n        \"state\": \"<string>\",\n        \"stateComment\": \"<string>\",\n        \"assetId\": \"<integer>\",\n        \"ruleId\": \"<string>\",\n        \"action\": \"<string>\",\n        \"actionComment\": \"<string>\",\n        \"autoState\": \"<boolean>\",\n        \"status\": \"<string>\"\n    }\n]"
										},
										"url": {
											"raw": "{{baseUrl}}/reviews?elevate=<boolean>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"reviews"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"reviewId\": \"<integer>\",\n \"assetId\": \"<integer>\",\n \"ruleId\": \"<string>\",\n \"state\": \"<string>\",\n \"stateComment\": \"<string>\",\n \"autoState\": \"<boolean>\",\n \"action\": \"<string>\",\n \"actionComment\": \"<string>\",\n \"reqDoc\": \"<boolean>\",\n \"status\": \"<string>\",\n \"userId\": \"<integer>\",\n \"ts\": \"<string>\",\n \"rejectText\": \"<string>\",\n \"rejectUserId\": \"<integer>\",\n \"asset\": {\n  \"assetId\": \"<integer>\",\n  \"name\": \"<string>\"\n },\n \"stigs\": [\n  \"<string>\",\n  \"<string>\"\n ],\n \"rule\": {\n  \"ruleId\": \"<string>\",\n  \"version\": \"<string>\",\n  \"title\": \"<string>\",\n  \"severity\": \"<string>\"\n }\n}"
								}
							]
						},
						{
							"name": "Return a list of Reviews for an Asset",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/reviews/:assetId?elevate=<boolean>&state=<string>&action=<string>&status=<string>&benchmarkId=<string>&revisionStr=<string>&projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"reviews",
										":assetId"
									],
									"query": [
										{
											"key": "elevate",
											"value": "<boolean>",
											"description": "Elevate the user context for this request if user is permitted (canAdmin)"
										},
										{
											"key": "state",
											"value": "<string>"
										},
										{
											"key": "action",
											"value": "<string>"
										},
										{
											"key": "status",
											"value": "<string>"
										},
										{
											"key": "benchmarkId",
											"value": "<string>",
											"description": "Selects Reviews mapped to a STIG; requires revisionStr"
										},
										{
											"key": "revisionStr",
											"value": "<string>",
											"description": "Selects Reviews mapped to a Revision [ V{version_num}R{release_num} | 'latest' ]; requires benchmarkId"
										},
										{
											"key": "projection",
											"value": "<string>",
											"description": "Additional properties to include in the response.\n"
										},
										{
											"key": "projection",
											"value": "<string>",
											"description": "Additional properties to include in the response.\n"
										}
									],
									"variable": [
										{
											"description": "(Required) A path parameter that indentifies an Asset",
											"id": "67a15c79-1ccc-44d7-94fa-7789f5efdfa5",
											"key": "assetId",
											"type": "string",
											"value": "<integer>"
										}
									]
								}
							},
							"response": [
								{
									"name": "ReviewProjected response",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/reviews/:assetId?elevate=<boolean>&state=<string>&action=<string>&status=<string>&benchmarkId=<string>&revisionStr=<string>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"reviews",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "state",
													"value": "<string>"
												},
												{
													"key": "action",
													"value": "<string>"
												},
												{
													"key": "status",
													"value": "<string>"
												},
												{
													"key": "benchmarkId",
													"value": "<string>"
												},
												{
													"key": "revisionStr",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "OK",
									"code": 200,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "[\n {\n  \"reviewId\": \"<integer>\",\n  \"assetId\": \"<integer>\",\n  \"ruleId\": \"<string>\",\n  \"state\": \"<string>\",\n  \"stateComment\": \"<string>\",\n  \"autoState\": \"<boolean>\",\n  \"action\": \"<string>\",\n  \"actionComment\": \"<string>\",\n  \"reqDoc\": \"<boolean>\",\n  \"status\": \"<string>\",\n  \"userId\": \"<integer>\",\n  \"ts\": \"<string>\",\n  \"rejectText\": \"<string>\",\n  \"rejectUserId\": \"<integer>\",\n  \"asset\": {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\"\n  },\n  \"stigs\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"rule\": {\n   \"ruleId\": \"<string>\",\n   \"version\": \"<string>\",\n   \"title\": \"<string>\",\n   \"severity\": \"<string>\"\n  }\n },\n {\n  \"reviewId\": \"<integer>\",\n  \"assetId\": \"<integer>\",\n  \"ruleId\": \"<string>\",\n  \"state\": \"<string>\",\n  \"stateComment\": \"<string>\",\n  \"autoState\": \"<boolean>\",\n  \"action\": \"<string>\",\n  \"actionComment\": \"<string>\",\n  \"reqDoc\": \"<boolean>\",\n  \"status\": \"<string>\",\n  \"userId\": \"<integer>\",\n  \"ts\": \"<string>\",\n  \"rejectText\": \"<string>\",\n  \"rejectUserId\": \"<integer>\",\n  \"asset\": {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\"\n  },\n  \"stigs\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"rule\": {\n   \"ruleId\": \"<string>\",\n   \"version\": \"<string>\",\n   \"title\": \"<string>\",\n   \"severity\": \"<string>\"\n  }\n }\n]"
								},
								{
									"name": "unexpected error",
									"originalRequest": {
										"method": "GET",
										"header": [],
										"url": {
											"raw": "{{baseUrl}}/reviews/:assetId?elevate=<boolean>&state=<string>&action=<string>&status=<string>&benchmarkId=<string>&revisionStr=<string>&projection=<string>&projection=<string>",
											"host": [
												"{{baseUrl}}"
											],
											"path": [
												"reviews",
												":assetId"
											],
											"query": [
												{
													"key": "elevate",
													"value": "<boolean>"
												},
												{
													"key": "state",
													"value": "<string>"
												},
												{
													"key": "action",
													"value": "<string>"
												},
												{
													"key": "status",
													"value": "<string>"
												},
												{
													"key": "benchmarkId",
													"value": "<string>"
												},
												{
													"key": "revisionStr",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												},
												{
													"key": "projection",
													"value": "<string>"
												}
											],
											"variable": [
												{
													"key": "assetId"
												}
											]
										}
									},
									"status": "Internal Server Error",
									"code": 500,
									"_postman_previewlanguage": "json",
									"header": [
										{
											"key": "Content-Type",
											"value": "application/json"
										}
									],
									"cookie": [],
									"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
								}
							]
						},
						{
							"name": "test",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": ""
								}
							},
							"response": []
						}
					],
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "c80ab29a-3223-4083-a795-011638d8865d",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "4971ff99-3b90-4c39-9e69-777966b5708f",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						}
					],
					"protocolProfileBehavior": {},
					"_postman_isSubFolder": true
				},
				{
					"name": "Import one or more Reviews from a JSON body, a STIGViewer CKL file, or an SCC XCCDF file",
					"request": {
						"auth": {
							"type": "oauth2"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "multipart/form-data"
							}
						],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "importFile",
									"value": "<binary>",
									"description": "Extension .ckl from STIGVewer or .xml from SCAP Compliance Checker (SCC)"
								},
								{
									"key": "assetId",
									"value": "<string>",
									"description": "If provided, file contents will be checked for match"
								},
								{
									"key": "benchmarkId",
									"value": "<string>",
									"description": "If provided, file contents will be checked for match"
								}
							],
							"options": {
								"formdata": {}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/reviews",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"reviews"
							]
						},
						"description": "| RBAC | User Level 1 | User Level 2 | User Level 3 | elevated |\n|-----|-----|-------|-------|-------|\n|RequestBody| assetId: any<BR>ruleId: any|assetId: any departmental<BR>ruleId: any | assetId: any mapped asset<BR>ruleId: any ruleId from a mapped STIG on the asset |NA  |\n"
					},
					"response": [
						{
							"name": "ReviewProjected response",
							"originalRequest": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "formdata",
									"formdata": [
										{
											"key": "importFile",
											"value": "<binary>",
											"description": {
												"content": "Extension .ckl from STIGVewer or .xml from SCAP Compliance Checker (SCC)",
												"type": "text/plain"
											}
										},
										{
											"key": "assetId",
											"value": "<string>",
											"description": {
												"content": "If provided, file contents will be checked for match",
												"type": "text/plain"
											}
										},
										{
											"key": "benchmarkId",
											"value": "<string>",
											"description": {
												"content": "If provided, file contents will be checked for match",
												"type": "text/plain"
											}
										}
									]
								},
								"url": {
									"raw": "{{baseUrl}}/reviews",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"reviews"
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"assetId\": \"<integer>\",\n \"ruleId\": \"<string>\",\n \"result\": \"<string>\",\n \"resultComment\": \"<string>\",\n \"autoResult\": \"<boolean>\",\n \"action\": \"<string>\",\n \"actionComment\": \"<string>\",\n \"status\": \"<string>\",\n \"userId\": \"<integer>\",\n \"ts\": \"<string>\",\n \"rejectText\": \"<string>\",\n \"rejectUserId\": \"<integer>\",\n \"asset\": {\n  \"assetId\": \"<integer>\",\n  \"name\": \"<string>\",\n  \"dept\": {\n   \"deptId\": \"<integer>\",\n   \"name\": \"<string>\"\n  }\n },\n \"stigs\": [\n  \"<string>\",\n  \"<string>\"\n ],\n \"rule\": {\n  \"ruleId\": \"<string>\",\n  \"version\": \"<string>\",\n  \"title\": \"<string>\",\n  \"severity\": \"<string>\"\n }\n}"
						},
						{
							"name": "unexpected error",
							"originalRequest": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "formdata",
									"formdata": [
										{
											"key": "importFile",
											"value": "<binary>",
											"description": {
												"content": "Extension .ckl from STIGVewer or .xml from SCAP Compliance Checker (SCC)",
												"type": "text/plain"
											}
										},
										{
											"key": "assetId",
											"value": "<string>",
											"description": {
												"content": "If provided, file contents will be checked for match",
												"type": "text/plain"
											}
										},
										{
											"key": "benchmarkId",
											"value": "<string>",
											"description": {
												"content": "If provided, file contents will be checked for match",
												"type": "text/plain"
											}
										}
									]
								},
								"url": {
									"raw": "{{baseUrl}}/reviews",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"reviews"
									]
								}
							},
							"status": "Internal Server Error",
							"code": 500,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
						}
					]
				},
				{
					"name": "Return a list of Reviews accessible to the requester",
					"request": {
						"auth": {
							"type": "oauth2"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/reviews?result=<string>&action=<string>&status=<string>&ruleId=<string>&userId=<integer>&assetId=<integer>&benchmarkId=<string>&revisionStr=<string>&packageId=<integer>&projection=<string>&projection=<string>",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"reviews"
							],
							"query": [
								{
									"key": "result",
									"value": "<string>"
								},
								{
									"key": "action",
									"value": "<string>"
								},
								{
									"key": "status",
									"value": "<string>"
								},
								{
									"key": "ruleId",
									"value": "<string>",
									"description": "Selects Reviews of a Rule"
								},
								{
									"key": "userId",
									"value": "<integer>",
									"description": "Selects Reviews last saved by a User"
								},
								{
									"key": "assetId",
									"value": "<integer>",
									"description": "Selects Reviews mapped to an Asset"
								},
								{
									"key": "benchmarkId",
									"value": "<string>",
									"description": "Selects Reviews mapped to a STIG; requires revisionStr"
								},
								{
									"key": "revisionStr",
									"value": "<string>",
									"description": "Selects Reviews mapped to a Revision [ V{version_num}R{release_num} | 'latest' ]; requires benchmarkId"
								},
								{
									"key": "packageId",
									"value": "<integer>",
									"description": "Selects Reviews mapped to a Package"
								},
								{
									"key": "projection",
									"value": "<string>",
									"description": "Additional properties to include in the response.\n"
								},
								{
									"key": "projection",
									"value": "<string>",
									"description": "Additional properties to include in the response.\n"
								}
							]
						},
						"description": "| RBAC | User Level 1 | User Level 2 | User Level 3 | elevated |\n|-----|-----|-------|-------|-------|\n|Response| All reviews | All departmental reviews | All mapped reviews  | NA  |\n"
					},
					"response": [
						{
							"name": "unexpected error",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/reviews?result=<string>&action=<string>&status=<string>&ruleId=<string>&userId=<integer>&assetId=<integer>&benchmarkId=<string>&revisionStr=<string>&packageId=<integer>&projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"reviews"
									],
									"query": [
										{
											"key": "result",
											"value": "<string>"
										},
										{
											"key": "action",
											"value": "<string>"
										},
										{
											"key": "status",
											"value": "<string>"
										},
										{
											"key": "ruleId",
											"value": "<string>"
										},
										{
											"key": "userId",
											"value": "<integer>"
										},
										{
											"key": "assetId",
											"value": "<integer>"
										},
										{
											"key": "benchmarkId",
											"value": "<string>"
										},
										{
											"key": "revisionStr",
											"value": "<string>"
										},
										{
											"key": "packageId",
											"value": "<integer>"
										},
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									]
								}
							},
							"status": "Internal Server Error",
							"code": 500,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
						},
						{
							"name": "ReviewProjected response",
							"originalRequest": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/reviews?result=<string>&action=<string>&status=<string>&ruleId=<string>&userId=<integer>&assetId=<integer>&benchmarkId=<string>&revisionStr=<string>&packageId=<integer>&projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"reviews"
									],
									"query": [
										{
											"key": "result",
											"value": "<string>"
										},
										{
											"key": "action",
											"value": "<string>"
										},
										{
											"key": "status",
											"value": "<string>"
										},
										{
											"key": "ruleId",
											"value": "<string>"
										},
										{
											"key": "userId",
											"value": "<integer>"
										},
										{
											"key": "assetId",
											"value": "<integer>"
										},
										{
											"key": "benchmarkId",
											"value": "<string>"
										},
										{
											"key": "revisionStr",
											"value": "<string>"
										},
										{
											"key": "packageId",
											"value": "<integer>"
										},
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "[\n {\n  \"assetId\": \"<integer>\",\n  \"ruleId\": \"<string>\",\n  \"result\": \"<string>\",\n  \"resultComment\": \"<string>\",\n  \"autoResult\": \"<boolean>\",\n  \"action\": \"<string>\",\n  \"actionComment\": \"<string>\",\n  \"status\": \"<string>\",\n  \"userId\": \"<integer>\",\n  \"ts\": \"<string>\",\n  \"rejectText\": \"<string>\",\n  \"rejectUserId\": \"<integer>\",\n  \"asset\": {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": {\n    \"deptId\": \"<integer>\",\n    \"name\": \"<string>\"\n   }\n  },\n  \"stigs\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"rule\": {\n   \"ruleId\": \"<string>\",\n   \"version\": \"<string>\",\n   \"title\": \"<string>\",\n   \"severity\": \"<string>\"\n  }\n },\n {\n  \"assetId\": \"<integer>\",\n  \"ruleId\": \"<string>\",\n  \"result\": \"<string>\",\n  \"resultComment\": \"<string>\",\n  \"autoResult\": \"<boolean>\",\n  \"action\": \"<string>\",\n  \"actionComment\": \"<string>\",\n  \"status\": \"<string>\",\n  \"userId\": \"<integer>\",\n  \"ts\": \"<string>\",\n  \"rejectText\": \"<string>\",\n  \"rejectUserId\": \"<integer>\",\n  \"asset\": {\n   \"assetId\": \"<integer>\",\n   \"name\": \"<string>\",\n   \"dept\": {\n    \"deptId\": \"<integer>\",\n    \"name\": \"<string>\"\n   }\n  },\n  \"stigs\": [\n   \"<string>\",\n   \"<string>\"\n  ],\n  \"rule\": {\n   \"ruleId\": \"<string>\",\n   \"version\": \"<string>\",\n   \"title\": \"<string>\",\n   \"severity\": \"<string>\"\n  }\n }\n]"
						}
					]
				}
			],
			"protocolProfileBehavior": {}
		},
		{
			"name": "WIP - testing",
			"item": [
				{
					"name": "Create an Asset Copy",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "1000e082-d6eb-4655-82fe-09c911a38f1d",
								"exec": [
									"let user = pm.environment.get(\"user\");\r",
									"console.log(\"user: \" + user);\r",
									"if (user == \"wf10\") {\r",
									"    pm.test(\"Status should be is 403 for user wf10\", function () {\r",
									"        pm.response.to.have.status(403);\r",
									"    });\r",
									"    return;\r",
									"}\r",
									"\r",
									"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
									"    user = \"elevated\";\r",
									"    console.log(\"user is elevated\");\r",
									"\r",
									"}\r",
									"\r",
									"var stuff = pm.request.auth;\r",
									"var stuff = pm.request;\r",
									"\r",
									"if (user == 'elevated' || user == 'staff' || user == \"officer60\") {\r",
									"    pm.test(\"User is elevated. Status code is 201\", function () {\r",
									"        pm.response.to.have.status(201);\r",
									"    });\r",
									"}\r",
									"else {\r",
									"    pm.test(\"User is not Staff, IAO (w/ proper dept) or elevated. Expected status code is 403\", function () {\r",
									"        pm.response.to.have.status(403);\r",
									"    });\r",
									"    return;\r",
									"}\r",
									"\r",
									"if (pm.response.code == 500) {\r",
									"    console.log(\"Server returned 500\")\r",
									"    return;\r",
									"}\r",
									"\r",
									"var jsonData = pm.response.json();\r",
									"\r",
									"\r",
									"\r",
									"pm.test(\"Response JSON is an object\", function () {\r",
									"    pm.expect(jsonData).to.be.an('object');\r",
									"});\r",
									"\r",
									"let createdAsset = jsonData.assetId;\r",
									"console.log(\"created asset: \" + createdAsset)\r",
									"pm.environment.set(\"createdAsset\", createdAsset);\r",
									"\r",
									"pm.test(`Created Asset: ${createdAsset}`, function () {\r",
									"    pm.expect(createdAsset).to.be.an('number');\r",
									"});\r",
									"\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "oauth2",
							"oauth2": [
								{
									"key": "accessToken",
									"value": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGSjg2R2NGM2pUYk5MT2NvNE52WmtVQ0lVbWZZQ3FvcXRPUWVNZmJoTmxFIn0.eyJqdGkiOiIwZWJlZDU1MS01ZmNlLTRiYzMtYmQ0Yi1kMGRjMjJkMDc5YTgiLCJleHAiOjE2MjI2MDU1MjUsIm5iZiI6MCwiaWF0IjoxNTkxMDY5NTI1LCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvYXV0aC9yZWFsbXMvc3RpZ21hbiIsImF1ZCI6ImFjY291bnQiLCJzdWIiOiI3ZGUzODg4Ny1mNmJmLTQ1OTctYWMyZC1iZjlmOWI2NjAyZDkiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJzdGlnLW1hbmFnZXIiLCJhdXRoX3RpbWUiOjAsInNlc3Npb25fc3RhdGUiOiIxOGUyZmI5Yy0zYzQ4LTRjMGYtYTdiMy03MDk4MWYxMDY4OGYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbIioiXSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoicHJvZmlsZSBzdGlnLW1hbmFnZXIiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJvZmZpY2VyLTYwIn0.ET5KOS4KMvKJ-Kc4Fg_Fyv7iorajfBmjSoyZVOXWU09kQDiAhPWhGwYRvXxmdcnpmkgI2MNC4GtR_3b3MK4W5oQ9vAGD-5-SvJjLpT0hiD9FkBXAFtFtcUP0hq7rHv9cROcFLW71MOqodP0EOKXmGxdZ-VziXoWnz4I5QQSfIHI",
									"type": "string"
								},
								{
									"key": "tokenType",
									"value": "bearer",
									"type": "string"
								},
								{
									"key": "addTokenTo",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"z_testAsset-Xx\",\n    \"deptId\": 85,\n    \"ip\": \"\",\n    \"nonnetwork\": false,\n    \"packageIds\": [],\n    \"stigReviewers\": []\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/assets?projection=packages&projection=stigReviewers&projection=adminStats&elevate=false",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"assets"
							],
							"query": [
								{
									"key": "projection",
									"value": "packages",
									"description": "Additional properties to include in the response.\n"
								},
								{
									"key": "projection",
									"value": "stigs",
									"description": "Additional properties to include in the response.\n",
									"disabled": true
								},
								{
									"key": "projection",
									"value": "stigReviewers"
								},
								{
									"key": "projection",
									"value": "adminStats"
								},
								{
									"key": "elevate",
									"value": "false"
								}
							]
						}
					},
					"response": [
						{
							"name": "unexpected error",
							"originalRequest": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\",\n    \"ip\": \"<string>\",\n    \"nonnetwork\": \"<boolean>\",\n    \"scanexempt\": \"<boolean>\",\n    \"packageIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ],\n    \"benchmarkIds\": [\n        \"<string>\",\n        \"<string>\"\n    ],\n    \"stigReviewers\": [\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        },\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        }\n    ]\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/assets?projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets"
									],
									"query": [
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									]
								}
							},
							"status": "Internal Server Error",
							"code": 500,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
						},
						{
							"name": "AssetProjected response",
							"originalRequest": {
								"method": "POST",
								"header": [],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"assetId\": \"<integer>\",\n    \"name\": \"<string>\",\n    \"dept\": \"<string>\",\n    \"ip\": \"<string>\",\n    \"nonnetwork\": \"<boolean>\",\n    \"scanexempt\": \"<boolean>\",\n    \"packageIds\": [\n        \"<integer>\",\n        \"<integer>\"\n    ],\n    \"benchmarkIds\": [\n        \"<string>\",\n        \"<string>\"\n    ],\n    \"stigReviewers\": [\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        },\n        {\n            \"benchmarkId\": \"<string>\",\n            \"userIds\": [\n                \"<integer>\",\n                \"<integer>\"\n            ]\n        }\n    ]\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/assets?projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets"
									],
									"query": [
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									]
								}
							},
							"status": "Created",
							"code": 201,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"assetId\": \"<integer>\",\n \"name\": \"<string>\",\n \"dept\": \"<string>\",\n \"ip\": \"<string>\",\n \"nonnetwork\": \"<boolean>\",\n \"scanexempt\": \"<boolean>\",\n \"adminStats\": {\n  \"stigCount\": \"<integer>\",\n  \"stigAssignedCount\": \"<integer>\"\n },\n \"packages\": [\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  },\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  }\n ],\n \"stigReviewers\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  }\n ]\n}"
						}
					]
				},
				{
					"name": "Delete an Asset Copy",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "40f9d982-be69-4adc-8847-60cccf912130",
								"exec": [
									"\r",
									"let user = pm.environment.get(\"user\");\r",
									"console.log(\"user: \" + user);\r",
									"if (user == \"wf10\") {\r",
									"    pm.test(\"Status should be is 403 for user wf10\", function () {\r",
									"        pm.response.to.have.status(403);\r",
									"    });\r",
									"    return;\r",
									"}\r",
									"\r",
									"if (pm.request.url.getQueryString().match(/elevate=true/)) {\r",
									"    user = \"elevated\";\r",
									"}\r",
									"\r",
									"var jsonData = pm.response.json();\r",
									"\r",
									"\r",
									"if (user == \"wf60\") {\r",
									"    pm.test(\"Status code should be 403\", function () {\r",
									"        pm.response.to.have.status(403);\r",
									"    });\r",
									"    console.log(`Status code: ${pm.response.code}. Either previous test did not create the package, the package has already been deleted, or this user is not authorized to delete this package.`);\r",
									"    return;\r",
									"}\r",
									"\r",
									"pm.test(\"Status code is 200\", function () {\r",
									"    pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"console.log(jsonData);\r",
									"// console.log(pm.environment.get(\"env\"));\r",
									"\r",
									"pm.test(\"Response is a JSON object\", function () {\r",
									"    pm.expect(jsonData).to.be.an('object');\r",
									"});\r",
									"\r",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "oauth2",
							"oauth2": [
								{
									"key": "accessToken",
									"value": "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGSjg2R2NGM2pUYk5MT2NvNE52WmtVQ0lVbWZZQ3FvcXRPUWVNZmJoTmxFIn0.eyJqdGkiOiJkNDQ1MGM4NC0xMjhhLTQwNTAtYjA2Yy1iYTZmNTU3M2Q0MWMiLCJleHAiOjE2MjI2MDU1NzMsIm5iZiI6MCwiaWF0IjoxNTkxMDY5NTczLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvYXV0aC9yZWFsbXMvc3RpZ21hbiIsImF1ZCI6ImFjY291bnQiLCJzdWIiOiIwMWMzMDdmMS05YTNkLTQzMmYtYjMwZi1mZjhiOTIzNzI2MGQiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJzdGlnLW1hbmFnZXIiLCJhdXRoX3RpbWUiOjAsInNlc3Npb25fc3RhdGUiOiIyMTc0YzUxMS0zYWYwLTRjODktODViOS1iOWM3Nzk0ODAxYzEiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbIioiXSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoicHJvZmlsZSBzdGlnLW1hbmFnZXIiLCJuYW1lIjoiQ1NXRiA2MCIsInByZWZlcnJlZF91c2VybmFtZSI6Indvcmtmb3JjZS02MCIsImdpdmVuX25hbWUiOiJDU1dGIiwiZmFtaWx5X25hbWUiOiI2MCJ9.pPxqFyNuMTzS10JemuoBJUGgmJ78GMyFYXmmg0KFH3gtgbpM1L0EtTlMmnHOK0rQPIPoplDyYzn75S22ronXK5iVKZCNSP1nRJPELi2lCF60hrwZ2i59XFHyEvBVqFn8aka1wa8mER811WROeZxvd9jrgDI0vwFwqimmCKNhLRg",
									"type": "string"
								},
								{
									"key": "tokenType",
									"value": "bearer",
									"type": "string"
								},
								{
									"key": "addTokenTo",
									"value": "header",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/assets/:assetId?projection=packages&projection=stigReviewers&projection=adminStats&elevate=false",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"assets",
								":assetId"
							],
							"query": [
								{
									"key": "projection",
									"value": "packages",
									"description": "Additional properties to include in the response.\n"
								},
								{
									"key": "projection",
									"value": "stigReviewers",
									"description": "Additional properties to include in the response.\n"
								},
								{
									"key": "projection",
									"value": "adminStats"
								},
								{
									"key": "elevate",
									"value": "false",
									"description": "Elevate the user context for this request if user is permitted (canAdmin)"
								}
							],
							"variable": [
								{
									"description": "(Required) A path parameter that indentifies an Asset",
									"id": "55c2ca0f-1a63-403e-8640-597907f3f2c5",
									"key": "assetId",
									"type": "string",
									"value": "{{createdAsset}}"
								}
							]
						}
					},
					"response": [
						{
							"name": "AssetProjected response",
							"originalRequest": {
								"method": "DELETE",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets",
										":assetId"
									],
									"query": [
										{
											"key": "elevate",
											"value": "<boolean>"
										},
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									],
									"variable": [
										{
											"key": "assetId"
										}
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"assetId\": \"<integer>\",\n \"name\": \"<string>\",\n \"dept\": \"<string>\",\n \"ip\": \"<string>\",\n \"nonnetwork\": \"<boolean>\",\n \"scanexempt\": \"<boolean>\",\n \"adminStats\": {\n  \"stigCount\": \"<integer>\",\n  \"stigAssignedCount\": \"<integer>\"\n },\n \"packages\": [\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  },\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  }\n ],\n \"stigReviewers\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  }\n ]\n}"
						},
						{
							"name": "unexpected error",
							"originalRequest": {
								"method": "DELETE",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets",
										":assetId"
									],
									"query": [
										{
											"key": "elevate",
											"value": "<boolean>"
										},
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									],
									"variable": [
										{
											"key": "assetId"
										}
									]
								}
							},
							"status": "Internal Server Error",
							"code": 500,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
						}
					]
				},
				{
					"name": "Delete an Asset CLEANUP Copy",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "84f3eb8f-b737-4dea-9064-c40c12c1f7b5",
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "oauth2",
							"oauth2": [
								{
									"key": "accessToken",
									"value": "{{token.staff}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/assets/:assetId?elevate=true&projection=packages&projection=stigReviewers&projection=adminStats",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"assets",
								":assetId"
							],
							"query": [
								{
									"key": "elevate",
									"value": "true",
									"description": "Elevate the user context for this request if user is permitted (canAdmin)"
								},
								{
									"key": "projection",
									"value": "packages",
									"description": "Additional properties to include in the response.\n"
								},
								{
									"key": "projection",
									"value": "stigReviewers",
									"description": "Additional properties to include in the response.\n"
								},
								{
									"key": "projection",
									"value": "adminStats"
								}
							],
							"variable": [
								{
									"description": "(Required) A path parameter that indentifies an Asset",
									"id": "ed477693-db04-4807-aee0-a8cc13d9f4b9",
									"key": "assetId",
									"type": "string",
									"value": "{{createdAsset}}"
								}
							]
						}
					},
					"response": [
						{
							"name": "unexpected error",
							"originalRequest": {
								"method": "DELETE",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets",
										":assetId"
									],
									"query": [
										{
											"key": "elevate",
											"value": "<boolean>"
										},
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									],
									"variable": [
										{
											"key": "assetId"
										}
									]
								}
							},
							"status": "Internal Server Error",
							"code": 500,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"code\": \"<integer>\",\n \"message\": \"<string>\"\n}"
						},
						{
							"name": "AssetProjected response",
							"originalRequest": {
								"method": "DELETE",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/assets/:assetId?elevate=<boolean>&projection=<string>&projection=<string>",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"assets",
										":assetId"
									],
									"query": [
										{
											"key": "elevate",
											"value": "<boolean>"
										},
										{
											"key": "projection",
											"value": "<string>"
										},
										{
											"key": "projection",
											"value": "<string>"
										}
									],
									"variable": [
										{
											"key": "assetId"
										}
									]
								}
							},
							"status": "OK",
							"code": 200,
							"_postman_previewlanguage": "json",
							"header": [
								{
									"key": "Content-Type",
									"value": "application/json"
								}
							],
							"cookie": [],
							"body": "{\n \"assetId\": \"<integer>\",\n \"name\": \"<string>\",\n \"dept\": \"<string>\",\n \"ip\": \"<string>\",\n \"nonnetwork\": \"<boolean>\",\n \"scanexempt\": \"<boolean>\",\n \"adminStats\": {\n  \"stigCount\": \"<integer>\",\n  \"stigAssignedCount\": \"<integer>\"\n },\n \"packages\": [\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  },\n  {\n   \"packageId\": \"<integer>\",\n   \"name\": \"<string>\"\n  }\n ],\n \"stigs\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"lastRevisionStr\": \"<string>\",\n   \"lastRevisionDate\": \"<string>\",\n   \"title\": \"<string>\"\n  }\n ],\n \"stigReviewers\": [\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  },\n  {\n   \"benchmarkId\": \"<string>\",\n   \"reviewers\": [\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    },\n    {\n     \"userId\": \"<integer>\",\n     \"username\": \"<string>\"\n    }\n   ]\n  }\n ]\n}"
						}
					]
				}
			],
			"protocolProfileBehavior": {}
		}
	],
	"auth": {
		"type": "oauth2",
		"oauth2": [
			{
				"key": "accessToken",
				"value": "{{token}}",
				"type": "string"
			},
			{
				"key": "tokenType",
				"value": "bearer",
				"type": "string"
			},
			{
				"key": "addTokenTo",
				"value": "header",
				"type": "string"
			}
		]
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "155f19b1-9b47-4b09-9ac9-86681f539b7e",
				"type": "text/javascript",
				"exec": [
					"// pm.environment.set(\"curUser\", \"staff\");",
					"",
					"let user = pm.iterationData.get(\"user\");",
					"let elevate = pm.iterationData.get(\"elevate\");",
					"console.log(`user: ${user} elevate: ${elevate}`);",
					"",
					"",
					"",
					"if (user === undefined) {",
					"    user = \"admin\";",
					"    elevate = true;",
					"    pm.environment.set(\"user\", user);",
					"    pm.environment.set(\"elevated\", elevate);",
					"    let token = pm.environment.get(\"token.\" + user)",
					"    pm.environment.set(\"token\", token);",
					"    console.log(`No iteration data. Setting: User: ${user} elevated: ${elevate} Bearer: ${token}`);",
					"",
					"    return;  // Just use whatever settings are currently left in the env.",
					"}",
					"",
					"",
					"",
					"let token = pm.iterationData.get(\"token\");",
					"pm.environment.set(\"token.\"+ user, token);",
					"pm.environment.set(\"token\", token);",
					"pm.environment.set(\"user\", user);",
					"pm.environment.set(\"elevated\", elevate);",
					"console.log(`User: ${user} elevated: ${elevate} Bearer: ${token}`);",
					"",
					"pm.environment.set(\"packages.valid\", pm.iterationData.get(\"packages.valid\"));",
					"pm.environment.set(\"packages.invalid\", pm.iterationData.get(\"packages.invalid\"));",
					"pm.environment.set(\"assets.valid\", pm.iterationData.get(\"assets.valid\"));",
					"pm.environment.set(\"assets.invalid\", pm.iterationData.get(\"assets.invalid\"));",
					"pm.environment.set(\"stigs.valid\", pm.iterationData.get(\"stigs.valid\"));",
					"pm.environment.set(\"stigs.invalid\", pm.iterationData.get(\"stigs.invalid\"));",
					"pm.environment.set(\"testPackage\", pm.iterationData.get(\"testPackage\"));",
					"pm.environment.set(\"testPackageScrap\", pm.iterationData.get(\"testPackageScrap\"));",
					"pm.environment.set(\"testPackage.assets\", pm.iterationData.get(\"testPackage.assets\"));",
					"pm.environment.set(\"testBenchmark\", pm.iterationData.get(\"testBenchmark\"));",
					"pm.environment.set(\"testRev\", pm.iterationData.get(\"testRev\"));",
					"pm.environment.set(\"globalAccess\", pm.iterationData.get(\"globalAccess\"));",
					"pm.environment.set(\"accessLevel\", pm.iterationData.get(\"accessLevel\"));",
					"pm.environment.set(\"targetPackageName\", pm.iterationData.get(\"targetPackageName\"));",
					"",
					"",
					"",
					"pm.environment.set(\"assets.packageQuery.response\", pm.iterationData.get(\"assets.packageQuery.response\"));",
					"pm.environment.set(\"assets.benchmarkQuery.response\", pm.iterationData.get(\"assets.benchmarkQuery.response\"));",
					"pm.environment.set(\"assets.deptQuery.response\", pm.iterationData.get(\"assets.deptQuery.response\"));",
					"pm.environment.set(\"assets.packageQuery.response\", pm.iterationData.get(\"assets.packageQuery.response\"));",
					"pm.environment.set(\"assets.packageQuery.response\", pm.iterationData.get(\"assets.packageQuery.response\"));",
					"pm.environment.set(\"assets.packageQuery.response\", pm.iterationData.get(\"assets.packageQuery.response\"));",
					"pm.environment.set(\"assets.queryPkg\", pm.iterationData.get(\"assets.queryPkg\"));",
					"pm.environment.set(\"assets.queryBenchmark\", pm.iterationData.get(\"assets.queryBenchmark\"));",
					"pm.environment.set(\"assets.queryRev\", pm.iterationData.get(\"assets.queryRev\"));",
					"pm.environment.set(\"assets.queryDept\", pm.iterationData.get(\"assets.queryDept\"));",
					"pm.environment.set(\"assets.queryAsset\", pm.iterationData.get(\"assets.queryAsset\"));",
					"pm.environment.set(\"checklistLength\", pm.iterationData.get(\"assets.checklistLength\"));",
					"",
					"",
					"pm.environment.set(\"packageMatchString\", pm.iterationData.get(\"packageMatchString\"));",
					"pm.environment.set(\"assetMatchString\", pm.iterationData.get(\"assetMatchString\"));",
					"",
					"",
					"",
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "305d08db-873b-46f8-b9ef-6acfc94a59c3",
				"type": "text/javascript",
				"exec": [
					"// var user = pm.environment.get(\"user\");",
					"// var elevated = pm.environment.get(\"elevated\");",
					"",
					"// pm.test(`Packages Tests with user: ${user} elevated: ${elevated} `, function () {",
					"//     pm.expect(pm.environment.get(\"user\")).to.equal(user);",
					"// });",
					"",
					"",
					"let user = pm.environment.get(\"user\");",
					"let elevated = pm.environment.get(\"elevated\");",
					"",
					"pm.test(`user: ${user}, elevate variable (not always used): ${elevated}`, function () {",
					"    pm.expect(1).to.equal(1);",
					"});",
					"",
					"let env = pm.environment.get(\"env\");",
					"pm.test(`environment: ${env}`, function () {",
					"    pm.expect(env).to.equal(\"stig-manager localhost ALL\");",
					"});",
					"",
					"",
					"",
					""
				]
			}
		}
	],
	"protocolProfileBehavior": {}
}